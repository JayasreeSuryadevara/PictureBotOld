try{if(!Object.prototype.__defineGetter__&&Object.defineProperty({},"x",{get:function(){return true;}}).x){Object.defineProperty(Object.prototype,"__defineGetter__",{enumerable:false,configurable:true,value:function(name,func){Object.defineProperty(this,name,{get:func,enumerable:true,configurable:true});}});Object.defineProperty(Object.prototype,"__defineSetter__",{enumerable:false,configurable:true,value:function(name,func){Object.defineProperty(this,name,{set:func,enumerable:true,configurable:true});}});}}catch(defPropException){}function getInternetExplorerVersion(){try{var sAgent=window.navigator.userAgent;var Idx=sAgent.indexOf("MSIE");if(Idx>0){return parseInt(sAgent.substring(Idx+5,sAgent.indexOf(".",Idx)));}else{if(!!navigator.userAgent.match(/Trident\/7\./)){return 11;}else{return 0;}}}catch(err){}return null;}function checkIEVersion(){try{var ver=getInternetExplorerVersion();if(ver>0){if(confirm("ALERT! You're using an old unsupported version of Windows Internet Explorer. Only IE Edge and above are supported.")){window.location="https://mockflow.com";}else{window.location="https://mockflow.com";}}}catch(err){}}var MF_Global=(function(){function privateMethod(){}return{serverURL:function(){return"https://wireframepro.mockflow.com/";},cdnURL:function(){return"https://d20hhedk3h2l88.cloudfront.net/apps/wireframepro/";},getS3Bucket:function(){return"assets.mockflow.com";},getCompPath:function(){var comppath="js/src/internal/editor/components/";if(MF_Global.getS3Bucket()=="assets.mockflow.com"){comppath="js/internal/editor/components/";}return comppath;},getSpecPath:function(){var comppath="modules/specs/js/internal/components/";return comppath;},mockupImageURL:function(){return"https://s3.amazonaws.com/mfassets/company/"+MF_UserSession.getUser().company+"/mockup/";},adminAllow:function(){if(MF_UserSession.getUser()){if(MF_UserSession.getUser().username=="pbaskaran@produle.com"||MF_UserSession.getUser().username=="user3@produle.com"||MF_UserSession.getUser().username=="samples@produle.com"||MF_UserSession.getUser().username=="mail@produle.com"||MF_UserSession.getUser().username=="vgnanasabapathy@produle.com"||MF_UserSession.getUser().username=="mvenkat@produle.com"){return true;}}return false;},mockupSharedImageURL:function(company){return"https://s3.amazonaws.com/mfassets/company/"+company+"/mockup/";},getMode:function(){if(MF_Global.getS3Bucket()=="assets.mockflow.com"){if(mf_main.editorController&&mf_main.editorController.RENDER){return"DEV";}else{return"PROD";}}else{return"DEV";}},getS3URL:function(){return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/";},getS3ProdURL:function(){return"https://s3.amazonaws.com/assets.mockflow.com/";}};})();function MF_Project(){var thisClass=this;this.id=null;this.title=null;this.creator=null;this.createDate=null;this.updateDate=null;this.share=false;this.shareDisabled=false;this.isBasic=true;this.permitted=false;this.sharedClient=null;this.permissionType=null;this.realtime=false;this.revision=false;this.stamp=null;this.checkPermission=false;this.comments=0;this.members=0;this.data=null;this.published=false;this.enableExport=true;this.enableComments=true;this.flash=false;this.width=300;this.height=250;this.origWidth=800;this.origHeight=600;this.sizeType="sizeless";this.autoResize=true;this.collaborators=null;this.collaboratorsOld=null;this.sharePerm=null;this.sharePermOld=null;this.pages=new Array();this.emailAlert=true;this.company=null;this.font=null;this.category=null;this.publicURL=null;this.urlview=null;this.favouriteColors=new Array();this.isdeleted=false;this.deletedon=null;this.readonly=false;this.setCollaborators=function(arr){if(thisClass.flash){thisClass.collaboratorsOld=arr;}else{thisClass.collaborators=arr;}};this.getCollaborators=function(){if(thisClass.flash){return thisClass.collaboratorsOld;}else{return thisClass.collaborators;}};var creatorImage="";this.__defineGetter__("creatorImage",function(){var cr=thisClass.creator;if(cr=="mockflow@produle.com"){cr="dummymf";}var str=MF_Utils.get_gravatar(cr,32);return str;});this.__defineSetter__("creatorImage",function(val){creatorImage=val;});this.__defineSetter__("isShared",function(val){});this.__defineGetter__("isShared",function(){if(thisClass.permissionTypeStr=="Owner"){return"";}return true;});var createDateStr="";this.__defineGetter__("createDateStr",function(){if(thisClass.createDate!=null){var curr_date=thisClass.createDate.getDate();var curr_month=thisClass.createDate.getMonth()+1;var curr_year=thisClass.createDate.getFullYear();var hours=thisClass.createDate.getHours();var minutes=thisClass.createDate.getMinutes();return curr_date+" "+MF_Utils.getMonthByName(thisClass.createDate.getMonth())+" "+curr_year+" - "+hours+":"+minutes;}else{return thisClass.createDate;}});this.__defineSetter__("createDateStr",function(val){createDateStr=val;});var updateDateStr="";this.__defineGetter__("updateDateStr",function(){if(thisClass.updateDate!=null){var curr_date=thisClass.updateDate.getDate();var curr_month=thisClass.updateDate.getMonth()+1;var curr_year=thisClass.updateDate.getFullYear();var hours=thisClass.updateDate.getHours();var minutes=thisClass.updateDate.getMinutes();return curr_date+" "+MF_Utils.getMonthByName(thisClass.updateDate.getMonth())+" "+curr_year+" - "+hours+":"+minutes;}else{return thisClass.updateDate;}});this.__defineSetter__("updateDateStr",function(val){updateDateStr=val;});var shareStr="no";this.__defineGetter__("shareStr",function(){if(thisClass.share){return"yes";}else{return"no";}});this.__defineSetter__("shareStr",function(val){shareStr=val;});var owner=true;this.__defineGetter__("owner",function(){if(MF_UserSession.getUser()&&thisClass.company==MF_UserSession.getUser().company){return true;}return false;});this.__defineSetter__("owner",function(val){owner=val;});var permissionTypeStr="owner";this.__defineGetter__("permissionTypeStr",function(){if(thisClass.permissionType==null){return"Owner";}else{if(thisClass.permissionType=="Editor"){return"Designer";}return thisClass.permissionType;}});this.__defineSetter__("permissionTypeStr",function(val){permissionTypeStr=val;});var publishedStr="No";this.__defineGetter__("publishedStr",function(){if(thisClass.published==true){return"Yes";}else{return"No";}});this.__defineSetter__("publishedStr",function(val){publishedStr=val;});var thumbnailURL="";this.__defineGetter__("thumbnailURL",function(){if(thisClass.flash){if(thisClass.permitted){return MF_Global.mockupSharedImageURL(thisClass.company)+thisClass.id;}else{return MF_Global.mockupImageURL()+thisClass.id;}}else{return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/company/"+thisClass.company+"/projects/"+thisClass.id+"/thumbnail/"+thisClass.id;}});this.__defineSetter__("thumbnailURL",function(val){thumbnailURL=val;});this.__defineGetter__("creatorStr",function(){if(MF_UserSession.getUser()&&thisClass.company==MF_UserSession.getUser().company){return"Me";}return thisClass.creator;});this.__defineSetter__("creatorStr",function(val){});this.__defineGetter__("createdByStr",function(){if(MF_UserSession.getUser()&&thisClass.company==MF_UserSession.getUser().company){return"Created By";}return"Shared By";});this.__defineSetter__("createdByStr",function(val){});var imageURL="";this.__defineGetter__("imageURL",function(){if(MF_Global.getMode()=="PROD"){return"http://assets.mockflow.com/app/wireframepro/company/"+thisClass.company+"/projects/"+thisClass.id+"/image/"+thisClass.id;}else{return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/company/"+thisClass.company+"/projects/"+thisClass.id+"/image/"+thisClass.id;}});this.__defineSetter__("imageURL",function(val){imageURL=val;});var daysToDelete="";this.__defineGetter__("daysToDelete",function(){if(thisClass.isdeleted){var dateToday=new Date();var dateDeleted=new Date(thisClass.deletedon);var differenceDays=(dateDeleted.getTime()-dateToday.getTime())/(1000*3600*24);differenceDays=Math.round(differenceDays+30);if(differenceDays<2){return"1 day";}else{return differenceDays+" days";}}return"";});this.__defineSetter__("daysToDelete",function(val){daysToDelete=val;});this.cast=function(obj){this.id=obj.id;this.title=obj.title;this.creator=obj.creator;this.createDate=obj.createDate;this.updateDate=obj.updateDate;this.publicURL=obj.publicURL;this.share=obj.share;this.urlview=obj.urlview;this.shareDisabled=obj.shareDisabled;this.isBasic=obj.isBasic;this.permitted=obj.permitted;this.sharedClient=obj.shareClient;this.permissionType=obj.permissionType;this.realtime=obj.realtime;this.revision=obj.revision;this.stamp=obj.stamp;this.checkPermission=obj.checkPermission;this.comments=obj.comments;this.members=obj.members;this.data=obj.data;this.font=obj.font;this.category=obj.category;this.published=obj.published;this.collaborators=obj.collaborators;this.collaboratorsOld=obj.collaboratorsOld;this.company=obj.company;this.sharePerm=obj.sharePerm;this.sharePermOld=obj.sharePermOld;this.flash=obj.flash;this.enableExport=obj.enableExport;this.enableComments=obj.enableComments;this.pages=obj.pages;this.isdeleted=obj.isdeleted;this.deletedon=obj.deletedon;this.readonly=obj.readonly;};}function MF_ComponentItem(){var thisClass=this;this.n=null;this.l=null;this.db=false;this.clientid=null;this.pack=false;this.packid=null;this.sort=0;this.isMaster=false;this.masterClientid=null;this.noAllowDelete=false;this.__defineSetter__("getPackId",function(val){});this.__defineGetter__("getPackId",function(){if(thisClass.packid){return thisClass.packid;}return"";});this.__defineSetter__("getMasterClientid",function(val){});this.__defineGetter__("getMasterClientid",function(){if(thisClass.masterClientid){return thisClass.masterClientid;}return"";});this.__defineSetter__("thumbnail",function(val){});this.__defineGetter__("thumbnail",function(){if(thisClass.pack){if(thisClass.isMaster){return MF_Global.getS3URL()+"app/wireframepro/company/"+thisClass.clientid+"/comppack/"+thisClass.packid+"/comp/"+thisClass.n+"/thumbnail/"+thisClass.n+".png";}else{return MF_Global.getS3URL()+"app/wireframepro/company/"+thisClass.masterClientid+"/comppack/"+thisClass.packid+"/comp/"+thisClass.n+"/thumbnail/"+thisClass.n+".png";}}if(thisClass.db){return MF_Global.getS3ProdURL()+"app/wireframepro/dbcomponents/thumbnails/"+thisClass.n+".png";}return MF_Global.getS3ProdURL()+"app/wireframepro/components/thumbnails/"+thisClass.n+".png";});this.cast=function(obj){this.n=obj.n;this.l=obj.l;this.db=obj.db;this.clientid=obj.clientid;this.pack=obj.pack;this.packid=obj.packId;this.sort=obj.sort;this.isMaster=obj.isMaster;this.masterClientid=obj.masterClientid;};}function MF_SharePermOld(){var thisClass=this;this.canDuplicateProject=false;this.canChat=true;this.canViewLog=true;this.canViewMembers=true;this.canUploadImage=true;this.canDeleteImage=true;this.canPreviewRevision=true;this.canDeleteRevision=true;this.canChangeSiteMap=true;this.canExportData=false;this.cast=function(obj){this.canDuplicateProject=obj.canDuplicateProject;this.canChat=obj.canChat;this.canViewLog=obj.canViewLog;this.canViewMembers=obj.canViewMembers;this.canUploadImage=obj.canUploadImage;this.canDeleteImage=obj.canDeleteImage;this.canPreviewRevision=obj.canPreviewRevision;this.canDeleteRevision=obj.canDeleteRevision;this.canChangeSiteMap=obj.canChangeSiteMap;this.canExportData=obj.canExportData;};}function MF_ChatMember(){var thisClass=this;this.id=null;this.userid=null;this.name=null;this.online=false;this.type=null;var profileImage="";this.__defineGetter__("profileImage",function(){var str=MF_Utils.get_gravatar(thisClass.userid,32);return str;});this.__defineSetter__("profileImage",function(val){profileImage=val;});var memberType="";this.__defineGetter__("memberType",function(){if(thisClass.type=="Admin"){return"Admin";}if(thisClass.type=="Editor"){return"Editor";}if(thisClass.type=="Reviewer"){return"Reviewer";}return"Owner";});this.__defineSetter__("memberType",function(val){memberType=val;});this.cast=function(obj){thisClass.userid=obj.userid;thisClass.name=obj.name;thisClass.type=obj.type;};}function MF_MultiLinkObj(){var thisClass=this;this.id=null;this.item=null;this.page=null;this.pageLabel=null;this.count=0;this.isLinked=false;this.linkVal="";this.url=null;}function MF_MultiIconObj(){var thisClass=this;this.id=null;this.item=null;this.iconCls="";this.count=0;this.isIcon=false;}function MF_CollaboratorOld(){var thisClass=this;this.id=null;this.mockupid=null;this.userid=null;this.type=null;this.online=false;this.sharePerm=null;var profileImage="";this.__defineGetter__("profileImage",function(){var str=MF_Utils.get_gravatar(thisClass.userid,32);return str;});this.__defineSetter__("profileImage",function(val){profileImage=val;});var memberType="";this.__defineGetter__("memberType",function(){if(thisClass.type=="Admin"){return"Admin";}if(thisClass.type=="Editor"){return"Editor";}if(thisClass.type=="Reviewer"){return"Reviewer";}return"Owner";});this.__defineSetter__("memberType",function(val){memberType=val;});this.cast=function(obj){this.id=obj.id;this.mockupid=obj.mockupid;this.userid=obj.userid;this.type=obj.type;this.online=obj.online;this.sharePerm=obj.sharePerm;};}function MF_ProjectInfoData(){var thisClass=this;this.collaborators=null;this.log=null;}function MF_PageExport(){var thisClass=this;this.id=null;this.name=null;this.imagedata=null;this.path=null;this.px=0;this.py=0;this.pw=500;this.ph=500;}function MF_LinkObj(){var thisClass=this;this.event=null;this.type=null;this.url=null;this.pageName=null;}function MF_Feedback(){var thisClass=this;this.id=null;this.projectid=null;this.pageid=null;this.message=null;this.creator=null;this.createDate=null;this.creatorName=null;this.pos=null;this.comment=null;this.message=null;this.reply=null;this.attached=null;var isReply=false;this.__defineGetter__("isReply",function(){if(thisClass.reply!=null){return true;}else{return false;}});this.__defineSetter__("isReply",function(val){isReply=val;});var messageStr="";this.__defineGetter__("messageStr",function(){var str=thisClass.message.replace(/(\r\n|\n|\r)/gm,"<br/>");return str;});this.__defineSetter__("messageStr",function(val){messageStr=val;});var createDateStr="";this.__defineGetter__("createDateStr",function(){if(thisClass.createDate!=null){var curr_date=thisClass.createDate.getDate();var curr_month=thisClass.createDate.getMonth()+1;var curr_year=thisClass.createDate.getFullYear();var hours=thisClass.createDate.getHours();var minutes=thisClass.createDate.getMinutes();return curr_date+" "+MF_Utils.getMonthByName(thisClass.createDate.getMonth())+" "+curr_year;}else{return thisClass.createDate;}});this.__defineSetter__("createDateStr",function(val){createDateStr=val;});var createDatePast="";this.__defineGetter__("createDatePast",function(){if(thisClass.createDate!=null){var seconds=Math.floor((new Date()-thisClass.createDate)/1000);var interval=Math.floor(seconds/31536000);if(interval>1){return interval+" years ago";}interval=Math.floor(seconds/2592000);if(interval>1){return interval+" months ago";}interval=Math.floor(seconds/86400);if(interval>1){return interval+" days ago";}interval=Math.floor(seconds/3600);if(interval>1){return interval+" hours ago";}interval=Math.floor(seconds/60);if(interval>1){return interval+" minutes ago";}return"few seconds ago";}else{return thisClass.createDate;}});this.__defineSetter__("createDatePast",function(val){createDatePast=val;});var creatorNameStr="";this.__defineGetter__("creatorNameStr",function(){if(MF_UserSession.getUser()!=null&&MF_UserSession.getUser()!=""){if(thisClass.creator.toLowerCase()==MF_UserSession.getUser().username.toLowerCase()){return"Me";}else{return thisClass.creatorName;}}else{return thisClass.creatorName;}});this.__defineSetter__("creatorNameStr",function(val){creatorNameStr=val;});var annotate="";this.__defineGetter__("annotate",function(){if(thisClass.pos!=null){var arr=thisClass.pos.split(",");if(arr.length==2){return true;}return false;}else{return false;}});this.__defineSetter__("annotate",function(val){annotate=val;});var isAttached=false;this.__defineGetter__("isAttached",function(){if(thisClass.attached==null||thisClass.attached==""){return false;}else{return true;}});this.__defineSetter__("isAttached",function(val){isAttached=val;});var image=false;this.__defineGetter__("image",function(){if(thisClass.attached=="png"||thisClass.attached=="gif"||thisClass.attached=="jpg"){return true;}else{return false;}});this.__defineSetter__("image",function(val){image=val;});var thumbnailURL="";this.__defineGetter__("thumbnailURL",function(){return MF_Global.getS3URL()+"app/wireframepro/company/"+mf_main.editorController.projectObj.company+"/projects/"+mf_main.editorController.projectObj.id+"/pages/"+thisClass.pageid+"/feedback/thumbnail/"+thisClass.id+"."+thisClass.attached;});this.__defineSetter__("thumbnailURL",function(val){thumbnailURL=val;});var attachURL="";this.__defineGetter__("attachURL",function(){return MF_Global.getS3URL()+"app/wireframepro/company/"+mf_main.editorController.projectObj.company+"/projects/"+mf_main.editorController.projectObj.id+"/pages/"+thisClass.pageid+"/feedback/"+thisClass.id+"."+thisClass.attached;});this.__defineSetter__("attachURL",function(val){attachURL=val;});var profileImage="";this.__defineGetter__("profileImage",function(){var cr=thisClass.creator;if(cr=="mockflow@produle.com"){cr="dummymf";}var str=MF_Utils.get_gravatar(cr,48);return str;});this.__defineSetter__("profileImage",function(val){profileImage=val;});var canEdit=false;this.__defineGetter__("canEdit",function(){if(MF_UserSession.getUser()!=null&&MF_UserSession.getUser()!=""){if(thisClass.creator.toLowerCase()==MF_UserSession.getUser().username.toLowerCase()){return true;}else{return false;}}else{return false;}});this.__defineSetter__("canEdit",function(val){canEdit=val;});var canDelete=false;this.__defineGetter__("canDelete",function(){if(MF_UserSession.getUser()!=null&&MF_UserSession.getUser()!=""){if(!mf_main.PUBLIC&&(thisClass.creator.toLowerCase()==MF_UserSession.getUser().username.toLowerCase()||mf_main.PERMISSION=="Owner")){return true;}else{return false;}}else{return false;}});this.__defineSetter__("canDelete",function(val){canDelete=val;});this.cast=function(obj){this.id=obj.id;this.projectid=obj.projectid;this.pageid=obj.pageid;this.message=obj.message;this.creator=obj.creator;this.createDate=obj.createDate;this.creatorName=obj.creatorName;this.pos=obj.pos;this.comment=obj.comment;this.message=obj.message;this.reply=obj.reply;this.attached=obj.attached;};}function MF_PageData(){var thisClass=this;this.eid=null;this.projectid=null;this.clientid=null;this.compressedData=null;this.data=null;this.createDate=null;this.updateDate=null;this.stamp=null;this.comments=0;this.name=null;this.sortorder=-1;this.snapped=false;this.deletedBy=null;this.deleteDate=null;var deleteDateStr="";this.__defineGetter__("deleteDateStr",function(){if(thisClass.deleteDate!=null){var curr_date=thisClass.deleteDate.getDate();var curr_month=thisClass.deleteDate.getMonth()+1;var curr_year=thisClass.deleteDate.getFullYear();var hours=thisClass.deleteDate.getHours();var minutes=thisClass.deleteDate.getMinutes();return curr_date+" "+MF_Utils.getMonthByName(thisClass.deleteDate.getMonth())+" "+curr_year+" "+hours+":"+minutes;}else{return thisClass.deleteDate;}});this.__defineSetter__("deleteDateStr",function(val){deleteDateStr=val;});this.cast=function(obj){this.eid=obj.eid;this.projectid=obj.projectid;this.clientid=obj.clientid;this.compressedData=obj.compressedData;this.data=obj.data;this.createDate=obj.createDate;this.updateDate=obj.updateDate;this.stamp=obj.stamp;this.comments=obj.comments;this.sortorder=obj.sortorder;this.name=obj.name;this.snapped=obj.snapped;this.deletedBy=obj.deletedBy;this.deleteDate=obj.deleteDate;};}function MF_DBComponent(){var thisClass=this;this.id=null;this.name=null;this.creator=null;this.createDate=null;this.data=null;this.imagePresent=false;this.images=null;this.customFonts=null;this.cast=function(obj){this.id=obj.id;this.name=obj.name;this.creator=obj.creator;this.createDate=obj.createDate;this.data=obj.data;this.imagePresent=obj.imagePresent;this.images=obj.images;this.customFonts=obj.customFonts;};}function MF_StoreTemplate(){var thisClass=this;this.id=null;this.name=null;this.createDate=null;this.data=null;this.type=null;this.submitter=null;this.submitterName=null;this.downloads=0;this.approved=false;this.packId=null;this.imagePresent=false;this.images=null;this.clientId=null;this.itemType=null;this.description=null;this.featured=false;this.includeCommon=false;this.customFonts=null;var thumbnailURL="";this.__defineGetter__("thumbnailURL",function(){if(thisClass.itemType=="uipack"){if(MF_Global.getS3Bucket()=="assets.mockflow.com"){return"https://d1tzxux72fvryy.cloudfront.net/"+thisClass.id+"/preview/thumb/"+thisClass.id+".png";}else{return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/store/"+thisClass.id+"/preview/thumb/"+thisClass.id+".png";}}else{if(MF_Global.getS3Bucket()=="assets.mockflow.com"){return"https://d1tzxux72fvryy.cloudfront.net/"+thisClass.id+"/preview/"+thisClass.id+".png";}else{return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/store/"+thisClass.id+"/preview/thumb/"+thisClass.id+".png";}}});this.__defineSetter__("thumbnailURL",function(val){thumbnailURL=val;});var imageURL="";this.__defineGetter__("imageURL",function(){if(MF_Global.getS3Bucket()=="assets.mockflow.com"){return"https://d1tzxux72fvryy.cloudfront.net/"+thisClass.id+"/preview/"+thisClass.id+".png";}else{return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/store/"+thisClass.id+"/preview/"+thisClass.id+".png";}});this.__defineSetter__("imageURL",function(val){imageURL=val;});var featuredURL="";this.__defineGetter__("featuredURL",function(){if(thisClass.featured){if(MF_Global.getS3Bucket()=="assets.mockflow.com"){return"https://d1tzxux72fvryy.cloudfront.net/"+thisClass.id+"/featured/"+thisClass.id+".png?"+new Date().getTime();}else{return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/store/"+thisClass.id+"/featured/"+thisClass.id+".png?"+new Date().getTime();}}});this.__defineSetter__("featuredURL",function(val){featuredURL=val;});this.cast=function(obj){this.id=obj.id;this.name=obj.name;this.createDate=obj.createDate;this.data=obj.data;this.type=obj.type;this.submitter=obj.submitter;this.submitterName=obj.submitterName;this.downloads=obj.downloads;this.approved=obj.approved;this.packId=obj.packId;this.clientId=obj.clientId;this.itemType=obj.itemType;this.description=obj.description;this.featured=obj.featured;this.includeCommon=obj.includeCommon;this.customFonts=obj.customFonts;};}function MF_CompTemplate(){var thisClass=this;this.eid=null;this.projectid=null;this.clientid=null;this.compressedData=null;this.data=null;this.createDate=null;this.updateDate=null;this.name=null;this.cast=function(obj){this.eid=obj.eid;this.projectid=obj.projectid;this.clientid=obj.clientid;this.compressedData=obj.compressedData;this.data=obj.data;this.createDate=obj.createDate;this.updateDate=obj.updateDate;this.stamp=obj.stamp;this.name=obj.name;};}function MF_CompCategory(){var thisClass=this;this.id=null;this.name=null;this.tags=null;this.builtin=true;this.clientid=null;this.importcategory=null;this.custompack=false;this.modify=true;this.createDate=null;this.componentItemList=null;this.isMaster=false;this.isShared=false;this.masterClientid=null;this.mockstore=false;this.includeCommon=false;this.isMergeablePack=false;this.mergeablePackData=null;this.builtInID=null;this.packId=null;this.__defineSetter__("nameLabel",function(val){});this.__defineGetter__("nameLabel",function(){if(thisClass.id=="featured"){return"Select Pack";}return thisClass.name;});this.__defineSetter__("isMockStore",function(val){});this.__defineGetter__("isMockStore",function(){if(thisClass.mockstore==true){return"yes";}else{return"no";}});this.__defineSetter__("showMoreIcon",function(val){});this.__defineGetter__("showMoreIcon",function(){if(thisClass.isMaster){return true;}if(thisClass.isShared){return false;}return true;});this.__defineSetter__("icon",function(val){});this.__defineGetter__("icon",function(){if(thisClass.custompack&&thisClass.isShared){return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/uipack/"+this.id+"/preview/thumb/"+this.id+".png";}if(thisClass.custompack){return"images/editor/category/custom.png";}if(thisClass.mockstore){return"https://s3.amazonaws.com/assets.mockflow.com/app/wireframepro/uipack/"+this.packId+"/preview/thumb/"+this.packId+".png";}return"images/editor/category/"+thisClass.id+".png";});this.cast=function(obj){this.id=obj.id;this.name=obj.name;this.tags=obj.tags;this.builtin=obj.builtin;this.projectid=obj.projectid;this.clientid=obj.clientid;this.importcategory=obj.importcategory;this.createDate=obj.createDate;this.componentItemList=obj.componentItemList;this.custompack=obj.custompack;this.modify=obj.modify;this.isMaster=obj.isMaster;this.isShared=obj.isShared;this.masterClientid=obj.masterClientid;this.includeCommon=obj.includeCommon;this.isMergeablePack=obj.isMergeablePack;this.mergeablePackData=obj.mergeablePackData;};}function MF_MergeablePackData(){var thisClass=this;this.id=null;this.mfClientId=null;this.customPack=null;this.__defineSetter__("icon",function(val){});this.__defineGetter__("icon",function(){if(this.customPack){return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/uipack/"+this.id+"/preview/thumb/"+this.id+".png";}else{return"images/editor/category/"+thisClass.id+".png";}});}function MF_LicenseData(){var thisClass=this;this.licenses=null;this.userLicenses=null;}function MF_Revision(){var thisClass=this;this.id=null;this.projectid=null;this.pageid=null;this.creator=null;this.createDate=null;this.data=null;this.note=null;this.auto=null;this.recovery=null;this.company=null;var isAuto=false;this.__defineGetter__("isAuto",function(){if(thisClass.auto!=null){return true;}else{return false;}});this.__defineSetter__("isAuto",function(val){isAuto=val;});var createDateStr="";this.__defineGetter__("createDateStr",function(){if(thisClass.createDate!=null){var curr_date=thisClass.createDate.getDate();var curr_month=thisClass.createDate.getMonth()+1;var curr_year=thisClass.createDate.getFullYear();var hours=thisClass.createDate.getHours();var minutes=thisClass.createDate.getMinutes();return curr_date+" "+MF_Utils.getMonthByName(thisClass.createDate.getMonth())+" "+curr_year+" "+hours+":"+minutes;}else{return thisClass.createDate;}});this.__defineSetter__("createDateStr",function(val){createDateStr=val;});var creatorNameStr="";this.__defineGetter__("creatorNameStr",function(){if(MF_UserSession.getUser()!=null&&MF_UserSession.getUser()!=""){if(thisClass.creator.toLowerCase()==MF_UserSession.getUser().username.toLowerCase()){return"Me";}else{return thisClass.creator;}}else{return thisClass.creator;}});this.__defineSetter__("creatorNameStr",function(val){creatorNameStr=val;});this.cast=function(obj){this.id=obj.id;this.projectid=obj.projectid;this.pageid=obj.pageid;this.creator=obj.creator;this.createDate=obj.createDate;this.data=obj.data;this.note=obj.note;this.auto=obj.auto;this.recovery=obj.recovery;this.company=obj.company;};}function MF_Component(){var thisClass=this;this.name=null;this.category=null;this.label=null;this.cast=function(obj){this.name=obj.name;this.category=obj.category;this.label=obj.label;};}function MF_StoreCategory(){var thisClass=this;this.id="";this.name="";this.icon="";this.cast=function(obj){this.id=obj.id;this.name=obj.name;this.color=obj.color;};}function MF_Font(){var thisClass=this;this.type=null;this.id=null;this.name=null;this.isGoogleFont=false;this.isCustomFont=false;this.projectid=null;this.clientid=null;this.customFontId=null;this.cast=function(obj){this.type=obj.type;this.id=obj.id;this.name=obj.name;this.isGoogleFont=obj.isGoogleFont;if(obj.isCustomFont){this.isCustomFont=obj.isCustomFont;this.projectid=obj.projectid;this.clientid=obj.clientid;this.customFontId=obj.customFontId;}};}function MF_SharePerm(){var thisClass=this;this.canDuplicateProject=false;this.canChat=true;this.canViewLog=true;this.canViewMembers=true;this.canUploadImage=true;this.canDeleteImage=true;this.canPreviewRevision=true;this.canDeleteRevision=true;this.canChangeSiteMap=true;this.canExportData=false;this.cast=function(obj){this.canDuplicateProject=obj.canDuplicateProject;this.canChat=obj.canChat;this.canViewLog=obj.canViewLog;this.canViewMembers=obj.canViewMembers;this.canUploadImage=obj.canUploadImage;this.canDeleteImage=obj.canDeleteImage;this.canPreviewRevision=obj.canPreviewRevision;this.canDeleteRevision=obj.canDeleteRevision;this.canChangeSiteMap=obj.canChangeSiteMap;this.canExportData=obj.canExportData;};}function MF_License(){var thisClass=this;this.id=null;this.clientid=null;this.users=0;this.edition=null;this.cost=0;this.txnID=null;this.status=null;this.period=null;this.monthly=false;this.createDate=null;var periodStr="";this.__defineGetter__("periodStr",function(){if(thisClass.period!=null){var curr_date=thisClass.period.getDate();var curr_month=thisClass.period.getMonth()+1;var curr_year=thisClass.period.getFullYear();var da=curr_date+" "+MF_Utils.getMonthByName(thisClass.period.getMonth())+" "+curr_year;if(thisClass.status=="active"||thisClass.status=="invoiced"||thisClass.status=="failed"){return"Renews On: "+da;}if(thisClass.status=="expired"||thisClass.status=="Expired"){return"Expired On: "+da;}if(thisClass.status=="cancelled"){return"Expires On: "+da;}return da;}else{return thisClass.period;}});this.__defineSetter__("periodStr",function(val){periodStr=val;});var createDateFormat="";this.__defineGetter__("createDateFormat",function(){if(thisClass.createDate!=null){var curr_date=thisClass.createDate.getDate();var curr_month=thisClass.createDate.getMonth()+1;var curr_year=thisClass.createDate.getFullYear();return curr_year+"-"+curr_month+"-"+curr_date;}else{return thisClass.createDate;}});this.__defineSetter__("createDateFormat",function(val){createDateFormat=val;});var periodFormat="";this.__defineGetter__("periodFormat",function(){if(thisClass.period!=null){var curr_date=thisClass.period.getDate();var curr_month=thisClass.period.getMonth()+1;var curr_year=thisClass.period.getFullYear();return curr_year+"-"+curr_month+"-"+curr_date;}else{return thisClass.period;}});this.__defineSetter__("periodFormat",function(val){periodFormat=val;});var statusMsg="Active";this.__defineGetter__("statusMsg",function(){if(thisClass.status=="active"){return"Active";}if(thisClass.status=="cancelled"){return"Cancelled";}if(thisClass.status=="expired"){return"Expired";}if(thisClass.status=="failed"){return"Failed";}if(thisClass.status=="invoiced"){return"Invoiced";}return thisClass.status;});this.__defineSetter__("statusMsg",function(val){statusMsg=val;});var statusColor="#000000";this.__defineGetter__("statusColor",function(){if(thisClass.status=="cancelled"){return"#ff0000";}if(thisClass.status=="failed"){return"#ff0000";}return"#000000";});this.__defineSetter__("statusColor",function(val){statusColor=val;});var showCancelBtn=true;this.__defineGetter__("showCancelBtn",function(){if(thisClass.status=="active"||thisClass.status=="failed"){return true;}else{return false;}});this.__defineSetter__("showCancelBtn",function(val){showCancelBtn=val;});var isPayPal=false;this.__defineGetter__("isPayPal",function(){if(thisClass.txnID.substring(0,2)=="S-"||thisClass.txnID.substring(0,2)=="s-"){return true;}return false;});this.__defineSetter__("isPayPal",function(val){isPayPal=val;});var isInvoice=false;this.__defineGetter__("isInvoice",function(){if(thisClass.txnID.substring(0,4)=="INV-"||thisClass.txnID.substring(0,4)=="inv-"||thisClass.txnID.substring(0,4)=="Inv-"){return true;}return false;});this.__defineSetter__("isInvoice",function(val){isInvoice=val;});var isFastSpring=false;this.__defineGetter__("isFastSpring",function(){var arr=thisClass.txnID.split("--__--");if(arr.length>=6){return true;}return false;});this.__defineSetter__("isFastSpring",function(val){isFastSpring=val;});var isMonthly=false;this.__defineGetter__("isMonthly",function(){var arr=thisClass.txnID.split("--__--");if(arr.length>=6){var str=arr[3];if(str=="monthly"){return true;}else{return false;}}return false;});this.__defineSetter__("isMonthly",function(val){isMonthly=val;});var subID="";this.__defineGetter__("subID",function(){var arr=thisClass.txnID.split("--__--");if(thisClass.isFastSpring){if(arr.length==6){return arr[4];}if(arr.length==7){return arr[5];}}else{return thisClass.txnID;}return thisClass.txnID;});this.__defineSetter__("subID",function(val){subID=val;});this.cast=function(obj){this.id=obj.id;this.clientid=obj.clientid;this.users=obj.users;this.edition=obj.edition;this.cost=obj.cost;this.txnID=obj.txnID;this.status=obj.status;this.period=obj.period;this.createDate=obj.createDate;};}function MF_LicenseUser(){var thisClass=this;this.clientid=null;this.id=null;this.email=null;this.createDate=null;this.canDowngrade=false;this.__defineGetter__("canDowngrade",function(){if(thisClass.email.toLowerCase()==MF_UserSession.getUser().username.toLowerCase()){return false;}return true;});this.__defineSetter__("canDowngrade",function(val){thisClass.canDowngrade=val;});this.cast=function(obj){this.id=obj.id;this.clientid=obj.clientid;this.email=obj.email;this.createDate=obj.createDate;};}function MF_LogShared(){var thisClass=this;this.id=null;this.projectName=null;this.projectid=null;this.creator=null;this.createDate=null;this.creatorName=null;this.logtype=null;this.opened=false;this.receiver=null;var linkable=false;this.__defineGetter__("linkable",function(){if(thisClass.logtype=="ADD-MEMBER-EDITOR"||thisClass.logtype=="ADD-MEMBER-REVIEWER"||thisClass.logtype=="RATING"||thisClass.logtype=="ADD-VARIATION"||thisClass.logtype=="DEL-VARIATION"||thisClass.logtype=="ENABLE-SHARE-MEMBER"||thisClass.logtype=="MEMBER-EDITOR"||thisClass.logtype=="MEMBER-REVIEWER"||thisClass.logtype=="OWNER"||thisClass.logtype=="COMMENTED"||thisClass.logtype=="PROJECT-ARCHIVED"||thisClass.logtype=="PROJECT-UNARCHIVED"||thisClass.logtype=="TRASHED"||thisClass.logtype=="RESTORED"){return true;}return false;});this.__defineSetter__("linkable",function(val){linkable=val;});var logMessage="";this.__defineGetter__("logMessage",function(){var str=" ";var d=thisClass.createDate;if(d==null){d=new Date();}var curr_date=d.getDate();var curr_month=d.getMonth()+1;var curr_year=d.getFullYear();str=str+"<span class='mfNfUserName'>"+thisClass.creatorName+"</span>";if(thisClass.logtype!="NEW"){str=str+" has";}if(thisClass.logtype=="ADD-MEMBER-EDITOR"){str=str+" added you as Co-Editor to this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="ADD-MEMBER-REVIEWER"){str=str+" added you as Reviewer to this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="ADD-MEMBER-ADMIN"){str=str+" added you as Administrator to this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="ADD-MEMBER"){str=str+" added you as Team Member \n\n";}if(thisClass.logtype=="MEMBER-UPGRADE"){str=str+" upgraded your account to premium \n\n";}if(thisClass.logtype=="MEMBER-DOWNGRADE"){str=str+" downgraded your account to basic \n\n";}if(thisClass.logtype=="DEL-MEMBER"){str=str+" removed you from this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="DISABLE-SHARE-MEMBER"){str=str+" disabled sharing with you for this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="ENABLE-SHARE-MEMBER"){str=str+" re-enabled sharing with you for this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="MEMBER-EDITOR"){str=str+" changed your role to 'Co-Editor' in this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="MEMBER-REVIEWER"){str=str+" changed your role to 'Reviewer' in this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="MEMBER-ADMIN"){str=str+" changed your role to 'Administrator' in this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="COMMENTED"){str=str+" added a comment to this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="RATING"){str=str+" rated this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="ADD-VARIATION"){str=str+" added a new design variation to this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="OWNER"){str=str+" sent a copy of this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="CLONED"){str=str+" cloned a copy of this project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="NEW"){str=str+" : Notifications from other users are displayed here \n\n";}if(thisClass.logtype=="PROJECT-ARCHIVED"){str=str+" archived the project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="PROJECT-UNARCHIVED"){str=str+" unarchived the project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' \n\n";}if(thisClass.logtype=="TRASHED"){str=str+" moved the project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>' to trash \n\n";}if(thisClass.logtype=="RESTORED"){str=str+" restored the project: '<span class='mfNfProjectName'>"+thisClass.projectName+"</span>'  from trash \n\n";}str=str+"<span class='mfNotificationDate'>"+curr_date+" "+MF_Utils.getMonthByName(d.getMonth())+" "+curr_year+"</span>";return str;});this.__defineSetter__("logMessage",function(val){logMessage=val;});var profileImage="";this.__defineGetter__("profileImage",function(){var cr=thisClass.creator;if(cr=="mockflow@produle.com"){cr="dummymf";}var str=MF_Utils.get_gravatar(cr,30);return str;});this.__defineSetter__("profileImage",function(val){profileImage=val;});this.cast=function(obj){this.id=obj.id;this.projectName=obj.projectName;this.projectid=obj.projectid;this.creator=obj.creator;this.createDate=obj.createDate;this.creatorName=obj.creatorName;this.logtype=obj.logtype;this.opened=obj.opened;this.receiver=obj.receiver;};}function MF_Image(){var thisClass=this;this.id=null;this.name=null;this.type=null;this.creator=null;this.createDate=null;this.width=0;this.height=0;this.projectid=null;this.clientid=null;var thumbnailURL="";this.__defineGetter__("thumbnailURL",function(){if(thisClass.id.indexOf(".svg")!=-1){return MF_Global.getS3URL()+"app/wireframepro/company/"+thisClass.clientid+"/projects/"+thisClass.projectid+"/images/"+thisClass.id;}else{return MF_Global.getS3URL()+"app/wireframepro/company/"+thisClass.clientid+"/projects/"+thisClass.projectid+"/images/thumbnails/"+thisClass.id;}});this.__defineSetter__("thumbnailURL",function(val){thumbnailURL=val;});var validID="";this.__defineGetter__("validID",function(){return thisClass.id.replaceAll(".","_");});this.__defineSetter__("validID",function(val){validID=val;});var isSVG=false;this.__defineGetter__("isSVG",function(){if(thisClass.id.indexOf(".svg")!=-1){return true;}else{return false;}});this.__defineSetter__("isSVG",function(val){isSVG=val;});var imageURL="";this.__defineGetter__("imageURL",function(){return MF_Global.getS3URL()+"app/wireframepro/company/"+thisClass.clientid+"/projects/"+thisClass.projectid+"/images/"+thisClass.id;});this.__defineSetter__("imageURL",function(val){imageURL=val;});this.cast=function(obj){this.id=obj.id;this.name=obj.name;this.type=obj.type;this.creator=obj.creator;this.createDate=obj.createDate;this.width=obj.width;this.height=obj.height;this.projectid=obj.projectid;this.clientid=obj.clientid;};}function MF_Log(){var thisClass=this;this.id=null;this.projectid=null;this.clientid=null;this.log=null;this.creator=null;this.createDate=null;this.creatorName=null;this.logtype=null;var logMessage="";this.__defineGetter__("logMessage",function(){var str=" ";var d=thisClass.createDate;if(d==null){d=new Date();}var curr_date=d.getDate();var curr_month=d.getMonth()+1;var curr_year=d.getFullYear();str=str+"["+curr_date+"-"+curr_month+"-"+curr_year+"] - ";if(MF_UserSession.getUser()&&thisClass.creator.toLowerCase()==MF_UserSession.getUser().username.toLowerCase()){str=str+"You have";}else{str=str+thisClass.creatorName+" has";}str=str+" "+thisClass.log+" \n\n";return str;});this.__defineSetter__("logMessage",function(val){logMessage=val;});var logIcon="";this.__defineGetter__("logIcon",function(){var str="images/logicons/update.png";if(thisClass.logtype=="ADD-MEMBER-EDITOR"||thisClass.logtype=="ADD-MEMBER-REVIEWER"||thisClass.logtype=="ADD-MEMBER-ADMIN"||thisClass.logtype=="ADD-MEMBER"){str="images/logicons/add_member.png";}if(thisClass.logtype=="DEL-MEMBER"){str="images/logicons/delete_member.png";}if(thisClass.logtype=="MEMBER-EDITOR"||thisClass.logtype=="MEMBER-REVIEWER"||thisClass.logtype=="MEMBER-ADMIN"){str="images/logicons/membertype.png";}if(thisClass.logtype=="RENAMED"){str="images/logicons/rename_project.png";}if(thisClass.logtype=="COMMENTED"){str="images/logicons/comment.png";}if(thisClass.logtype=="RATING"){str="images/logicons/rating.png";}if(thisClass.logtype=="ADD-VARIATION"){str="images/logicons/addvariation.png";}if(thisClass.logtype=="DEL-VARIATION"){str="images/logicons/delvariation.png";}if(thisClass.logtype=="REVERT-REVISION"){str="images/logicons/revert_revision.png";}return str;});this.__defineSetter__("logIcon",function(val){logIcon=val;});this.cast=function(obj){this.id=obj.id;this.projectid=obj.projectid;this.clientid=obj.clientid;this.log=obj.log;this.creator=obj.creator;this.createDate=obj.createDate;this.creatorName=obj.creatorName;this.logtype=obj.logtype;};}function MF_UserInactive(){var thisClass=this;this.firstName=null;this.lastName=null;this.username=null;this.password=null;this.companyName=null;this.activateKey=null;this.expiry=null;this.createDate=null;}function MF_Company(){var thisClass=this;this.companyid=null;this.pid=null;this.dbserver=null;this.edition=null;this.createDate=null;this.creator=null;this.status=null;this.storage=null;this.plimit=1;}function MF_DashboardData(){var thisClass=this;this.logshared=null;this.labels=null;this.projects=null;this.ownedProjectsCount=0;this.sharedProjectsCount=0;this.totalProjectsCount=0;this.publicProjectsCount=0;this.trashProjectsCount=0;this.readonlyProjectsCount=0;}function MF_ProjectLabel(){var thisClass=this;this.id=null;this.name=null;this.color=null;this.createDate=null;this.clientid=null;this.projects=null;this.defaultLabel=false;this.count=0;var labelIconVisible="";this.__defineGetter__("labelIconVisible",function(){if(thisClass.id=="gap"){return false;}return true;});this.__defineSetter__("labelIconVisible",function(val){labelIconVisible=val;});var labelIcon="";this.__defineGetter__("labelIcon",function(){if(thisClass.id=="all"){return"mficon-document";}if(thisClass.id=="owner"){return"mficon-cloud";}if(thisClass.id=="shared"){return"mficon-group";}if(thisClass.id=="public"){return"mficon-globe";}if(thisClass.id=="trash"){return"mficon-trash2";}if(thisClass.id=="readonly"){return"mficon-box";}if(thisClass.id=="gap"){return"";}return"mficon-ellipse";});this.__defineSetter__("labelIcon",function(val){labelIcon=val;});this.cast=function(obj){this.id=obj.id;this.name=obj.name;this.color=obj.color;this.createDate=obj.createDate;this.clientid=obj.clientid;this.projects=obj.projects;};}function MF_TeamMember(){var thisClass=this;this.id=null;this.userid=null;this.license=null;this.type=null;var profileImage="";this.__defineGetter__("profileImage",function(){var cr=thisClass.userid;if(cr=="mockflow@produle.com"){cr="dummymf";}var str=MF_Utils.get_gravatar(cr,48);return str;});this.__defineSetter__("profileImage",function(val){profileImage=val;});this.cast=function(obj){this.userid=obj.userid;this.license=obj.license;this.type=obj.type;this.id=obj.id;};}function MF_Collaborator(){var thisClass=this;this.id=null;this.projectid=null;this.userid=null;this.type=null;this.online=false;this.sharePerm=null;var profileImage="";this.__defineGetter__("profileImage",function(){var str=MF_Utils.get_gravatar(thisClass.userid,64);return str;});this.__defineSetter__("profileImage",function(val){profileImage=val;});var memberType="";this.__defineGetter__("memberType",function(){if(thisClass.type=="Admin"){return"Admin";}if(thisClass.type=="Editor"){return"Editor";}if(thisClass.type=="Reviewer"){return"Reviewer";}return"Owner";});this.__defineSetter__("profileImage",function(val){memberType=val;});this.cast=function(obj){this.id=obj.id;this.projectid=obj.projectid;this.userid=obj.userid;this.type=obj.type;this.online=obj.online;this.sharePerm=obj.sharePerm;};}function MF_User(){var thisClass=this;this.firstName="dd";this.lastName="cc";this.createDate=null;this.username="";this.password="";this.company="";this.type="";this.companyName="";this.pid="";this.lastLogin=null;this.tokenKey="";this.projectsLeft=0;this.isBasic=true;this.isTrial=false;this.hadTrial=false;this.daysLeft=0;this.accountType="";this.offlineMode=false;this.teamEditor=false;this.teamPremium=false;this.teamLicenseOwner="";this.plusEdition=null;var createDateStr="";this.__defineGetter__("createDateStr",function(){if(thisClass.createDate!=null){var curr_date=thisClass.createDate.getDate();var curr_month=thisClass.createDate.getMonth()+1;var curr_year=thisClass.createDate.getFullYear();return curr_date+" "+MF_Utils.getMonthByName(thisClass.createDate.getMonth())+" "+curr_year;}else{return thisClass.createDate;}});this.__defineSetter__("createDateStr",function(val){createDateStr=val;});var isNewLicense=false;this.__defineGetter__("isNewLicense",function(){if(thisClass.createDate!=null){var changeLicenseDate=new Date(2018,3,22);if(thisClass.createDate>changeLicenseDate){return true;}}return isNewLicense;});this.__defineSetter__("isNewLicense",function(val){});var profileImage="";this.__defineGetter__("profileImage",function(){var str=MF_Utils.get_gravatar(thisClass.username,48);return str;});this.__defineSetter__("profileImage",function(val){profileImage=val;});}var MF_UserSession=(function(){var user=new MF_User();function privateMethod(){}return{getUser:function(){return user;},IsOpenAllowed:function(){if(MF_UserSession.getUser()){if(MF_UserSession.getUser().isBasic){if(MF_UserSession.getUser().hadTrial){return false;}if(mf_main.dashboardController.projectController.projectCollection){var count=0;for(var i=0;i<mf_main.dashboardController.projectController.projectCollection.size();i++){var mock=mf_main.dashboardController.projectController.projectCollection.getItemAt(i);if(mock.company==MF_UserSession.getUser().company){count++;}if(count>2){return false;}}return true;}}else{return true;}}return false;},createAllowedAlertMsg:function(){var msg="Your Basic MockFlow account allows only 1 project, Upgrade account for unlimited projects";if(MF_UserSession.getUser()){if(MF_UserSession.getUser().isBasic){if(MF_UserSession.getUser().hadTrial){msg="Your Trial Period has expired. Upgrade account for continued access";}}}return msg;},createAllowedAlertMsg2:function(){var msg="Your Basic MockFlow account allows only 1 project, Upgrade account at MockFlow.com for unlimited projects.";if(MF_UserSession.getUser()){if(MF_UserSession.getUser().isBasic){if(MF_UserSession.getUser().hadTrial){msg="Your Trial Period has expired. Upgrade account at MockFlow.com for continued access";}}}return msg;},createAllowed2:function(){if(MF_UserSession.getUser()){if(MF_UserSession.getUser().isBasic){if(MF_UserSession.getUser().hadTrial){return false;}if(mf_main.PROJECT_COUNT>=1){return false;}if(mf_main.isAllowedToCreateProject){return true;}return false;}else{return true;}}return false;},openAllowed2:function(){if(MF_UserSession.getUser()){if(MF_UserSession.getUser().isBasic){if(MF_UserSession.getUser().hadTrial){return false;}if(mf_main.PROJECT_COUNT==1||mf_main.PROJECT_COUNT==0){return true;}else{return false;}if(mf_main.isAllowedToCreateProject){return true;}return false;}else{return true;}}return false;},createAllowed:function(){if(MF_UserSession.getUser()){if(MF_UserSession.getUser().isBasic){if(MF_UserSession.getUser().hadTrial){return false;}if(mf_main.dashboardController.projectController.projectCollection){var count=0;for(var i=0;i<mf_main.dashboardController.projectController.projectCollection.size();i++){var mock=mf_main.dashboardController.projectController.projectCollection.getItemAt(i);if(mock.company==MF_UserSession.getUser().company){count++;}if(count>=1){return false;}}return true;}}else{return true;}}return false;}};})();var MF_Permission=(function(){function privateMethod(){}return{deny:function(projectObj,permission){if(projectObj&&projectObj.checkPermission&&projectObj.sharePerm){if(projectObj.permissionType=="Admin"){return false;}if(permission=="canViewLog"){if(!projectObj.sharePerm.canViewLog){return true;}}if(permission=="canViewMembers"){if(!projectObj.sharePerm.canViewMembers){return true;}}if(permission=="canUploadImage"){if(projectObj.permissionType=="Reviewer"){return true;}if(!projectObj.sharePerm.canUploadImage){return true;}}if(permission=="canDeleteImage"){if(projectObj.permissionType=="Reviewer"){return true;}if(!projectObj.sharePerm.canDeleteImage){return true;}}if(permission=="canPreviewRevision"){if(projectObj.permissionType=="Reviewer"){return true;}if(!projectObj.sharePerm.canPreviewRevision){return true;}}if(permission=="canDeleteRevision"){if(projectObj.permissionType=="Reviewer"){return true;}if(!projectObj.sharePerm.canDeleteRevision){return true;}}if(permission=="canChangeSiteMap"){if(projectObj.permissionType=="Reviewer"){return true;}if(!projectObj.sharePerm.canChangeSiteMap){return true;}}if(permission=="canExportData"){if(projectObj.permissionType=="Reviewer"){return true;}if(!projectObj.sharePerm.canExportData){return true;}}if(permission=="canUploadFont"){if(projectObj.permissionType=="Reviewer"){return true;}if(!projectObj.sharePerm.canUploadImage){return true;}}}return false;}};})();function MF_WireframeTemplate(){var thisClass=this;this.id=null;this.title=null;this.tags=null;this.type=null;this.submitter=null;this.cid=null;this.createDate=null;this.rating=0;this.abuse=false;this.downloads=0;this.premium=false;this.featured=false;this.submitterName=null;this.width=0;this.height=0;var createDateStr="";this.__defineGetter__("createDateStr",function(){if(thisClass.createDate!=null){var curr_date=thisClass.createDate.getDate();var curr_month=thisClass.createDate.getMonth()+1;var curr_year=thisClass.createDate.getFullYear();var hours=thisClass.createDate.getHours();var minutes=thisClass.createDate.getMinutes();return curr_date+" "+MF_Utils.getMonthByName(thisClass.createDate.getMonth())+" "+curr_year+" - "+hours+":"+minutes;}else{return thisClass.createDate;}});this.__defineSetter__("createDateStr",function(val){createDateStr=val;});var thumbnailURL="";this.__defineGetter__("thumbnailURL",function(){return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/store/templates/"+thisClass.id+"/thumbnail/"+thisClass.id;});this.__defineSetter__("thumbnailURL",function(val){thumbnailURL=val;});var pdfURL="";this.__defineGetter__("pdfURL",function(){return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/store/templates/"+thisClass.id+"/pdf/"+thisClass.id+".pdf";});this.__defineSetter__("pdfURL",function(val){imageURL=val;});this.cast=function(obj){this.id=obj.id;this.title=obj.title;this.tags=obj.tags;this.type=obj.type;this.submitter=obj.submitter;this.cid=obj.cid;this.createDate=obj.createDate;this.rating=obj.rating;this.abuse=obj.abuse;this.downloads=obj.downloads;this.premium=obj.premium;this.featured=obj.featured;this.submitterName=obj.submitterName;this.width=obj.width;this.height=obj.height;};}function MF_PackData(){var thisClass=this;this.comppacks=null;this.sortpacks=null;}function MF_MeshGrid(){var thisClass=this;this.type="mesh";this.lineColor="#cccccc";this.snap=true;this.size=20;this.position="behind";this.showInViewer=false;this.meshType="line";this.getXML=function(){var xml="<grid ";xml=xml+" type='mesh' ";xml=xml+" meshType='"+thisClass.meshType+"' ";xml=xml+" lineColor='"+thisClass.lineColor+"' ";xml=xml+" snap="+thisClass.snap.toString();+" ";xml=xml+" showInViewer="+thisClass.showInViewer.toString();+" ";xml=xml+" size="+thisClass.size+" ";xml=xml+" position='"+thisClass.position+"' ";xml=xml+" ></grid>";return xml;};this.setXML=function(xmlobj){thisClass.lineColor=xmlobj.attr("lineColor");thisClass.position=xmlobj.attr("position");if(xmlobj.attr("snap")=="true"){thisClass.snap=true;}else{thisClass.snap=false;}if(xmlobj.attr("showInViewer")=="true"){thisClass.showInViewer=true;}else{thisClass.showInViewer=false;}thisClass.size=parseInt(xmlobj.attr("size"));if(xmlobj.attr("meshType")){thisClass.meshType=xmlobj.attr("meshType");}};this.cast=function(obj){thisClass.lineColor=obj.lineColor;thisClass.snap=obj.snap;thisClass.size=obj.size;thisClass.position=obj.position;thisClass.showInViewer=obj.showInViewer;if(obj.meshType){thisClass.meshType=obj.meshType;}};this.setGrid=function(count){if(mf_main.RENDER||mf_main.REVISION){return;}if(mf_main.editorController.VIEWER&&thisClass.showInViewer==false){$("#mfGrid").remove();return;}$("#mfGrid").remove();var htmldiv;if(thisClass.meshType=="line"){htmldiv="<div id='mfGrid' class='mfMeshGrid' style='background-size: "+thisClass.size+"px "+thisClass.size+"px; background-image: linear-gradient(to right, "+thisClass.lineColor+" 1px, transparent 1px), linear-gradient(to bottom, "+thisClass.lineColor+"  1px, transparent 1px); '></div>";}else{if(thisClass.meshType="dotted"){htmldiv="<div id='mfGrid' class='mfMeshGrid' style='background-size: "+thisClass.size+"px "+thisClass.size+"px; background-image: radial-gradient("+thisClass.lineColor+" 6%, transparent 2px);background-position:"+thisClass.size/2+"px "+thisClass.size/2+"px'></div>";}}if(thisClass.position=="behind"){$("#mfContainerPage").prepend(htmldiv);}else{$("#mfContainerPage").append(htmldiv);$("#mfGrid").css("z-index",mf_main.editorController.loadedPages.length+10);}};}function MF_960Grid(){var thisClass=this;this.type="960";this.columnColor="#f44336";this.columnSize=60;this.gutterSize=10;this.position="behind";this.showInViewer=false;this.getXML=function(){var xml="<grid ";xml=xml+" type='960' ";xml=xml+" columnColor='"+thisClass.columnColor+"' ";xml=xml+" showInViewer="+thisClass.showInViewer.toString();+" ";xml=xml+" columnSize="+thisClass.columnSize+" ";xml=xml+" gutterSize="+thisClass.gutterSize+" ";xml=xml+" position='"+thisClass.position+"' ";xml=xml+" ></grid>";return xml;};this.cast=function(obj){thisClass.columnColor=obj.columnColor;thisClass.columnSize=obj.columnSize;thisClass.gutterSize=obj.gutterSize;thisClass.position=obj.position;thisClass.showInViewer=obj.showInViewer;};this.setXML=function(xmlobj){thisClass.columnColor=xmlobj.attr("columnColor");thisClass.position=xmlobj.attr("position");if(xmlobj.attr("showInViewer")=="true"){thisClass.showInViewer=true;}else{thisClass.showInViewer=false;}thisClass.columnSize=parseInt(xmlobj.attr("columnSize"));thisClass.gutterSize=parseInt(xmlobj.attr("gutterSize"));};this.setGrid=function(count){if(mf_main.RENDER||mf_main.REVISION){return;}if(mf_main.editorController.VIEWER&&thisClass.showInViewer==false){$("#mfGrid").remove();return;}$("#mfGrid").remove();var colcolorrgb=MF_ComponentUtils.hexToRGB(thisClass.columnColor,0.2);var htmldiv="<div id='mfGrid' style='position: absolute; pointer-events: none; width: 100%; height: 100%; background-color: transparent; background-size: "+(thisClass.columnSize+thisClass.gutterSize)+"px "+(thisClass.columnSize+thisClass.gutterSize)+"px; background-image: linear-gradient(90deg, transparent "+thisClass.gutterSize+"px, "+colcolorrgb+" "+thisClass.gutterSize+"px); '></div>";if(thisClass.position=="behind"){$("#mfContainerPage").prepend(htmldiv);}else{$("#mfContainerPage").append(htmldiv);$("#mfGrid").css("z-index",mf_main.editorController.loadedPages.length+10);}};}function MF_FavouriteColor(){var thisClass=this;this.id=null;this.code=null;this.title=null;this.sort=null;}function MF_CustomFont(){var thisClass=this;this.id=null;this.projectid=null;this.clientid=null;this.filename=null;this.filetype=null;this.filesize=null;this.creator=null;this.preview=false;this.cast=function(obj){this.id=obj.id;this.projectid=obj.projectid;this.clientid=obj.clientid;this.filename=obj.filename;this.filetype=obj.filetype;this.filesize=obj.filesize;this.creator=obj.creator;this.preview=obj.preview;};}function MF_Powerup(){var thisClass=this;this.id=null;this.slug=null;this.name=null;this.description=null;this.details=null;this.detailsMarkdown=null;this.category=null;this.creator=null;this.source=null;this.mode="all";this.license="free";this.installed=false;this.installationid=null;this.sortorder=1;this.isPublic=false;this.cast=function(obj){thisClass.id=obj.id;thisClass.slug=obj.slug;thisClass.name=obj.name;thisClass.description=obj.description;thisClass.details=obj.details;thisClass.detailsMarkdown=obj.detailsMarkdown;thisClass.category=obj.category;thisClass.creator=obj.creator;thisClass.source=obj.source;thisClass.mode=obj.mode;thisClass.license=obj.license;thisClass.installed=obj.installed;thisClass.installationid=obj.installationid;thisClass.sortorder=obj.sortorder;thisClass.isPublic=obj.isPublic;};var iconURL="";this.__defineGetter__("iconURL",function(){return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/powerups/assets/"+thisClass.id+"/icon/"+thisClass.id;});this.__defineSetter__("iconURL",function(val){iconURL=val;});var thumbnailURL="";this.__defineGetter__("thumbnailURL",function(){return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/powerups/assets/"+thisClass.id+"/thumbnail/"+thisClass.id;});this.__defineSetter__("thumbnailURL",function(val){thumbnailURL=val;});var shortDescription="";this.__defineGetter__("shortDescription",function(){var shortDesc=thisClass.description;if(thisClass.description.length>57){shortDesc=shortDesc.substring(0,57)+" ...";}return shortDesc;});this.__defineSetter__("shortDescription",function(val){shortDescription=val;});}function MF_PowerupScreenshot(){var thisClass=this;this.id=null;this.powerupid=null;this.mediatype=null;this.filetype=null;this.sortorder=1;this.creator=null;this.cast=function(obj){thisClass.id=obj.id;thisClass.powerupid=obj.powerupid;thisClass.mediatype=obj.mediatype;thisClass.filetype=obj.filetype;thisClass.sortorder=obj.sortorder;thisClass.creator=obj.creator;};var screenshotURL="";this.__defineGetter__("screenshotURL",function(){return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/powerups/assets/"+thisClass.powerupid+"/screenshots/"+thisClass.id;});this.__defineSetter__("screenshotURL",function(val){screenshotURL=val;});var thumbnailURL="";this.__defineGetter__("thumbnailURL",function(){return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/powerups/assets/"+thisClass.powerupid+"/screenshots/thumbnail/"+thisClass.id;});this.__defineSetter__("thumbnailURL",function(val){thumbnailURL=val;});}function MF_SvgIconSet(){this.l=null;this.n=null;this.cast=function(obj){this.n=obj.n;this.l=obj.l;};}function MF_SvgData(){var thisClass=this;this.n=null;this.l=null;this.c=null;this.svgIconPackType=null;var svgURL="";this.__defineGetter__("svgURL",function(){if(MF_Global.getS3Bucket()=="assets.mockflow.com"){return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/svg/"+thisClass.svgIconPackType+"/"+thisClass.n;}else{return"https://s3.amazonaws.com/"+MF_Global.getS3Bucket()+"/app/wireframepro/svg/"+thisClass.svgIconPackType+"/"+thisClass.n;}});this.__defineSetter__("svgURL",function(val){svgURL=val;});this.cast=function(obj){this.n=obj.n;this.l=obj.l;this.c=obj.c;this.svgIconPackType=obj.svgIconPackType;};}function MF_DashboardRTCNotificationItem(){var thisClass=this;this.collabarators=new Array();this.messageStr=null;this.sender=MF_UserSession.getUser().firstName+" "+MF_UserSession.getUser().lastName;this.receiver=null;var profileImage="";this.__defineGetter__("profileImage",function(){var str=MF_Utils.get_gravatar(MF_UserSession.getUser().username,32);return str;});this.__defineSetter__("profileImage",function(val){profileImage=val;});this.cast=function(obj){thisClass.collabarators=obj.collabarators;thisClass.messageStr=obj.messageStr;thisClass.receiver=obj.receiver;};}function MF_LogController(){var thisClass=this;this.constructor=function(){};this.downgradeTeamMember=function(memberid){var log=new MF_Log();log.creator=MF_UserSession.getUser().username;log.creatorName=MF_UserSession.getUser().firstName;log.id=MF_Utils.guidGenerator();log.log="upgraded account to premium: "+memberid;log.logtype="MEMBER-UPGRADE";log.projectid="";var logshared=new MF_LogShared();logshared.creator=MF_UserSession.getUser().username;logshared.creatorName=MF_UserSession.getUser().firstName;logshared.id=MF_Utils.guidGenerator();logshared.projectName="";logshared.projectid="";logshared.logtype=log.logtype;logshared.receiver=memberid;MF_LogManager.add(MF_UserSession.getUser().company,log,logshared,{callback:function(){}});};this.upgradeTeamMember=function(memberid){var log=new MF_Log();log.creator=MF_UserSession.getUser().username;log.creatorName=MF_UserSession.getUser().firstName;log.id=MF_Utils.guidGenerator();log.log="downgraded account to basic: "+memberid;log.logtype="MEMBER-DOWNGRADE";log.projectid="";var logshared=new MF_LogShared();logshared.creator=MF_UserSession.getUser().username;logshared.creatorName=MF_UserSession.getUser().firstName;logshared.id=MF_Utils.guidGenerator();logshared.projectName="";logshared.projectid="";logshared.logtype=log.logtype;logshared.receiver=memberid;MF_LogManager.add(MF_UserSession.getUser().company,log,logshared,{callback:function(){}});};this.logMemberType=function(memberid,type,projectid,projectName){var log=new MF_Log();log.creator=MF_UserSession.getUser().username;log.creatorName=MF_UserSession.getUser().firstName;log.id=MF_Utils.guidGenerator();log.log="changed the role of "+memberid;if(type=="Editor"){log.log=log.log+" to Co-Editor";log.logtype="MEMBER-EDITOR";}else{if(type=="Admin"){log.log=log.log+" to Admin";log.logtype="MEMBER-ADMIN";}else{log.log=log.log+" to Reviewer";log.logtype="MEMBER-REVIEWER";}}log.projectid=projectid;var logshared=new MF_LogShared();logshared.creator=MF_UserSession.getUser().username;logshared.creatorName=MF_UserSession.getUser().firstName;logshared.id=MF_Utils.guidGenerator();logshared.projectName=projectName;logshared.projectid=projectid;logshared.logtype=log.logtype;logshared.receiver=memberid;MF_LogManager.add(MF_UserSession.getUser().company,log,logshared,{callback:function(){}});};this.logNewMember=function(memberid,type,projectid,projectName){var log=new MF_Log();log.creator=MF_UserSession.getUser().username;log.creatorName=MF_UserSession.getUser().firstName;log.id=MF_Utils.guidGenerator();log.log="shared this project with "+memberid;if(type=="Editor"){log.log=log.log+" (as Co-Editor)";log.logtype="ADD-MEMBER-EDITOR";}else{if(type=="Admin"){log.log=log.log+" (as Admin)";log.logtype="ADD-MEMBER-ADMIN";}else{log.log=log.log+" (as Reviewer)";log.logtype="ADD-MEMBER-REVIEWER";}}log.projectid=projectid;var logshared=new MF_LogShared();logshared.creator=MF_UserSession.getUser().username;logshared.creatorName=MF_UserSession.getUser().firstName;logshared.id=MF_Utils.guidGenerator();logshared.projectName=projectName;logshared.projectid=projectid;logshared.logtype=log.logtype;logshared.receiver=memberid;MF_LogManager.add(MF_UserSession.getUser().company,log,logshared,{callback:function(){}});};this.logDelMember=function(memberid,projectid,projectName){var log=new MF_Log();log.creator=MF_UserSession.getUser().username;log.creatorName=MF_UserSession.getUser().firstName;log.id=MF_Utils.guidGenerator();log.log="removed "+memberid+" from this project";log.logtype="DEL-MEMBER";log.projectid=projectid;var logshared=new MF_LogShared();logshared.creator=MF_UserSession.getUser().username;logshared.creatorName=MF_UserSession.getUser().firstName;logshared.id=MF_Utils.guidGenerator();logshared.projectName=projectName;logshared.projectid=projectid;logshared.logtype=log.logtype;logshared.receiver=memberid;MF_LogManager.add(MF_UserSession.getUser().company,log,logshared,{callback:function(){}});};this.logRename=function(oldname,project){var log=new MF_Log();log.creator=MF_UserSession.getUser().username;log.creatorName=MF_UserSession.getUser().firstName;log.id=MF_Utils.guidGenerator();log.log="renamed this project from '"+oldname+"'";log.logtype="RENAMED";log.projectid=project.id;MF_LogManager.add(MF_UserSession.getUser().company,log,null,{callback:function(){}});};this.logDelVariation=function(project,varid){var log=new MF_Log();log.creator=MF_UserSession.getUser().username;log.creatorName=MF_UserSession.getUser().firstName;log.id=MF_Utils.guidGenerator();log.log="deleted this design variation '"+varid+"'";log.logtype="DEL-VARIATION";log.projectid=project.id;MF_LogManager.add(project.company,log,null,{callback:function(){}});};}var MF_Utils=(function(){var user=new MF_User();function privateMethod(){}return{getUser:function(){return user;},roundUp5:function(v){return Math.ceil(v/5)*5;},IsMacPlatform:function(){try{if(window.navigator.platform&&(window.navigator.platform.toLowerCase().indexOf("mac")!=-1)){return true;}else{return false;}}catch(e){}return false;},getCorner:function(pivotX,pivotY,cornerX,cornerY,angle){var x,y,distance,diffX,diffY;diffX=cornerX-pivotX;diffY=cornerY-pivotY;distance=Math.sqrt(diffX*diffX+diffY*diffY);angle+=Math.atan2(diffY,diffX);x=pivotX+distance*Math.cos(angle);y=pivotY+distance*Math.sin(angle);return{x:x,y:y};},copyToClipBoard:function(){var returnState=false;try{if(document.execCommand("copy")){returnState=true;}}catch(errorMessage){console.log("HTML5 Copy to Clipboard is not supported in your browser");returnState=false;}return returnState;},copyToClipBoard2:function(elementToCopy){elementToCopy.focus();elementToCopy.select();var returnState=false;try{if(document.execCommand("copy")){returnState=true;MF_Utils.display_ActionIndicator("Copied to clipboard");}}catch(errorMessage){console.log("HTML5 Copy to Clipboard is not supported in your browser");returnState=false;}return returnState;},slideInDown:function(did){$("#tmDialogBackground").show(0,onDivShow);function onDivShow(){$(did).css("display","block");tm_main.interfaceResize();$(did).css({position:"absolute",top:-($(did).height())});$(did).animate({top:0+"px"},{duration:200,complete:function(){}});}},convertUndefinedPropToEmptyString:function(object){for(var key in object){if(typeof object[key]==undefined||object[key]=="undefined"){object[key]="";}}},htmlEscape:function(str){if(str!=""&&str){return String(str).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;");}else{return"";}},htmlUnescape:function(str){if(str!=""&&str){return String(str).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");}else{return"";}},loadsScripts:function(path){var paths=path.map(function(scr){return $.getScript(scr);});paths.push($.Deferred(function(deferred){$(deferred.resolve);}));return $.when.apply($,paths);},guidGenerator:function(){var S4=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1);};return"M"+(S4()+S4()+S4()+S4()+S4()+S4()+S4()+S4())+Date.now();},resolveUrls:function(feedbackMsg){var resolvedMsg=feedbackMsg;var urlPattern=/\b(https?:\/\/)?[a-zA-Z0-9\/\-:]+(\.[a-z0-9-+&@#\/%?=~_|!:,;]+)+/gi;var protocolList=/^((https?):\/\/)/i;var linkTemplate="<a href='{0}' target='_blank'>{0}</a>";var urlList=urlPattern.exec(feedbackMsg),currentUrl="";while(urlList!==null){currentUrl=urlList[0];if(!protocolList.test(currentUrl)){currentUrl="http://"+currentUrl;}resolvedMsg=resolvedMsg.replace(urlList[0],linkTemplate.replace("{0}",currentUrl).replace("{0}",urlList[0]));urlList=urlPattern.exec(feedbackMsg);}return resolvedMsg;},getParameterByName:function(name,url){if(!url){url=window.location.href;}name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);if(!results){return null;}if(!results[2]){return"";}return decodeURIComponent(results[2].replace(/\+/g," "));},xmlToString:function(xmlData){var xmlString=null;try{if(window.ActiveXObject){xmlString=xmlData.xml;}else{var oSerializer=new XMLSerializer();xmlString=oSerializer.serializeToString(xmlData[0]);}}catch(e){xmlString="";}return xmlString;},computePoints:function(startType,x,y,width,height){var obj=new Object();if(startType=="topLeft"){obj.startx=x;obj.starty=y;obj.endx=x+width;obj.endy=y+height;}if(startType=="topRight"){obj.startx=x+width;obj.starty=y;obj.endx=x;obj.endy=y+height;}if(startType=="bottomLeft"){obj.startx=x;obj.starty=y+height;obj.endx=x+width;obj.endy=y;}if(startType=="bottomRight"){obj.startx=x+width;obj.starty=y+height;obj.endx=x;obj.endy=y;}return obj;},pointTransform:function(point,center,angle){var theta=angle*(Math.PI/180);point.x-=center.x;point.y-=center.y;return{x:(point.x*Math.cos(theta*-1)+point.y*Math.sin(theta*-1))+center.x,y:(point.x*Math.sin(theta)+point.y*Math.cos(theta))+center.y};},getBooleanString:function(val){if(val){return"true";}else{return"false";}},rotate:function(id,angle){$("#"+id).css("-moz-transform","rotate("+angle+"deg)");$("#"+id).css("-webkit-transform","rotate("+angle+"deg)");$("#"+id).css("-o-transform","rotate("+angle+"deg)");$("#"+id).css("-ms-transform","rotate("+angle+"deg)");$("#"+id).css("transform","rotate("+angle+"deg)");},calculateDimensions:function(startx,starty,endx,endy,delta){var dim=new Object();if(endy>starty){dim.y=starty;dim.height=endy-starty;dim.starty=delta;dim.endy=dim.height+delta;}else{dim.y=endy;dim.height=starty-endy;dim.starty=dim.height+delta;dim.endy=delta;}if(endx>startx){dim.x=startx;dim.width=endx-startx;dim.startx=delta;dim.endx=dim.width+delta;}else{dim.x=endx;dim.width=startx-endx;dim.startx=dim.width+delta;dim.endx=delta;}if(dim.x>startx||dim.x>endx){dim.x=dim.x-dim.width;}if(dim.y>starty||dim.y>endy){dim.y=dim.y-dim.height;}dim.startType="topRight";var sx=dim.startx;var sy=dim.starty;if(sx==delta&&sy==delta){dim.startType="topLeft";}if(sx==(dim.width+delta)&&sy==delta){dim.startType="topRight";}if(sx==delta&&sy==(dim.height+delta)){dim.startType="bottomLeft";}if(sx==(dim.width+delta)&&sy==(dim.height+delta)){dim.startType="bottomRight";}return dim;},trim:function(s){var l=0;var r=s.length-1;while(l<s.length&&s[l]==" "){l++;}while(r>l&&s[r]==" "){r-=1;}return s.substring(l,r+1);},getCheckBoxValue:function(chkID){if($("#"+chkID).is(":checked")){return true;}else{return false;}},localToGlobal:function(_el){var target=_el,target_width=target.offsetWidth,target_height=target.offsetHeight,target_left=target.offsetLeft,target_top=target.offsetTop,gleft=0,gtop=0,rect={};var moonwalk=function(_parent){if(!!_parent){gleft+=_parent.offsetLeft;gtop+=_parent.offsetTop;moonwalk(_parent.offsetParent);}else{return rect={top:target.offsetTop+gtop,left:target.offsetLeft+gleft,bottom:(target.offsetTop+gtop)+target_height,right:(target.offsetLeft+gleft)+target_width};}};moonwalk(target.offsetParent);return rect;},globalToLocalPoint:function(e,elementid){if($("#"+elementid).length){var localoffsetX=$("#"+elementid).offset().left;var localoffsetY=$("#"+elementid).offset().top;var localx=Math.floor(e.pageX-localoffsetX);var localy=Math.floor(e.pageY-localoffsetY);var lpt=new Object();lpt.x=localx;lpt.y=localy;return lpt;}else{var lpt=new Object();lpt.x=0;lpt.y=0;return lpt;}},globalToLocalPoint2:function(x,y,elementid){if($("#"+elementid).length){var localoffsetX=$("#"+elementid).offset().left;var localoffsetY=$("#"+elementid).offset().top;var localx=Math.floor(x-localoffsetX);var localy=Math.floor(y-localoffsetY);var lpt=new Object();lpt.x=localx;lpt.y=localy;return lpt;}else{var lpt=new Object();lpt.x=0;lpt.y=0;return lpt;}},localToGlobalPoint:function(xpt,ypt,elementid){if($("#"+elementid).length){var localoffsetX=$("#"+elementid).offset().left;var localoffsetY=$("#"+elementid).offset().top;var localx=Math.floor(xpt+localoffsetX);var localy=Math.floor(ypt+localoffsetY);var lpt=new Object();lpt.x=localx;lpt.y=localy;return lpt;}else{var lpt=new Object();lpt.x=0;lpt.y=0;return lpt;}},getMonthByName:function(num){var m_names=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");return m_names[num];},htmlEncode:function(val){return $("<div/>").text(val).html();},htmlDecode:function(val){return $("<div/>").html(val).text();},isValidEmailAddress:function(emailAddress){var pattern2=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return pattern2.test(emailAddress);},findPos:function(obj){var curleft=curtop=0;if(obj.offsetParent){curleft=obj.offsetLeft;curtop=obj.offsetTop;while(obj=obj.offsetParent){curleft+=obj.offsetLeft;curtop+=obj.offsetTop;}}return[curleft,curtop];},display_ActionIndicator:function(msg){$("#mfActionIndicator").css({position:"absolute",top:0,left:(($(window).width()/2)-($("#mfActionIndicator").width()/2))});$("#mfActionIndicatorMessage").text(msg);$("#mfActionIndicator").fadeTo("fast",1.5);setTimeout(function(){$("#mfActionIndicator").css("display","none");},2000);return;},display_menu:function(parent,named,e){var menu_element=document.getElementById(named);menu_element.style.display="";menu_element.style.left=e.pageX+"px";menu_element.style.top=e.pageY+"px";if((e.pageY+10+$("#"+named).height())>$(window).height()){menu_element.style.top=(e.pageY-$("#"+named).height())+"px";}return;},hide_menu:function(named){var menu_element=document.getElementById(named);if(menu_element){menu_element.style.display="none";}return;},roundedRect2:function(ctx,x,y,w,h,cornerRadius){cornerRadius=cornerRadius/2;ctx.beginPath();var theta,angle,cx,cy,px,py;if(cornerRadius>Math.min(w,h)/2){cornerRadius=Math.min(w,h)/2;}theta=Math.PI/4;ctx.moveTo(x+cornerRadius,y);ctx.lineTo(x+w-cornerRadius,y);angle=-Math.PI/2;cx=x+w-cornerRadius+(Math.cos(angle+(theta/2))*cornerRadius/Math.cos(theta/2));cy=y+cornerRadius+(Math.sin(angle+(theta/2))*cornerRadius/Math.cos(theta/2));px=x+w-cornerRadius+(Math.cos(angle+theta)*cornerRadius);py=y+cornerRadius+(Math.sin(angle+theta)*cornerRadius);ctx.quadraticCurveTo(cx,cy,px,py);angle+=theta;cx=x+w-cornerRadius+(Math.cos(angle+(theta/2))*cornerRadius/Math.cos(theta/2));cy=y+cornerRadius+(Math.sin(angle+(theta/2))*cornerRadius/Math.cos(theta/2));px=x+w-cornerRadius+(Math.cos(angle+theta)*cornerRadius);py=y+cornerRadius+(Math.sin(angle+theta)*cornerRadius);ctx.quadraticCurveTo(cx,cy,px,py);ctx.lineTo(x+w,y+h-cornerRadius);angle+=theta;cx=x+w-cornerRadius+(Math.cos(angle+(theta/2))*cornerRadius/Math.cos(theta/2));cy=y+h-cornerRadius+(Math.sin(angle+(theta/2))*cornerRadius/Math.cos(theta/2));px=x+w-cornerRadius+(Math.cos(angle+theta)*cornerRadius);py=y+h-cornerRadius+(Math.sin(angle+theta)*cornerRadius);ctx.quadraticCurveTo(cx,cy,px,py);angle+=theta;cx=x+w-cornerRadius+(Math.cos(angle+(theta/2))*cornerRadius/Math.cos(theta/2));cy=y+h-cornerRadius+(Math.sin(angle+(theta/2))*cornerRadius/Math.cos(theta/2));px=x+w-cornerRadius+(Math.cos(angle+theta)*cornerRadius);py=y+h-cornerRadius+(Math.sin(angle+theta)*cornerRadius);ctx.quadraticCurveTo(cx,cy,px,py);ctx.lineTo(x+cornerRadius,y+h);angle+=theta;cx=x+cornerRadius+(Math.cos(angle+(theta/2))*cornerRadius/Math.cos(theta/2));cy=y+h-cornerRadius+(Math.sin(angle+(theta/2))*cornerRadius/Math.cos(theta/2));px=x+cornerRadius+(Math.cos(angle+theta)*cornerRadius);py=y+h-cornerRadius+(Math.sin(angle+theta)*cornerRadius);ctx.quadraticCurveTo(cx,cy,px,py);angle+=theta;cx=x+cornerRadius+(Math.cos(angle+(theta/2))*cornerRadius/Math.cos(theta/2));cy=y+h-cornerRadius+(Math.sin(angle+(theta/2))*cornerRadius/Math.cos(theta/2));px=x+cornerRadius+(Math.cos(angle+theta)*cornerRadius);py=y+h-cornerRadius+(Math.sin(angle+theta)*cornerRadius);ctx.quadraticCurveTo(cx,cy,px,py);ctx.lineTo(x,y+cornerRadius);angle+=theta;cx=x+cornerRadius+(Math.cos(angle+(theta/2))*cornerRadius/Math.cos(theta/2));cy=y+cornerRadius+(Math.sin(angle+(theta/2))*cornerRadius/Math.cos(theta/2));px=x+cornerRadius+(Math.cos(angle+theta)*cornerRadius);py=y+cornerRadius+(Math.sin(angle+theta)*cornerRadius);ctx.quadraticCurveTo(cx,cy,px,py);angle+=theta;cx=x+cornerRadius+(Math.cos(angle+(theta/2))*cornerRadius/Math.cos(theta/2));cy=y+cornerRadius+(Math.sin(angle+(theta/2))*cornerRadius/Math.cos(theta/2));px=x+cornerRadius+(Math.cos(angle+theta)*cornerRadius);py=y+cornerRadius+(Math.sin(angle+theta)*cornerRadius);ctx.quadraticCurveTo(cx,cy,px,py);ctx.stroke();return;},roundedRect:function(ctx,x,y,width,height,radius){ctx.beginPath();ctx.moveTo(x,y+radius);ctx.lineTo(x,y+height-radius);ctx.quadraticCurveTo(x,y+height,x+radius,y+height);ctx.lineTo(x+width-radius,y+height);ctx.quadraticCurveTo(x+width,y+height,x+width,y+height-radius);ctx.lineTo(x+width,y+radius);ctx.quadraticCurveTo(x+width,y,x+width-radius,y);ctx.lineTo(x+radius,y);ctx.quadraticCurveTo(x,y,x,y+radius);ctx.stroke();return;},RGBToHex:function(color){if(color.substr(0,1)==="#"){return color;}var digits=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(color);var red=parseInt(digits[2]);var green=parseInt(digits[3]);var blue=parseInt(digits[4]);return"#"+MF_Utils.toHex(red)+MF_Utils.toHex(green)+MF_Utils.toHex(blue);},toHex:function(N){if(N==null){return"00";}N=parseInt(N);if(N==0||isNaN(N)){return"00";}N=Math.max(0,N);N=Math.min(N,255);N=Math.round(N);return"0123456789ABCDEF".charAt((N-N%16)/16)+"0123456789ABCDEF".charAt(N%16);},hexToRGB:function(hex,alpha){alpha=typeof(alpha)!="undefined"?alpha:"1";var rgbObj={red:((hex&16711680)>>16),green:((hex&65280)>>8),blue:((hex&255))};return"rgba("+rgbObj.red+","+rgbObj.green+","+rgbObj.blue+","+alpha+")";},randomInRange:function(min,max){var scale=max-min;return Math.floor(Math.random()*scale+min);},get_gravatar:function(email,size){var userName=MF_Utils.getMD5(email);var size=size||80;var profileImgUrl="https://mockflow.com/userProfileImage.jsp?userName="+userName+"&imageSize="+size;return profileImgUrl;},getMD5:function(data){var MD5=function(s){function L(k,d){return(k<<d)|(k>>>(32-d));}function K(G,k){var I,d,F,H,x;F=(G&2147483648);H=(k&2147483648);I=(G&1073741824);d=(k&1073741824);x=(G&1073741823)+(k&1073741823);if(I&d){return(x^2147483648^F^H);}if(I|d){if(x&1073741824){return(x^3221225472^F^H);}else{return(x^1073741824^F^H);}}else{return(x^F^H);}}function r(d,F,k){return(d&F)|((~d)&k);}function q(d,F,k){return(d&k)|(F&(~k));}function p(d,F,k){return(d^F^k);}function n(d,F,k){return(F^(d|(~k)));}function u(G,F,aa,Z,k,H,I){G=K(G,K(K(r(F,aa,Z),k),I));return K(L(G,H),F);}function f(G,F,aa,Z,k,H,I){G=K(G,K(K(q(F,aa,Z),k),I));return K(L(G,H),F);}function D(G,F,aa,Z,k,H,I){G=K(G,K(K(p(F,aa,Z),k),I));return K(L(G,H),F);}function t(G,F,aa,Z,k,H,I){G=K(G,K(K(n(F,aa,Z),k),I));return K(L(G,H),F);}function e(G){var Z;var F=G.length;var x=F+8;var k=(x-(x%64))/64;var I=(k+1)*16;var aa=Array(I-1);var d=0;var H=0;while(H<F){Z=(H-(H%4))/4;d=(H%4)*8;aa[Z]=(aa[Z]|(G.charCodeAt(H)<<d));H++;}Z=(H-(H%4))/4;d=(H%4)*8;aa[Z]=aa[Z]|(128<<d);aa[I-2]=F<<3;aa[I-1]=F>>>29;return aa;}function B(x){var k="",F="",G,d;for(d=0;d<=3;d++){G=(x>>>(d*8))&255;F="0"+G.toString(16);k=k+F.substr(F.length-2,2);}return k;}function J(k){k=k.replace(/rn/g,"n");var d="";for(var F=0;F<k.length;F++){var x=k.charCodeAt(F);if(x<128){d+=String.fromCharCode(x);}else{if((x>127)&&(x<2048)){d+=String.fromCharCode((x>>6)|192);d+=String.fromCharCode((x&63)|128);}else{d+=String.fromCharCode((x>>12)|224);d+=String.fromCharCode(((x>>6)&63)|128);d+=String.fromCharCode((x&63)|128);}}}return d;}var C=Array();var P,h,E,v,g,Y,X,W,V;var S=7,Q=12,N=17,M=22;var A=5,z=9,y=14,w=20;var o=4,m=11,l=16,j=23;var U=6,T=10,R=15,O=21;s=J(s);C=e(s);Y=1732584193;X=4023233417;W=2562383102;V=271733878;for(P=0;P<C.length;P+=16){h=Y;E=X;v=W;g=V;Y=u(Y,X,W,V,C[P+0],S,3614090360);V=u(V,Y,X,W,C[P+1],Q,3905402710);W=u(W,V,Y,X,C[P+2],N,606105819);X=u(X,W,V,Y,C[P+3],M,3250441966);Y=u(Y,X,W,V,C[P+4],S,4118548399);V=u(V,Y,X,W,C[P+5],Q,1200080426);W=u(W,V,Y,X,C[P+6],N,2821735955);X=u(X,W,V,Y,C[P+7],M,4249261313);Y=u(Y,X,W,V,C[P+8],S,1770035416);V=u(V,Y,X,W,C[P+9],Q,2336552879);W=u(W,V,Y,X,C[P+10],N,4294925233);X=u(X,W,V,Y,C[P+11],M,2304563134);Y=u(Y,X,W,V,C[P+12],S,1804603682);V=u(V,Y,X,W,C[P+13],Q,4254626195);W=u(W,V,Y,X,C[P+14],N,2792965006);X=u(X,W,V,Y,C[P+15],M,1236535329);Y=f(Y,X,W,V,C[P+1],A,4129170786);V=f(V,Y,X,W,C[P+6],z,3225465664);W=f(W,V,Y,X,C[P+11],y,643717713);X=f(X,W,V,Y,C[P+0],w,3921069994);Y=f(Y,X,W,V,C[P+5],A,3593408605);V=f(V,Y,X,W,C[P+10],z,38016083);W=f(W,V,Y,X,C[P+15],y,3634488961);X=f(X,W,V,Y,C[P+4],w,3889429448);Y=f(Y,X,W,V,C[P+9],A,568446438);V=f(V,Y,X,W,C[P+14],z,3275163606);W=f(W,V,Y,X,C[P+3],y,4107603335);X=f(X,W,V,Y,C[P+8],w,1163531501);Y=f(Y,X,W,V,C[P+13],A,2850285829);V=f(V,Y,X,W,C[P+2],z,4243563512);W=f(W,V,Y,X,C[P+7],y,1735328473);X=f(X,W,V,Y,C[P+12],w,2368359562);Y=D(Y,X,W,V,C[P+5],o,4294588738);V=D(V,Y,X,W,C[P+8],m,2272392833);W=D(W,V,Y,X,C[P+11],l,1839030562);X=D(X,W,V,Y,C[P+14],j,4259657740);Y=D(Y,X,W,V,C[P+1],o,2763975236);V=D(V,Y,X,W,C[P+4],m,1272893353);W=D(W,V,Y,X,C[P+7],l,4139469664);X=D(X,W,V,Y,C[P+10],j,3200236656);Y=D(Y,X,W,V,C[P+13],o,681279174);V=D(V,Y,X,W,C[P+0],m,3936430074);W=D(W,V,Y,X,C[P+3],l,3572445317);X=D(X,W,V,Y,C[P+6],j,76029189);Y=D(Y,X,W,V,C[P+9],o,3654602809);V=D(V,Y,X,W,C[P+12],m,3873151461);W=D(W,V,Y,X,C[P+15],l,530742520);X=D(X,W,V,Y,C[P+2],j,3299628645);Y=t(Y,X,W,V,C[P+0],U,4096336452);V=t(V,Y,X,W,C[P+7],T,1126891415);W=t(W,V,Y,X,C[P+14],R,2878612391);X=t(X,W,V,Y,C[P+5],O,4237533241);Y=t(Y,X,W,V,C[P+12],U,1700485571);V=t(V,Y,X,W,C[P+3],T,2399980690);W=t(W,V,Y,X,C[P+10],R,4293915773);X=t(X,W,V,Y,C[P+1],O,2240044497);Y=t(Y,X,W,V,C[P+8],U,1873313359);V=t(V,Y,X,W,C[P+15],T,4264355552);W=t(W,V,Y,X,C[P+6],R,2734768916);X=t(X,W,V,Y,C[P+13],O,1309151649);Y=t(Y,X,W,V,C[P+4],U,4149444226);V=t(V,Y,X,W,C[P+11],T,3174756917);W=t(W,V,Y,X,C[P+2],R,718787259);X=t(X,W,V,Y,C[P+9],O,3951481745);Y=K(Y,h);X=K(X,E);W=K(W,v);V=K(V,g);}var i=B(Y)+B(X)+B(W)+B(V);return i.toLowerCase();};var hashVal=MD5(data);return hashVal;},searchObjArray:function(arr,key,val){var indx=-1;for(var i=0;i<arr.length;i++){if(arr[i][key]===val){indx=i;return indx;}}return indx;},sanitizeSvgData:function(svgData){var idArrayCollection=[];var classArrayCollection=[];var currentTime=new Date().getTime();var tempSvgDivision=$("<div>");tempSvgDivision.append(svgData);tempSvgDivision.find("[id]").each(function(){$(this).attr("id",function(index,attr){idArrayCollection.push(attr);return attr+"_"+currentTime;});});tempSvgDivision.find("[class]").each(function(){$(this).attr("class",function(index,attr){var classNameArray=[];var classArray=attr.split(" ");classArray.forEach(function(elem,idx){classArrayCollection.push(elem);classNameArray.push(elem+"_"+currentTime);});return classNameArray.join(" ");});});tempSvgDivision.find("style").each(function(){var elem=$(this).text().replace(/ /g,"");for(i=0;i<idArrayCollection.length;i++){elem=elem.replace(new RegExp("#"+idArrayCollection[i]+"{","g"),"#"+idArrayCollection[i]+"_"+currentTime+"{");elem=elem.replace(new RegExp("#"+idArrayCollection[i]+",","g"),"#"+idArrayCollection[i]+"_"+currentTime+",");}for(i=0;i<classArrayCollection.length;i++){elem=elem.replace(new RegExp("."+classArrayCollection[i]+"{","g"),"."+classArrayCollection[i]+"_"+currentTime+"{");elem=elem.replace(new RegExp("."+classArrayCollection[i]+",","g"),"."+classArrayCollection[i]+"_"+currentTime+",");}$(this).text(elem);});var modifiedSvgData=tempSvgDivision.html();for(i=0;i<idArrayCollection.length;i++){modifiedSvgData=modifiedSvgData.replace(new RegExp("url\\(\\#"+idArrayCollection[i]+"\\)","g"),"url(#"+idArrayCollection[i]+"_"+currentTime+")");modifiedSvgData=modifiedSvgData.replace(new RegExp('\\"\\#'+idArrayCollection[i]+'\\"',"g"),'"#'+idArrayCollection[i]+"_"+currentTime+'"');}return modifiedSvgData;},getDashboardRTCCollabrators:function(sharedUser){if(mf_main.dashboardController.projectController.selectedProject!=null){var collabarators=[];var userIndex=-1;for(var i=0;i<mf_main.dashboardController.projectController.selectedProject.collaborators.length;i++){if(sharedUser&&sharedUser.toLowerCase()==mf_main.dashboardController.projectController.selectedProject.collaborators[i].userid.toLowerCase()){continue;}collabarators.push(mf_main.dashboardController.projectController.selectedProject.collaborators[i].userid);}collabarators.push(mf_main.dashboardController.projectController.selectedProject.creator);return collabarators;}},getClosestPoint:function(pathNode,point){var pathLength=pathNode.getTotalLength(),precision=8,best,bestLength,bestDistance=Infinity;for(var scan,scanLength=0,scanDistance;scanLength<=pathLength;scanLength+=precision){if((scanDistance=distance2(scan=pathNode.getPointAtLength(scanLength)))<bestDistance){best=scan,bestLength=scanLength,bestDistance=scanDistance;}}precision/=2;while(precision>0.5){var before,after,beforeLength,afterLength,beforeDistance,afterDistance;if((beforeLength=bestLength-precision)>=0&&(beforeDistance=distance2(before=pathNode.getPointAtLength(beforeLength)))<bestDistance){best=before,bestLength=beforeLength,bestDistance=beforeDistance;}else{if((afterLength=bestLength+precision)<=pathLength&&(afterDistance=distance2(after=pathNode.getPointAtLength(afterLength)))<bestDistance){best=after,bestLength=afterLength,bestDistance=afterDistance;}else{precision/=2;}}}best=[best.x,best.y];best.distance=Math.sqrt(bestDistance);return best;function distance2(p){var dx=p.x-point[0],dy=p.y-point[1];return dx*dx+dy*dy;}},};})();function MF_RTSController(){var thisClass=this;this.rtsSet=false;this.start=function(){MF_RTSServer.setSessionID(MF_UserSession.getUser().username,{callback:function(){dwr.engine.setActiveReverseAjax(true);thisClass.rtsSet=true;}});};this.sendRefreshDashboard=function(){if(thisClass.rtsSet){var rtsData=new MF_RTSData();rtsData.sessionID=MF_UserSession.getUser().username;rtsData.callType="refreshDashboard";rtsData.msg="";rtsData.UID=mf_main.UID;MF_RTSServer.communicate(rtsData,{callback:function(){}});}};this.parseRTSData=function(rtsData){if(rtsData){if(rtsData.callType="refreshDashboard"){mf_main.dashboardController.refreshHandler();}}};}function MF_RTSData(){var thisClass=this;this.sessionID=null;this.UID=null;this.callType=null;this.msg="";}function MF_RTSReceive(rtsData){if(rtsData.UID!=mf_main.UID){if(mf_main&&mf_main.rtsController){mf_main.rtsController.parseRTSData(rtsData);}}}function MF_DashboardRTCController(){var thisClass=this;this.sessionID=null;this.socket=null;this.disconnect=function(){if(thisClass.socket){thisClass.socket.disconnect();}};this.connect=function(){if(mf_main.RENDER){return;}if(MF_Global.getS3Bucket()=="testmfassets"){thisClass.socket=io.connect("http://localhost:8002");}else{thisClass.socket=io.connect("https://wireframepro.mockflow.com:8002");}thisClass.socket.on("connect",function(){thisClass.sessionID=MF_Utils.guidGenerator();thisClass.socket.emit("adduser",{sessionid:thisClass.sessionID,username:MF_UserSession.getUser().username});});thisClass.socket.on("updatemsg",function(username,data){if(data&&mf_main.dashboardController){var senderUsername=username;var cachedTemplate=mf_main.getTemplateFromCache("mfDashboardRTCTemplate");var senderName=MF_UserSession.getUser().firstName+" "+MF_UserSession.getUser().lastName;if(senderName==data.sender){data.sender="You";data.message=data.message.replace("has","have");}if(data.cmd=="project_share"){MF_LogSharedManager.list(MF_UserSession.getUser(),{callback:function(logData){mf_main.dashboardController.alertController.logSharedCollection=new ArrayCollection();mf_main.dashboardController.alertController.applyAlertTemplate(logData);}});if(cachedTemplate==null){$.get("templates/dashboard/DashboardRTCNotificationItem.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfDashboardRTCTemplate").html());mf_main.addTemplateToCache("mfDashboardRTCTemplate",template);$("#mfProjectNotificationMessageContainer").prepend(template(data));$("#mfProjectNotificationMessageWrapper").show();});}else{$("#mfProjectNotificationMessageContainer").prepend(cachedTemplate(data));$("#mfProjectNotificationMessageWrapper").show();}}if(data.cmd=="project_sync"){MF_LogSharedManager.list(MF_UserSession.getUser(),{callback:function(logData){mf_main.dashboardController.alertController.logSharedCollection=new ArrayCollection();mf_main.dashboardController.alertController.applyAlertTemplate(logData);}});if(cachedTemplate==null){$.get("templates/dashboard/DashboardRTCNotificationItem.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfDashboardRTCTemplate").html());mf_main.addTemplateToCache("mfDashboardRTCTemplate",template);$("#mfProjectNotificationMessageContainer").prepend(template(data));$("#mfProjectNotificationMessageWrapper").show();});}else{$("#mfProjectNotificationMessageContainer").prepend(cachedTemplate(data));$("#mfProjectNotificationMessageWrapper").show();}}}});};this.projectShareSync=function(cmd,rtcObj){var obj=new Object();obj.sessionID=thisClass.sessionID;obj.cmd=cmd;obj.sender=rtcObj.sender;obj.userobj=rtcObj.collabarators;obj.message=rtcObj.messageStr;obj.profileImage=rtcObj.profileImage;if(cmd=="project_share"){thisClass.socket.emit("sendmsg",obj);return;}if(cmd=="project_sync"){thisClass.socket.emit("sendmsg",obj);return;}};}function MF_TeamController(){var thisClass=this;this.constructor=function(){$("#mfTeamModal").on("show",thisClass.teamModalShowHandler);$("#mfTeamAddMemberBox").on("textchange",thisClass.textChangeHandler);$("#mfTeamAddMemberBox").on("keypress",thisClass.enterHandler);$("#mfTeamManagerAddBtn").on("click",thisClass.addClickHandler);};this.teamMembers=new ArrayCollection();this.selectedMember=null;this.listed=false;this.teamModalShowHandler=function(e){thisClass.list(true);$("#mfTeamAddMemberBox").val("");thisClass.textChangeHandler(null);$("#mfTeamAddMemberBox").focus();};this.enterHandler=function(e){var keycode=(e.keyCode?e.keyCode:e.which);if(keycode=="13"){thisClass.addNewMember();}};this.addClickHandler=function(e){thisClass.addNewMember();};this.textChangeHandler=function(e){var arr=$.grep(thisClass.teamMembers.toArray(),function(value,i){var str1=value.userid.toLowerCase();var str2=$("#mfTeamAddMemberBox").val().toLowerCase();if(str1.indexOf(str2)>=0){return true;}else{return false;}});for(var i=0;i<thisClass.teamMembers.size();i++){var item=thisClass.teamMembers.getItemAt(i);var showItem=false;for(var k=0;k<arr.length;k++){if(item.userid.toLowerCase()==arr[k].userid.toLowerCase()){showItem=true;}}if(!showItem){$("#mfTeamMemberItem"+item.id).css("height","0px");$("#mfTeamMemberItem"+item.id).css("display","none");}else{$("#mfTeamMemberItem"+item.id).css("height","30px");$("#mfTeamMemberItem"+item.id).css("display","block");}}};this.applyTemplate=function(arr,sync){if(sync==null){sync=false;}$("#mfTeamList").empty();$("#mfTeamManagerLoader").css("display","none");thisClass.teamMembers=new ArrayCollection();var cachedTemplate=mf_main.getTemplateFromCache("mfTeamMemberTemplate");if(cachedTemplate==null){$.get("templates/dashboard/TeamMember.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfTeamMemberTemplate").html());mf_main.addTemplateToCache("mfTeamMemberTemplate",template);thisClass.renderTeamMemberItem(template,arr,sync);});}else{thisClass.renderTeamMemberItem(cachedTemplate,arr,sync);}};this.renderTeamMemberItem=function(template,arr,sync){for(var i=0,j=arr.length;i<j;i++){thisClass.teamMembers.addItem(arr[i]);$("#mfTeamList").append(template(arr[i]));$("#mfTeamMemberItem"+arr[i].id).on("mouseover",thisClass.memberItemOver);$("#mfTeamMemberItem"+arr[i].id).on("mouseout",thisClass.memberItemOut);$("#mfTeamMemberItem"+arr[i].id).on("click",thisClass.memberItemClick);}$(".mfTeamMemberDelBtn").on("click",thisClass.deleteMemberHandler);if(sync){mf_main.dashboardController.projectController.shareController.applyTemplate(arr,false);}};this.deleteMemberHandler=function(e){e.stopImmediatePropagation();thisClass.selectDeleteMember($(this).attr("id"));thisClass.deleteMember();};this.list=function(sync){if(sync==null){sync=false;}if(thisClass.listed){return;}if(mf_main.dashboardController.projectController.shareController.listed){return;}$("#mfTeamManagerLoader").css("display","block");MF_TeamManager.list(MF_UserSession.getUser().company,{callback:function(arr){if(arr!=null){thisClass.listed=true;thisClass.applyTemplate(arr,sync);}}});};this.memberItemOver=function(e){if(thisClass.selectedMember!=null&&("mfTeamMemberItem"+thisClass.selectedMember.id)==$(this).attr("id")){}else{$(this).css({"background-color":"#f6f6f6"});}};this.memberItemOut=function(e){if(thisClass.selectedMember!=null&&("mfTeamMemberItem"+thisClass.selectedMember.id)==$(this).attr("id")){}else{$(this).css({"background-color":"#fff"});}};function clearMemberSelection(){for(var i=0;i<thisClass.teamMembers.size();i++){var item=thisClass.teamMembers.getItemAt(i);$("#mfTeamMemberItem"+item.id).css({"background-color":"#fff"});}}this.selectMember=function(pid){clearMemberSelection();for(var i=0;i<thisClass.teamMembers.size();i++){var item=thisClass.teamMembers.getItemAt(i);if("mfTeamMemberItem"+item.id==pid){this.selectedMember=item;$("#mfTeamMemberItem"+item.id).css({"background-color":"#f0f0f0"});break;}}};this.selectDeleteMember=function(pid){for(var i=0;i<thisClass.teamMembers.size();i++){var item=thisClass.teamMembers.getItemAt(i);if("mfTeamMemberDelBtn"+item.id==pid){this.selectedMember=item;break;}}};this.memberItemClick=function(e){thisClass.selectMember($(this).attr("id"));};this.deleteMember=function(){if(thisClass.selectedMember!=null){var answer=confirm('Remove "'+thisClass.selectedMember.userid+'" from your Team List?');if(answer){$("#mfTeamMemberItem"+thisClass.selectedMember.id).css("height","0px");$("#mfTeamMemberItem"+thisClass.selectedMember.id).css("display","none");$("#mfShareMemberItem"+thisClass.selectedMember.id).css("height","0px");$("#mfShareMemberItem"+thisClass.selectedMember.id).css("display","none");var tind=thisClass.teamMembers.getItemIndex(thisClass.selectedMember);if(tind!=-1){thisClass.teamMembers.removeItemAt(tind);}MF_TeamManager.deleteMember(MF_UserSession.getUser(),thisClass.selectedMember.userid,{callback:function(str){$("#mfTeamManagerLoader").css("display","none");}});}}};this.IsExist=function(email){for(var i=0;i<thisClass.teamMembers.size();i++){var user=thisClass.teamMembers.getItemAt(i);if(user.userid.toLowerCase()==email.toLowerCase()){return true;}}return false;};this.addNewMember=function(){var memberID=$("#mfTeamAddMemberBox").val();if(memberID.toLowerCase()==MF_UserSession.getUser().username.toLowerCase()){alert("You cannot share it with yourself");return;}if(memberID==""){return;}memberID=memberID.toLowerCase();if(!MF_Utils.isValidEmailAddress(memberID)){alert("Invalid email");return;}if(thisClass.IsExist(memberID)){alert("User already exists");return;}var mem=new MF_TeamMember();mem.id=MF_Utils.guidGenerator();mem.userid=$("#mfTeamAddMemberBox").val();mem.type="";mem.license="";$("#mfTeamAddMemberBox").val("");thisClass.textChangeHandler(null);thisClass.teamMembers.addItemAt(mem,0);thisClass.applyTemplate(thisClass.teamMembers.toArray(),true);MF_TeamManager.addMember(MF_UserSession.getUser().company,mem,MF_UserSession.getUser(),{callback:function(str){$("#mfTeamManagerLoader").css("display","none");if(str=="success"){}else{alert("Some error occurred");}}});};}function MF_AlertController(){var thisClass=this;this.logSharedCollection=new ArrayCollection();this.unreadItems=0;this.constructor=function(){this.drawNotificationBubble();$("#mfTeamAlertBtn").on("click",thisClass.openAlertHandler);$("#mfTeamAlertBubble").on("click",thisClass.openAlertHandler);$("#mfTeamAlertEmptyBtn").on("click",thisClass.emptyAlertDialogHandler);};this.alertListOver=function(e){$("#mfTeamAlertModalList").css("overflow-y","auto");};this.alertListOut=function(e){$("#mfTeamAlertModalList").css("overflow-y","hidden");};this.emptyAlertDialogHandler=function(e){e.stopPropagation();$("#mfTeamAlertModal").removeClass("animated scaleInSmall");$("#mfTeamAlertModal").css("display","none");var answer=confirm("Empty all notifications?");if(answer){thisClass.emptyAlerts();}};this.emptyAlerts=function(){$("#mfContentLoader").css("display","block");$("#mfContentHolder").css("display","none");MF_AccountManager.emptyAlerts(MF_UserSession.getUser(),{callback:function(dashboardData){mf_main.dashboardController.refreshHandler(null);}});};this.openAlertHandler=function(e){e.stopPropagation();if($("#mfTeamAlertModal").css("display")=="block"){$("#mfTeamAlertModal").css("display","none");}else{thisClass.hideNotificationBubble();$("#mfTeamAlertModal").css("display","block");$("#mfTeamAlertModal").css("right",(($("#mfCurrentLabelSelected").width()-6))+"px");$("#mfTeamAlertModal").css("top","300px");$("#mfTeamAlertModal").animate({top:51},300,"easeOutBack").show();if(thisClass.unreadItems>0){MF_LogSharedManager.readAll(MF_UserSession.getUser().username,{callback:function(){}});}}};this.applyAlertTemplate=function(arr){$("#mfTeamAlertModalList").empty();var cachedTemplate=mf_main.getTemplateFromCache("mfAlertItemTemplate");if(cachedTemplate==null){$.get("templates/dashboard/AlertItem.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfAlertItemTemplate").html());mf_main.addTemplateToCache("mfAlertItemTemplate",template);thisClass.renderAlertItems(template,arr);});}else{thisClass.renderAlertItems(cachedTemplate,arr);}};this.renderAlertItems=function(template,arr){thisClass.unreadItems=0;for(var i=0,j=arr.length;i<j;i++){var nitem=new MF_LogShared();nitem.cast(arr[i]);thisClass.logSharedCollection.addItem(nitem);$("#mfTeamAlertModalList").append(template(nitem));if(!nitem.opened){thisClass.unreadItems++;}$("#mfAlertItem"+arr[i].id).on("click",thisClass.alertItemClick);}if(thisClass.unreadItems>0){$("#mfTeamAlertBubbleNum").text(thisClass.unreadItems.toString());thisClass.showNotificationBubble();}};this.showNotificationBubble=function(){$("#mfTeamAlertBubble").css("display","block");thisClass.centerNotificationBubble();};this.centerNotificationBubble=function(){if($("#mfTeamAlertBubble").css("display")=="block"){$("#mfTeamAlertBubble").css("right","-5px");$("#mfTeamAlertBubble").css("z-index","10");$("#mfTeamAlertBubble").css("top",(-7).toString()+"px");}};this.hideNotificationBubble=function(){$("#mfTeamAlertBubble").css("display","none");};this.drawNotificationBubble=function(e){var ctx_Circle1=(document.getElementById("mfTeamAlertBubbleCvs")).getContext("2d");ctx_Circle1.fillStyle="#FF0000";ctx_Circle1.beginPath();ctx_Circle1.arc(5,5,20,Math.PI*2,0,true);ctx_Circle1.closePath();ctx_Circle1.fill();};this.alertItemClick=function(e){MF_Utils.hide_menu("mfTeamAlertModal");$("#mfTeamAlertModal").removeClass("animated scaleInSmall");var alertID=$(this).attr("id");var alertObj=thisClass.getSelectedAlert(alertID);if(alertObj){if(alertObj.logtype=="COMMENTED"){var midarr=alertObj.projectid.split("#pageid#");if(midarr.length==2){var mid=midarr[0];var pageid=midarr[1];var project=mf_main.dashboardController.projectController.getProjectByID(mid);if(project==null){mf_main.dashboardController.projectController.openProjectById(mid,"",true,pageid);return;}mf_main.dashboardController.projectController.openProject(project,"",true,pageid);}else{var project=mf_main.dashboardController.projectController.getProjectByID(alertObj.projectid);if(project==null){mf_main.dashboardController.projectController.openProjectById(alertObj.projectid,"",true,"all");return;}mf_main.dashboardController.projectController.openProject(project,"",true,"all");}}else{var project=mf_main.dashboardController.projectController.getProjectByID(alertObj.projectid);if(project==null){mf_main.dashboardController.projectController.openProjectById(alertObj.projectid,"");return;}mf_main.dashboardController.projectController.openProject(project,"");}}};this.getSelectedAlert=function(pid){for(var i=0;i<thisClass.logSharedCollection.size();i++){var item=thisClass.logSharedCollection.getItemAt(i);if("mfAlertItem"+item.id==pid){return item;}}return null;};}function MF_LabelController(){var thisClass=this;this.labelCollection=new ArrayCollection();this.allLabel=null;this.ownerLabel=null;this.sharedLabel=null;this.publicLabel=null;this.trashLabel=null;this.readonlyLabel=null;this.selectedLabel=null;this.constructor=function(){$("#mfLabelList").bind("sortstop",thisClass.sortLabelStopHandler);if(Modernizr.touch){$("#mfLabelList").css("overflow-y","auto");}else{$("#mfLabelList").on("mouseover",thisClass.labelListOver);$("#mfLabelList").on("mouseout",thisClass.labelListOut);}$("#mfLabelAddBtn,#mfAddNewLabel").on("click",thisClass.labelAddHandler);$("#mfLabelDelBtn").on("click",thisClass.labelRemoveHandler);$("#mfLabelHelpBtn").on("click",thisClass.labelHelpHandler);$("#mfLabelEditBtn").on("click",thisClass.labelEditHandler);$("#mfAddLabelModalCloseBtn").on("click",thisClass.closeHandler);$("#mfAddLabelModalBtn").on("click",thisClass.labelAddToServerHandler);$("#mfAddLabelModal").on("show",thisClass.addLabelShowHandler);$("#mfAddLabelModal").on("shown",thisClass.addLabelShownHandler);$("#mfAddLabelTitle").keypress(function(e){if(e.which==13){thisClass.labelAddToServerHandler(null);}});$("#mfHelpLabelModalCloseBtn").on("click",thisClass.closeHandler);$("#mfRenameLabelModal").on("show",thisClass.renameLabelShowHandler);$("#mfRenameLabelModal").on("shown",thisClass.renameLabelShownHandler);$("#mfRenameLabelModalCloseBtn").on("click",thisClass.closeHandler);$("#mfRenameLabelModalBtn").on("click",thisClass.labelRenameToServerHandler);$("#mfRenameLabelModalText").keypress(function(e){if(e.which==13){thisClass.labelRenameToServerHandler(null);}});};this.sortLabelStopHandler=function(e,ui){var d=new Date();var count=0;$("#mfLabelList").children().each(function(){count++;var label=thisClass.getLabelbyID($(this).attr("id"));if(label){label.createDate=new Date(d.getTime()+(count*1000));}});MF_LabelManager.updateLabels(thisClass.labelCollection.toArray(),{callback:function(){}});};this.labelListOver=function(e){$("#mfLabelList").css("overflow-y","auto");};this.labelListOut=function(e){$("#mfLabelList").css("overflow-y","hidden");};this.removeProjectFromDefaultLabel=function(project,owned){if(!project.readonly){thisClass.allLabel.count--;$("#mfLabelItemCount"+thisClass.allLabel.id).text(thisClass.allLabel.count.toString());if(owned){thisClass.ownerLabel.count--;$("#mfLabelItemCount"+thisClass.ownerLabel.id).text(thisClass.ownerLabel.count.toString());}else{thisClass.sharedLabel.count--;$("#mfLabelItemCount"+thisClass.sharedLabel.id).text(thisClass.sharedLabel.count.toString());}if(project.share){if(mf_main.dashboardController.projectController.selectedProject.creator==MF_UserSession.getUser().username){thisClass.publicLabel.count--;$("#mfLabelItemCount"+thisClass.publicLabel.id).text(thisClass.publicLabel.count.toString());}}}else{thisClass.readonlyLabel.count--;$("#mfLabelItemCount"+thisClass.readonlyLabel.id).text(thisClass.readonlyLabel.count.toString());}if(project.isdeleted){thisClass.trashLabel.count++;$("#mfLabelItemCount"+thisClass.trashLabel.id).text(thisClass.trashLabel.count.toString());}};this.removeProjectFromLabel=function(projectid,label){if(!label.defaultLabel){if(label.projects==null){label.projects="";}var newStr="";var arr=label.projects.split(",");var count=0;for(var i=0;i<arr.length;i++){var thisProjectID=arr[i];if(thisProjectID!=projectid){if(count==0){newStr=thisProjectID;}else{newStr=newStr+","+thisProjectID;}count++;}}label.projects=newStr;label.count=label.projects.split(",").length;if(label.projects.split(",").length>0){var lb1=label.projects.split(",")[0];if(lb1==""){label.count=label.count-1;}}if(label.count<0){label.count=0;}$("#mfLabelItemCount"+label.id).text(label.count.toString());}};this.closeHandler=function(){$(".modal").modal("hide");};this.renameLabelShowHandler=function(e){if(thisClass.selectedLabel){$("#mfRenameLabelModalText").val(thisClass.selectedLabel.name);}else{$("#mfRenameLabelModalText").val("");}};this.renameLabelShownHandler=function(e){$("#mfRenameLabelModalText").focus();};this.labelRenameToServerHandler=function(e){mf_main.closeDialog();var labelname=$.trim($("#mfRenameLabelModalText").val());if(labelname==""){alert("Label name cannot be empty");return;}if(thisClass.selectedLabel){thisClass.selectedLabel.name=labelname;$("#mfLabelItemName"+thisClass.selectedLabel.id).text(labelname);$("#mfCurrentLabelSelected p").text(labelname);}$("#mfRenameLabelModalText").val("");MF_LabelManager.update(thisClass.selectedLabel,{callback:function(){}});};this.labelAddToServerHandler=function(e){var labelname=$.trim($("#mfAddLabelTitle").val());if(labelname==""){alert("Label name cannot be empty");return;}$("#mfAddLabelModalScreen2").show();$("#mfAddLabelModalScreen1").hide();$("#mfAddLabelModalCloseBtn").hide();$("#mfAddLabelModalBtn").hide();$("#mfAddLabelModalTitle").text("Creating Label...");$("#mfAddLabelModalBtn").attr("disabled","disabled");var l=new MF_ProjectLabel();l.name=$("#mfAddLabelTitle").val();l.id=MF_Utils.guidGenerator();l.creator=MF_UserSession.getUser().username;l.clientid=MF_UserSession.getUser().company;l.color="0xCCCCCC";l.projects="";l.defaultLabel=false;l.createDate=new Date();MF_LabelManager.add(l,{callback:function(){thisClass.labelCollection.addItem(l);thisClass.listLabels();mf_main.closeDialog();}});};this.mfAddLabelModalReset=function(){$("#mfAddLabelModalScreen1").show();$("#mfAddLabelModalScreen2").hide();$("#mfAddLabelModalCloseBtn").show();$("#mfAddLabelModalBtn").show();$("#mfAddLabelModalTitle").text("New Label");$("#mfAddLabelModalBtn").removeAttr("disabled");$("#mfAddLabelTitle").val("");};this.addLabelShowHandler=function(e){thisClass.mfAddLabelModalReset();};this.addLabelShownHandler=function(e){$("#mfAddLabelTitle").focus();};this.labelAddHandler=function(e){$("#mfAddLabelModal").modal();};this.labelRemoveHandler=function(e){mf_main.dashboardController.closeLabelSideBar();if(thisClass.selectedLabel){if(thisClass.selectedLabel.defaultLabel){MF_Utils.display_ActionIndicator("Cannot remove 'Default' labels");}else{var answer=confirm('This will only delete the label "'+thisClass.selectedLabel.name+'" and not its projects. Continue?');if(answer){var lind=thisClass.labelCollection.getItemIndex(thisClass.selectedLabel);if(lind!=-1){thisClass.labelCollection.removeItemAt(lind);}thisClass.listLabels();MF_LabelManager.deleteLabel(thisClass.selectedLabel,{callback:function(){thisClass.selectedLabel=thisClass.allLabel;thisClass.listProjectsByLabel(thisClass.allLabel);}});thisClass.selectedLabel=thisClass.allLabel;}}}else{MF_Utils.display_ActionIndicator("No label selected");}};this.labelHelpHandler=function(e){mf_main.dashboardController.closeLabelSideBar();$("#mfHelpLabelModal").modal();};this.createDefaultLabels=function(){thisClass.allLabel=new MF_ProjectLabel();thisClass.allLabel.id="all";thisClass.allLabel.clientid=MF_UserSession.getUser().company;thisClass.allLabel.createDate=new Date();thisClass.allLabel.defaultLabel=true;thisClass.allLabel.projects="";thisClass.allLabel.color="#FFFFFF";thisClass.allLabel.name="All Wireframes";thisClass.ownerLabel=new MF_ProjectLabel();thisClass.ownerLabel.id="owner";thisClass.ownerLabel.clientid=MF_UserSession.getUser().company;thisClass.ownerLabel.createDate=new Date();thisClass.ownerLabel.defaultLabel=true;thisClass.ownerLabel.projects="";thisClass.ownerLabel.color="#FFFFFF";thisClass.ownerLabel.name="Owned by me";thisClass.sharedLabel=new MF_ProjectLabel();thisClass.sharedLabel.id="shared";thisClass.sharedLabel.clientid=MF_UserSession.getUser().company;thisClass.sharedLabel.createDate=new Date();thisClass.sharedLabel.defaultLabel=true;thisClass.sharedLabel.projects="";thisClass.sharedLabel.color="#FFFFFF";thisClass.sharedLabel.name="Shared by others";thisClass.publicLabel=new MF_ProjectLabel();thisClass.publicLabel.id="public";thisClass.publicLabel.clientid=MF_UserSession.getUser().company;thisClass.publicLabel.createDate=new Date();thisClass.publicLabel.defaultLabel=true;thisClass.publicLabel.projects="";thisClass.publicLabel.color="#FFFFFF";thisClass.publicLabel.name="Public Wireframes";thisClass.trashLabel=new MF_ProjectLabel();thisClass.trashLabel.id="trash";thisClass.trashLabel.clientid=MF_UserSession.getUser().company;thisClass.trashLabel.createDate=new Date();thisClass.trashLabel.defaultLabel=true;thisClass.trashLabel.projects="";thisClass.trashLabel.color="#FFFFFF";thisClass.trashLabel.name="Trash";thisClass.readonlyLabel=new MF_ProjectLabel();thisClass.readonlyLabel.id="readonly";thisClass.readonlyLabel.clientid=MF_UserSession.getUser().company;thisClass.readonlyLabel.createDate=new Date();thisClass.readonlyLabel.defaultLabel=true;thisClass.readonlyLabel.projects="";thisClass.readonlyLabel.color="#FFFFFF";thisClass.readonlyLabel.name="Archived";var gapLabel=new MF_ProjectLabel();gapLabel.id="gap";gapLabel.clientid=MF_UserSession.getUser().company;gapLabel.createDate=new Date();gapLabel.defaultLabel=true;gapLabel.projects="";gapLabel.color="#FFFFFF";gapLabel.name="";thisClass.labelCollection.addItem(thisClass.allLabel);thisClass.labelCollection.addItem(thisClass.ownerLabel);thisClass.labelCollection.addItem(thisClass.sharedLabel);thisClass.labelCollection.addItem(thisClass.publicLabel);thisClass.labelCollection.addItem(thisClass.readonlyLabel);thisClass.labelCollection.addItem(thisClass.trashLabel);thisClass.labelCollection.addItem(gapLabel);};this.listLabels=function(){$("#mfLabelList").empty();var cachedTemplate=mf_main.getTemplateFromCache("mfLabelItemTemplate");if(cachedTemplate==null){$.get("templates/dashboard/LabelItem.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfLabelItemTemplate").html());mf_main.addTemplateToCache("mfLabelItemTemplate",template);thisClass.renderLabelListing(template);});}else{thisClass.renderLabelListing(cachedTemplate);}};this.renderLabelListing=function(template){var sortableItems="";var sortableCount=0;var len=thisClass.labelCollection.size();for(var k=0;k<len;k++){var litem=thisClass.labelCollection.getItemAt(k);$("#mfLabelList").append(template(litem));if(litem!=thisClass.allLabel&&litem!=thisClass.publicLabel&&litem!=thisClass.sharedLabel&&litem!=thisClass.ownerLabel&&litem!=thisClass.trashLabel&&litem!=thisClass.readonlyLabel&&litem.id!="gap"){if(sortableCount==0){sortableItems=".mfLabelItemCls"+litem.id;}else{sortableItems=sortableItems+",.mfLabelItemCls"+litem.id;}sortableCount++;$("#mfLabelItem"+litem.id).droppable({over:thisClass.handleProjectOver,out:thisClass.handleProjectOut,drop:thisClass.handleProjectDrop});$("#mfLabelItem"+litem.id).data("dtype","label");$("#mfLabelItem"+litem.id).data("did","mfLabelItem"+litem.id);}$("#mfLabelItem"+litem.id).on("mouseover",thisClass.labelItemOver);$("#mfLabelItem"+litem.id).on("mouseout",thisClass.labelItemOut);$("#mfLabelItem"+litem.id).on("click",thisClass.labelItemClick);}if(!Modernizr.touch){$("#mfLabelList").sortable({items:sortableItems});}};this.handleProjectOver=function(event,ui){if(ui.draggable.data("dtype")=="project"||ui.draggable.data("dtype")=="label"){$(this).css({"background-color":"#ffcc33"});}};this.handleProjectOut=function(event,ui){$(this).css({"background-color":"transparent"});};this.handleProjectDrop=function(event,ui){$(this).css({"background-color":"transparent"});if(ui.draggable.data("dtype")=="project"){mf_main.dashboardController.projectController.selectProject(ui.draggable.data("did"));var label=thisClass.getLabelbyID($(this).attr("id"));if(label&&label.defaultLabel){MF_Utils.display_ActionIndicator("Cannot assign to default labels");}else{if(mf_main.dashboardController.projectController.selectedProject&&label){thisClass.addProjectToLabel(mf_main.dashboardController.projectController.selectedProject,label);}}}if(ui.draggable.data("dtype")=="label"){}};this.addProjectToLabel=function(project,label){if(label.projects==null){label.projects="";}var arr=label.projects.split(",");var present=false;for(var k=0;k<arr.length;k++){var mid=arr[k];if(mid==project.id){present=true;break;}}if(!present){label.count++;label.projects=label.projects+","+project.id;$("#mfLabelItemCount"+label.id).text(label.count.toString());MF_LabelManager.update(label,{callback:function(){}});}};this.listProjectsByLabel=function(label){$("#mfCurrentLabelSelected p").html(label.name);$("#mfLabelItem"+label.id).css({"font-weight":"bold"});$("#mfDesignSets").empty();var cachedTemplate=mf_main.getTemplateFromCache("mfProjectItemTemplate");if(cachedTemplate==null){$.get("templates/dashboard/ProjectItem.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfProjectItemTemplate").html());mf_main.addTemplateToCache("mfProjectItemTemplate",template);thisClass.renderProjectItemByLabel(template,label);});}else{thisClass.renderProjectItemByLabel(cachedTemplate,label);}};this.renderProjectItemByLabel=function(template,label){mf_main.dashboardController.projectListLabel=label.id;mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);};this.countProjectsByLabel=function(dashboardDataObj){thisClass.ownerLabel.count=0;thisClass.sharedLabel.count=0;thisClass.allLabel.count=0;thisClass.publicLabel.count=0;thisClass.trashLabel.count=0;thisClass.readonlyLabel.count=0;thisClass.allLabel.count=dashboardDataObj.totalProjectsCount;thisClass.ownerLabel.count=dashboardDataObj.ownedProjectsCount;thisClass.sharedLabel.count=dashboardDataObj.sharedProjectsCount;thisClass.publicLabel.count=dashboardDataObj.publicProjectsCount;thisClass.trashLabel.count=dashboardDataObj.trashProjectsCount;thisClass.readonlyLabel.count=dashboardDataObj.readonlyProjectsCount;for(var k=0;k<thisClass.labelCollection.size();k++){var projectLabel=thisClass.labelCollection.getItemAt(k);if(projectLabel.projects!=null&&!projectLabel.defaultLabel){projectLabel.count=projectLabel.projects.split(",").length;if(projectLabel.projects.split(",").length>0){var lb1=projectLabel.projects.split(",")[0];if(lb1==""){projectLabel.count=projectLabel.count-1;}}if(projectLabel.count<0){projectLabel.count=0;}}}};this.filterLabelResults=function(label,item){if(label){if(label.defaultLabel){if(label.id=="public"){if(!item.isdeleted&&item.share&&item.company==MF_UserSession.getUser().company){return true;}}if(label.id=="all"){if(!item.isdeleted){return true;}}if(label.id=="shared"){if(!item.isdeleted&&item.company!=MF_UserSession.getUser().company){return true;}}if(label.id=="owner"){if(!item.isdeleted&&item.company==MF_UserSession.getUser().company){return true;}}if(label.id=="trash"){if(item.isdeleted){return true;}}if(label.id=="readonly"){if(item.readonly){return true;}}}else{if(label.projects==null){label.projects="";}var arr=label.projects.split(",");for(var k=0;k<arr.length;k++){var mid=arr[k];if(!item.isdeleted&&mid==item.id){return true;}}}}return false;};this.labelItemOver=function(e){if(thisClass.selectedLabel!=null&&("mfLabelItem"+thisClass.selectedLabel.id)==$(this).attr("id")){}else{if($(this).attr("id")!="mfLabelItemgap"){$(this).css({"font-weight":"bold"});}}};this.labelItemOut=function(e){if(thisClass.selectedLabel!=null&&("mfLabelItem"+thisClass.selectedLabel.id)==$(this).attr("id")){}else{if($(this).attr("id")!="mfLabelItemgap"){$(this).css({"font-weight":"normal"});}}};this.clearLabelSelection=function(){for(var i=0;i<thisClass.labelCollection.size();i++){var item=thisClass.labelCollection.getItemAt(i);$("#mfLabelItem"+item.id).css({"font-weight":"normal"});}};this.selectLabel=function(pid){thisClass.clearLabelSelection();for(var i=0;i<thisClass.labelCollection.size();i++){var item=thisClass.labelCollection.getItemAt(i);if("mfLabelItem"+item.id==pid){thisClass.selectedLabel=item;thisClass.listProjectsByLabel(thisClass.selectedLabel);break;}}};this.getLabelbyID=function(pid){thisClass.clearLabelSelection();for(var i=0;i<thisClass.labelCollection.size();i++){var item=thisClass.labelCollection.getItemAt(i);if("mfLabelItem"+item.id==pid){return item;break;}}return null;};this.labelItemClick=function(e){if($(this).attr("id")!="mfLabelItemgap"){thisClass.selectLabel($(this).attr("id"));}mf_main.dashboardController.closeLabelSideBar();mf_main.dashboardController.closeRTCNotificationSection();};this.labelEditHandler=function(e){if(!thisClass.selectedLabel||!thisClass.selectedLabel||thisClass.selectedLabel.defaultLabel){MF_Utils.display_ActionIndicator("Default labels cannot be renamed");}else{$("#mfRenameLabelModal").modal();}};this.selectLabelUI=function(labelId){thisClass.clearLabelSelection();for(var i=0;i<thisClass.labelCollection.size();i++){var item=thisClass.labelCollection.getItemAt(i);if(item.id==labelId){thisClass.selectedLabel=item;$("#mfCurrentLabelSelected p").html(item.name);$("#mfLabelItem"+item.id).css({"font-weight":"bold"});break;}}};}function MF_DashboardController(){var thisClass=this;this.currentSideBarStack="mfDashSidebarLabels";this.infoShowed=false;this.logShowed=false;this.memberShowed=false;this.labelController=new MF_LabelController();this.projectController=new MF_ProjectController();this.alertController=new MF_AlertController();this.showSidebar=false;this.showApplist=false;this.showAccountMenu=false;this.integrationListed=false;this.uploadWireTemp=null;this.uploadingWire=false;this.projectListStartIndex=0;this.projectListLength=50;this.projectListSearchText="";this.projectListLabel="";this.isLazyLoadInProgress=false;this.allProjectsLoaded=false;this.projectListLatestCall=null;this.openRecentProject=false;this.constructor=function(){$("#mfRefreshDashboardBtn").on("click",thisClass.refreshHandler);$("#mfDesktopApp").on("click",thisClass.appListHandler);thisClass.labelController.constructor();thisClass.alertController.constructor();thisClass.projectController.constructor();$("#mfCloseSideBarBtn").on("click",thisClass.closeSidebar);$("#mfDashSidebarBackground").on("click",thisClass.closeSidebar);$("#mfLoginBoxBackground").on("click",thisClass.closeApplist);$("#mfOpenAppList").on("click",thisClass.openApplist);$("#mfAccountMenuApps").on("click",thisClass.openApplist);$("#mfAppListCloseBtn").on("click",thisClass.closeApplist);$(".mfSwitchAppBtnCls").on("click",thisClass.openApplist2);$("#mfNewProjectImportWire").on("click",thisClass.importWireHandler);$("#mfWireUploadFile").on("change",thisClass.wireSelectedHandler);$("#mfAccountMenuBoxBackground").on("click",thisClass.closeAccountMenu);$("#mfAccountMenuBtn").on("click",thisClass.openAccountMenu);$("#mfAccountMenuCloseBtn").on("click",thisClass.closeAccountMenu);$("#mfCurrentLabelSelected").on("click",thisClass.toggleLabelsSideBar);$("#mfCloseLabelSideBar").on("click",thisClass.closeLabelSideBar);$("#mfNewProjectGettingStartedBtn").on("click",thisClass.newProjectHandler);$("#mfMemberAccessEdit,.mfMemberAccessRemoveLink").tooltip({animation:false});$("#mfRefreshDashboardBtn").tooltip({animation:false,placement:"bottom"});$("#mfAddToUserList").tooltip({animation:false,placement:"bottom"});$('[data-toggle="tooltip"]').tooltip();$(".mfProjectBgColorCls").tooltip({animation:false,placement:"bottom"});$(".mfLabelControlIcon").tooltip({animation:false,placement:"left"});$("#mfProjectDetailsTab a").click(function(e){e.preventDefault();$(this).tab("show");});$(document).bind("keydown",function(evt){if(evt.keyCode=="27"){mf_main.dashboardController.closeLabelSideBar();thisClass.closeSidebar();thisClass.closeApplist();thisClass.closeAccountMenu();mf_main.dashboardController.projectController.closeCompCategoryHandler();}});$("#mfDesignSets").scroll(thisClass.projectListScrollHandler);$("#mfProjectNotificationCloseBtn").on("click",thisClass.closeRTCNotificationSection);$("#mfProjectNotificationMessageReload").on("click",thisClass.refreshHandler);};this.listIntegrations=function(){if(thisClass.integrationListed==false){thisClass.integrationListed=true;}else{return;}var integrations=[{iconurl:"images/dashboard/integrationmodal/windows10Icon.png",integrationName:"Windows 10",desc:"Native WireframePro desktop app for Windows",sourcelink:"https://d2njum3rvx672a.cloudfront.net/windows/WireframePro-Desktop.exe",mfintegrationbtntext:"Install"},{iconurl:"images/dashboard/integrationmodal/macIcon.png",integrationName:"Mac OS",desc:"Native WireframePro desktop app for Mac OS",sourcelink:"https://d2njum3rvx672a.cloudfront.net/mac/WireframePro-Desktop.dmg",mfintegrationbtntext:"Install"},{iconurl:"images/dashboard/integrationmodal/gSuiteIcon.png",integrationName:"G Suite",desc:"Integrates with your business Google Apps",sourcelink:"https://gsuite.google.com/marketplace/app/wireframepro/413107853716",mfintegrationbtntext:"Install"},{iconurl:"images/dashboard/integrationmodal/gDriveIcon.png",integrationName:"Google Drive",desc:"Draw and post wireframes to Google Drive",sourcelink:"https://chrome.google.com/webstore/detail/wireframepro-gdrive/aoldgapglacdhhcdbnofbkgbnclbojnh",mfintegrationbtntext:"Install"},{iconurl:"images/dashboard/integrationmodal/gDocsIcon.png",integrationName:"Google Docs",desc:"Add-on to insert wireframes to Google Doc",sourcelink:"https://chrome.google.com/webstore/detail/wireframepro-gdocs-addon/ofhiggkajipgdjpeijfbggccoopgckhc",mfintegrationbtntext:"Install"},{iconurl:"images/dashboard/integrationmodal/slackIcon.png",integrationName:"Slack",desc:"Draw and post UI mockups to Slack channels",sourcelink:"https://slack.com/oauth/authorize?&client_id=10039907988.176302646913&scope=commands,files:write:user",mfintegrationbtntext:"Install"},{iconurl:"images/dashboard/integrationmodal/trelloIcon.png",integrationName:"Trello",desc:"Power-Up to draw and attach wireframes to Trello cards",sourcelink:"http://info.trello.com/power-ups/wireframepro",mfintegrationbtntext:"Install"},{iconurl:"images/dashboard/integrationmodal/confluenceIcon.png",integrationName:"Confluence",desc:"Brainstorm interfaces in Atlassian Confluence",sourcelink:"https://marketplace.atlassian.com/plugins/com.mockflow.wireframepro.integrations.confluence/cloud/overview",mfintegrationbtntext:"Install"},{iconurl:"images/dashboard/integrationmodal/jiraIcon.png",integrationName:"JIRA",desc:"Attach UI ideas to tasks in Atlassian JIRA",sourcelink:"https://marketplace.atlassian.com/plugins/com.mockflow.wireframepro.integrations.jira/cloud/overview",mfintegrationbtntext:"Install"},{iconurl:"images/dashboard/integrationmodal/officeIcon.png",integrationName:"Office 365",desc:"Draw UI concepts within Microsoft Office apps",sourcelink:"https://appsource.microsoft.com/en-us/product/office/WA104381268?src=office&tab=Overview",mfintegrationbtntext:"Install"}];var cachedTemplate=mf_main.getTemplateFromCache("mfIntegrationItemTemplate");if(cachedTemplate==null){var template=Handlebars.compile($("#mfIntegrationItemTemplate").html());mf_main.addTemplateToCache("mfIntegrationItemTemplate",template);thisClass.renderIntegrationItems(template,integrations);}else{thisClass.renderIntegrationItems(cachedTemplate,integrations);}};this.renderIntegrationItems=function(template,integrations){$("#mfApplistModalListing").empty();var len=integrations.length;var htmldom="";for(var i=0,j=len;i<j;i++){var nitem=integrations[i];htmldom=htmldom+template(nitem);}$("#mfApplistModalListing").append(htmldom);};this.appListHandler=function(e){thisClass.listIntegrations();$("#mfAppListModal").modal();};this.newProjectHandler=function(e){thisClass.setUploadType(false);thisClass.projectController.openCompCategoryHandler();};this.openSidebar=function(){thisClass.showSidebar=true;thisClass.infoShowed=false;thisClass.logShowed=false;thisClass.memberShowed=false;thisClass.openMemberCanvas();mf_main.dashboardController.interfaceResize();mf_main.dashboardController.projectController.openManageLabelsHandler();$("#mfProjectSBThumb").attr("src",thisClass.projectController.selectedProject.thumbnailURL);$("#mfProjectSBThumbContainer").imgLiquid();$("#mfProjectSBTitle").text(mfProjectTitle());function mfProjectTitle(){var projectTitle=thisClass.projectController.selectedProject.title;var maxChar=80;if(projectTitle.length>maxChar){projectTitle=projectTitle.substr(0,80)+"...";$("#mfProjectSBTitle").text(projectTitle);}else{$("#mfProjectSBTitle").text(thisClass.projectController.selectedProject.title);}}$("#mfDashSidebarBackground").show(0,onDivShow);function onDivShow(){mf_main.interfaceResize();$("#mfDashSidebar").css("display","block");$("#mfDashSidebar").css({position:"absolute",left:($(window).width()+$("#mfDashSidebar").width())});$("#mfDashSidebar").transition({left:($(window).width()-$("#mfDashSidebar").width())+"px",easing:"easeOutExpo",duration:500,complete:function(){$("#mfProjectSBMenuBtn").attr("src",$("#mfProjectSBMenuBtn").attr("src"));}});}};this.closeSidebar=function(){thisClass.showSidebar=false;$("#mfDashSidebarBackground").css("display","none");$("#mfDashSidebar").css("display","none");$("#mfShareModal").hide();mf_main.dashboardController.closeLabelSideBar();};this.openApplist=function(){thisClass.closeAccountMenu();thisClass.showApplist=true;$("#mfAppSwitchLoader").hide();$("#mfLoginBoxBackground").show(0,onDivShow);function onDivShow(){mf_main.interfaceResize();$("#mfLoginBox").css("display","block");$("#mfLoginBox").css({position:"absolute",left:($(window).width()+$("#mfDashSidebar").width())});$("#mfLoginBox").animate({left:($(window).width()-$("#mfLoginBox").width())+"px"},{duration:500,complete:function(){}});}};this.openApplist2=function(){thisClass.closeAccountMenu();thisClass.showApplist=true;$("#mfAppSwitchLoader").hide();$("#mfLoginBoxBackground").show(0,onDivShow);function onDivShow(){mf_main.interfaceResize();$("#mfLoginBox").css("display","block");$("#mfLoginBox").css({position:"absolute",left:(-$("#mfDashSidebar").width())});$("#mfLoginBox").animate({left:"0px"},{duration:500,complete:function(){}});}};this.closeApplist=function(){thisClass.showApplist=false;$("#mfLoginBoxBackground").css("display","none");$("#mfLoginBox").css("display","none");};this.openAccountMenu=function(){thisClass.showAccountMenu=true;$("#mfAccountMenuBoxBackground").show(0,onDivShow);function onDivShow(){mf_main.interfaceResize();$("#mfAccountMenuBox").css("display","block");$("#mfAccountMenuBox").css({position:"absolute",left:($(window).width()+$("#mfDashSidebar").width())});$("#mfAccountMenuBox").animate({left:($(window).width()-$("#mfAccountMenuBox").width())+"px"},{duration:500,complete:function(){}});}};this.importWireHandler=function(){if(MF_UserSession.getUser().isBasic){var ans=confirm("Basic license does not allow importing .wire files. Upgrade now?");if(ans){window.open("https://mockflow.com/pricing","_blank");}return;}if(thisClass.uploadingWire==false){$("#mfWireUploadFile").click();}};this.wireSelectedHandler=function(){for(var i=0;i<document.getElementById("mfWireUploadFile").files.length;i++){var file=document.getElementById("mfWireUploadFile").files[i];if(file){var addFile=true;var fileSize=0;var ext=$(this).val();var filename="file";var lastIndex=ext.lastIndexOf(".");if(lastIndex>=0){var slashIndex=ext.lastIndexOf("\\");filename=ext.substring(slashIndex+1,lastIndex);ext=ext.substring(lastIndex+1);}fileSize=parseInt(file.size/1024,10);var allow=false;if(ext=="wire"){allow=true;}if(!allow){$("#mfWireUploadFile").attr({value:""});this.uploadWireTemp=null;addFile=false;alert("Only wire files are supported - .wire");return;}fileSize=fileSize/1000;if(fileSize>100){$("#mfWireUploadFile").attr({value:""});this.uploadWireTemp=null;addFile=false;alert("File size cannot exceed 100 MB");return;}if(addFile){thisClass.uploadWireTemp=file;var fd=new FormData();fd.append("company",MF_UserSession.getUser().company);fd.append("username",MF_UserSession.getUser().username);fd.append("name","Html 5 File API/FormData");fd.append("fileToUpload",thisClass.uploadWireTemp);fd.append("mime",thisClass.uploadWireTemp.type);fd.append("fname",filename);fd.append("uid",MF_Utils.guidGenerator());var xhr=new XMLHttpRequest();thisClass.setUploadType(true);xhr.upload.addEventListener("progress",thisClass.uploadWireProgress,false);xhr.addEventListener("load",thisClass.uploadWireComplete,false);xhr.addEventListener("error",thisClass.uploadWireFailed,false);xhr.addEventListener("abort",thisClass.uploadWireCanceled,false);xhr.open("POST","wireupload");xhr.send(fd);}}}};this.uploadWireComplete=function(evt){thisClass.uploadWireTemp=null;thisClass.projectController.closeCompCategoryHandler();thisClass.setUploadType(false);alert("Import completed.");thisClass.refreshHandler();};this.uploadWireProgress=function(evt){};this.setUploadType=function(val){thisClass.uploadingWire=val;if(val){$("#mfNewProjectImportWire").css("border-width","0px");$("#mfNewProjectImportWire").text("Uploading...");}else{$("#mfNewProjectImportWire").css("border-width","1px");$("#mfNewProjectImportWire").text("Import .wire");$("#mfWireUploadFile").attr({value:""});this.uploadWireTemp=null;}};this.uploadWireFailed=function(evt){thisClass.setUploadType(false);alert("There was an error attempting to upload the file.");};this.uploadWireCanceled=function(evt){thisClass.setUploadType(false);alert("The upload has been canceled by the user or the browser dropped the connection.");};this.closeAccountMenu=function(){thisClass.showAccountMenu=false;$("#mfAccountMenuBoxBackground").css("display","none");$("#mfAccountMenuBox").css("display","none");};this.interfaceResize=function(){$("#mfDesignListing").width($(window).width()-$("#mfControl").width());$(".mfDesignListingCls").height($("#mfControl").height()-$("#mfDesignSetsBar").height()-36);$("#mfSearchProjectsInput").width($("#mfDesignSetsBar").width()-800);$("#mfAccountMenuBtn").css({position:"absolute",left:($(window).width()-15-10),top:20});$("#mfDashboardProfileImg").css({position:"absolute",left:($(window).width()-23-23-50),top:7});$("#mfOpenAppList").css({position:"absolute",left:($(window).width()-30-190),top:12});$("#mfUpgradePromo").css({position:"absolute",left:($(window).width()-30-320),top:14});if(thisClass.showSidebar){$("#mfDashSidebar").height($(window).height());$("#mfDashSidebar").css({position:"absolute",left:($(window).width()-$("#mfDashSidebar").width())});$("#mfDashSidebarBackground").height($(window).height());$("#mfDashSidebarBackground").width($(window).width());$("#mfDashSidebarProject").height($(window).height()-$("#mfDashSidebarProject").position().top);$("#mfManageLabelsList").height($("#mfMemberCanvas").height()-$("#mfMemberActionBar").height()-$("#mfMemberAccessBar").height()-120);}if(thisClass.showApplist){$("#mfLoginBox").height($(window).height());$("#mfLoginBox").css({position:"absolute",left:($(window).width()-$("#mfLoginBox").width())});$("#mfLoginBoxBackground").height($(window).height());$("#mfLoginBoxBackground").width($(window).width());}if(thisClass.showAccountMenu){$("#mfAccountMenuBox").height($(window).height());$("#mfAccountMenuBox").css({position:"absolute",left:($(window).width()-$("#mfAccountMenuBox").width())});$("#mfAccountMenuBoxBackground").height($(window).height());$("#mfAccountMenuBoxBackground").width($(window).width());}$("#mfShareModal").hide();if($("#mfCategoryInterface").css("display")=="block"){$("#mfCategoryListing").height($(window).height()-$("#mfCategoryHeader").height()-$("#mfCategoryTypes").height()-70);$("#mfCategoryListing").width($(window).width()-40);$("#mfCategoryTitleBlock").width($(window).width()-$("#mfCategoryBtnBlock").height()-30);$("#mfOldFlashEditor").css({position:"absolute",top:$(window).height()-$("#mfOldFlashEditor").height()-10,left:$(window).width()-$("#mfOldFlashEditor").width()-100,});}};this.openMemberCanvasHandler=function(e){thisClass.openMemberCanvas();};this.fetchDashboardData=function(){MF_AccountManager.getDashboardData(MF_UserSession.getUser(),false,{callback:function(dashboardData){thisClass.listDashboardData(dashboardData);}});};this.listDashboardData=function(dashboardDataObj){if(dashboardDataObj!=null){thisClass.projectController.projectCollection=new ArrayCollection();thisClass.labelController.labelCollection=new ArrayCollection();thisClass.alertController.logSharedCollection=new ArrayCollection();$("#mfDesignSets").empty();var cachedTemplate=mf_main.getTemplateFromCache("mfProjectItemTemplate");if(cachedTemplate==null){$.get("templates/dashboard/ProjectItem.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfProjectItemTemplate").html());mf_main.addTemplateToCache("mfProjectItemTemplate",template);thisClass.renderDashboardData(template,dashboardDataObj);thisClass.alertController.centerNotificationBubble();});}else{thisClass.renderDashboardData(cachedTemplate,dashboardDataObj);}thisClass.alertController.applyAlertTemplate(dashboardDataObj.logshared);}};this.listProjects=function(template,projects,clearProjectList){var len=projects.length;if(clearProjectList){thisClass.projectController.projectCollection=new ArrayCollection();}var htmldom="";var recentProjPresent=false;for(var i=0;i<len;i++){var pitem=new MF_Project();pitem.cast(projects[i]);thisClass.projectController.projectCollection.addItem(pitem);htmldom=htmldom+template(pitem);if(thisClass.openRecentProject&&thisClass.projectController.recentProject!=null){if(pitem.id==thisClass.projectController.recentProject.id){recentProjPresent=true;}}}if(recentProjPresent==false&&thisClass.openRecentProject&&thisClass.projectController.recentProject!=null){thisClass.projectController.projectCollection.addItemAt(thisClass.projectController.recentProject,0);htmldom=template(thisClass.projectController.recentProject)+htmldom;}$("#mfDesignSets .mfProjectListPaginationLoaderCls").remove();if(thisClass.projectListStartIndex==0){thisClass.allProjectsLoaded=false;}if(projects.length<thisClass.projectListLength){thisClass.allProjectsLoaded=true;}$("#mfDesignSets").append(htmldom);if(thisClass.projectController.projectCollection.size()==0&&thisClass.projectListSearchText==""&&((thisClass.labelController.selectedLabel!=null&&thisClass.labelController.selectedLabel.id=="all")||thisClass.labelController.selectedLabel==null)){$("#mfDesignSets").css("display","none");$("#mfDesignBlank").css("display","block");}else{$("#mfDesignBlank").css("display","none");$("#mfDesignSets").css("display","block");if(clearProjectList){$("#mfDesignSets").scrollTop(0);}}$(".mfProjectItemWrapper").on("mouseover",thisClass.projectController.projectItemOver);$(".mfProjectItemWrapper").on("mouseout",thisClass.projectController.projectItemOut);$(".projectItemOverOpenBtn").on("click",thisClass.projectItemOpen);$(".mfProjectItemWrapper").on("click",thisClass.projectItemClick);thisClass.projectController.bindMoreiconEvents();$("#mfProjectListLoader").hide();if(thisClass.openRecentProject&&thisClass.projectController.recentProject!=null){thisClass.openRecentProject=false;thisClass.projectController.selectProject("mfProjectItem"+thisClass.projectController.recentProject.id);thisClass.openSidebar();thisClass.labelController.allLabel.count++;$("#mfLabelItemCount"+thisClass.labelController.allLabel.id).text(thisClass.labelController.allLabel.count.toString());thisClass.labelController.ownerLabel.count++;$("#mfLabelItemCount"+thisClass.labelController.ownerLabel.id).text(thisClass.labelController.ownerLabel.count.toString());}$("#mfDashboardEmptyTrashContainer").hide();if(thisClass.labelController.selectedLabel!=null&&thisClass.labelController.selectedLabel.id=="trash"&&thisClass.projectController.projectCollection.size()>0){$("#mfDashboardEmptyTrashContainer").show();}};this.projectItemClick=function(e){thisClass.projectController.selectProject($(this).attr("id"));if(!thisClass.projectController.selectedProject.isdeleted){mf_main.dashboardController.openSidebar();}};this.projectItemOpen=function(e){e.stopImmediatePropagation();var currentProjectID=$(this).attr("id");currentProjectID=currentProjectID.replace("mfProjectItemOverOpenBtn","");thisClass.projectController.selectProject("mfProjectItem"+currentProjectID);thisClass.projectController.openProject(thisClass.projectController.selectedProject);};this.renderDashboardData=function(template,dashboardDataObj){$("#mfContentLoader").css("display","none");$("#mfContentHolder").css("display","block");thisClass.getDashboardProjects(true);thisClass.labelController.createDefaultLabels();for(var i=0,j=dashboardDataObj.labels.length;i<j;i++){var nitem=new MF_ProjectLabel();nitem.cast(dashboardDataObj.labels[i]);thisClass.labelController.labelCollection.addItem(nitem);}thisClass.labelController.countProjectsByLabel(dashboardDataObj);thisClass.labelController.listLabels();if(thisClass.labelController.allLabel){$("#mfCurrentLabelSelected p").html(thisClass.labelController.allLabel.name);$("#mfLabelItem"+thisClass.labelController.allLabel.id).css({"font-weight":"bold"});}$("#mfUpgradePromo").css("visibility","visible");mf_main.interfaceResize();};this.refreshHandler=function(e){$("#mfContentLoader").css("display","block");$("#mfContentHolder").css("display","none");mf_main.interfaceResize();thisClass.labelController.selectLabelUI("all");thisClass.projectListLabel="all";thisClass.projectListStartIndex=0;thisClass.projectListSearchText="";$("#mfSearchProjectsInput").val("");thisClass.closeRTCNotificationSection();thisClass.closeSidebar();thisClass.fetchDashboardData();$("#mfDashboardEmptyTrashContainer").hide();};this.closeHandler=function(){$(".modal").modal("hide");};this.openProjectView=function(){$("#mfDashSidebarProject").css("display","block");mf_main.interfaceResize();};this.showMemberList=function(){thisClass.openSidebar();thisClass.infoShowed=false;thisClass.logShowed=false;thisClass.memberShowed=false;thisClass.openMemberCanvas();};this.openMemberCanvas=function(){if(MF_Permission.deny(thisClass.projectController.selectedProject,"canViewMembers")){MF_Utils.display_ActionIndicator("Permission denied by project owner: To view members");}else{this.openProjectView();mf_main.interfaceResize();thisClass.projectController.renderPublicAccess();thisClass.projectController.listMembers();}};this.toggleLabelsSideBar=function(e){e.stopImmediatePropagation();$("#mfDashSidebarBackground").show();$("#mfControl").toggle();$("#mfControl").css("right","-350px");$("#mfControl").transition({right:"0px",easing:"easeOutExpo",duration:500,complete:function(){}});};this.closeLabelSideBar=function(){$("#mfDashSidebarBackground").hide();$("#mfControl").hide();};this.getDashboardProjects=function(clearExistingList){if(clearExistingList){$("#mfDesignSets").empty();$("#mfDesignSets").hide();$("#mfProjectListLoader").show();}thisClass.projectListLatestCall=new Date().getTime();MF_AccountManager.getDashboardProjects(MF_UserSession.getUser(),thisClass.projectListStartIndex,thisClass.projectListLength,thisClass.projectListSearchText,thisClass.projectListLabel,{callback:function(projectList,callTimestamp){if(callTimestamp!=thisClass.projectListLatestCall){return;}if(clearExistingList){$("#mfDesignSets").empty();}var cachedProjectItemTemplate=mf_main.getTemplateFromCache("mfProjectItemTemplate");thisClass.listProjects(cachedProjectItemTemplate,projectList,clearExistingList);thisClass.isLazyLoadInProgress=false;},arg:thisClass.projectListLatestCall});};this.projectListScrollHandler=function(){if(!thisClass.isLazyLoadInProgress&&!thisClass.allProjectsLoaded&&parseInt($("#mfDesignSets").scrollTop())+parseInt($("#mfDesignSets").innerHeight())+10>parseInt($("#mfDesignSets")[0].scrollHeight)){thisClass.isLazyLoadInProgress=true;$("#mfDesignSets").append($("#mfProjectListPaginationLoader").html());thisClass.projectListStartIndex=thisClass.projectListStartIndex+thisClass.projectListLength;thisClass.getDashboardProjects(false);}};this.closeRTCNotificationSection=function(){$("#mfProjectNotificationMessageContainer").empty();$("#mfProjectNotificationMessageWrapper").hide();};}function MF_Main(){var thisClass=this;this.UID=MF_Utils.guidGenerator();this.PUBLICID="";this.teamController=new MF_TeamController();this.dashboardController=new MF_DashboardController();this.logController=new MF_LogController();this.rtsController=new MF_RTSController();this.dashboardRtcController=new MF_DashboardRTCController();this.gname="";this.gsessionid="";this.gappAccess=false;this.glogin=false;this.gAccess=false;this.cachedTemplates=new Object();this.onLoadInterface=function(){thisClass.interfaceResize();$("#mfDashboardInterface").show();thisClass.dashboardRtcController.connect();dwr.engine.setErrorHandler(thisClass.errorDWRHandler);$("#mfDashboardProfileImg").css("background-image","url('"+MF_Utils.get_gravatar(MF_UserSession.getUser().username,32)+"')");$("#mfAccountMenuLogout").on("click",thisClass.logoutHandler);$("#mfAccountMenuUpgrade").on("click",thisClass.openUpgradeModal);$("#mfAccountMenuHelp").on("click",thisClass.openHelpLink);thisClass.changeUIByPermission();$(".mfLoginApp").click(function(e){e.stopImmediatePropagation();var lid=$(this).attr("id");var publicid=MF_Utils.guidGenerator();var privateid=MF_Utils.guidGenerator();var url="https://mockflow.com";if(lid=="mfLoginWebsitePro"){url="https://websitepro.mockflow.com/index.jsp?publicid="+mf_main.PUBLICID+"&from=wireframepro";}if(lid=="mfLoginWebsitePro"){url="https://timeline.mockflow.com/index.jsp?publicid="+mf_main.PUBLICID+"&from=wireframepro";}if(lid=="mfLoginWireframe"){url="https://app.mockflow.com/index.jsp?publicid="+mf_main.PUBLICID+"&from=wireframepro";}if(lid=="mfLoginDesignCollab"){url="https://designcollab.mockflow.com/index.jsp?publicid="+mf_main.PUBLICID+"&from=wireframepro";}if(lid=="mfLoginAnnotatePro"){url="https://annotatepro.mockflow.com/index.jsp?publicid="+mf_main.PUBLICID+"&from=wireframepro";}if(lid=="mfLoginWireframePro"){url="https://wireframepro.mockflow.com/index.jsp?publicid="+mf_main.PUBLICID+"&from=wireframepro";}$("#mfAppSwitchLoader").height($(window).height());$("#mfAppSwitchLoaderIcon").css({position:"absolute",top:($("#mfAppSwitchLoader").height()/2-100),left:($("#mfAppSwitchLoader").width()/2-20),});$("#mfAppSwitchLoader").show();window.open(url,"_self");mf_main.PUBLICID=publicid;MF_Authentication.addSecureKeyHash(MF_UserSession.getUser(),publicid,privateid,{callback:function(str){}});});$("#mfOpenTeamBtn").on("click",thisClass.openTeamModalHandler);$("#mfUpgradePromo").on("click",thisClass.openUpgradeModal);this.teamController.constructor();this.dashboardController.constructor();this.logController.constructor();this.registerHandlebarHelpers();$("#mfContentLoaderSpinner").css("display","block");mf_main.interfaceResize(true);var publicid=MF_Utils.guidGenerator();var privateid=MF_Utils.guidGenerator();thisClass.PUBLICID=publicid;MF_Authentication.addFirstSecureKeyHash(MF_UserSession.getUser(),publicid,privateid,{callback:function(str){}});thisClass.dashboardController.fetchDashboardData();$(".close").on("click",thisClass.closeHandler);$("html").on("click",thisClass.closePopUpHandler);$(".mfImgLink").on("mouseover",thisClass.imgLinkOver);$(".mfImgLink").on("mouseout",thisClass.imgLinkOut);$("#mfNewProjectBtn").tooltip({animation:false,placement:"bottom"});$("#mfDesktopApp").tooltip({animation:false,placement:"bottom"});$('[data-ptoggle="Pricingtooltip"]').tooltip();};this.menuBtnHandler=function(e){e.stopImmediatePropagation();if($("#mfAccountMenuBoxModal").css("display")=="block"){$("#mfAccountMenuBoxModal").css("display","none");}else{$("#mfAccountMenuBoxModal").css("display","block");var rect=MF_Utils.localToGlobal(document.getElementById("mfAccountMenuBtn"));$("#mfAccountMenuBoxModal").css("left",((rect.left+40)-($("#mfAccountMenuBoxModal").width()))+"px");$("#mfAccountMenuBoxModal").css("top",(rect.top+20)+"px");}};this.errorDWRHandler=function(){};this.checkGoogleAppsUser=function(){MF_Authentication.checkGoogleAppsUser(thisClass.gname,thisClass.gsessionid,{callback:function(user){if(user){MF_UserSession.getUser().firstName=user.firstName;MF_UserSession.getUser().lastName=user.lastName;MF_UserSession.getUser().username=user.username;MF_UserSession.getUser().password=user.password;MF_UserSession.getUser().company=user.company;MF_UserSession.getUser().type=user.type;MF_UserSession.getUser().pid=user.pid;MF_UserSession.getUser().tokenKey=user.tokenKey;MF_UserSession.getUser().projectsLeft=user.projectsLeft;MF_UserSession.getUser().isBasic=user.isBasic;MF_UserSession.getUser().accountType=user.accountType;MF_UserSession.getUser().teamPremium=user.teamPremium;MF_UserSession.getUser().teamEditor=user.teamEditor;MF_UserSession.getUser().emailAlert=user.emailAlert;MF_UserSession.getUser().createDate=user.createDate;thisClass.glogin=false;thisClass.onLoadInterface();}else{alert("Error occurred, reopen app");}}});};this.openUpgradeModal=function(){window.open("https://mockflow.com/pricing");};this.openHelpLink=function(){window.open("https://mockflow.com/apps/wireframepro");};this.imgLinkOver=function(e){$(this).css("opacity",0.5);};this.imgLinkOut=function(e){$(this).css("opacity",1);};this.addTemplateToCache=function(key,template){this.cachedTemplates[key]=template;};this.getTemplateFromCache=function(key){return this.cachedTemplates[key];};this.openTeamModalHandler=function(e){$("#mfTeamModal").modal();};this.closePopUpHandler=function(){MF_Utils.hide_menu("mfProjectMenu");MF_Utils.hide_menu("mfSharedProjectMenu");MF_Utils.hide_menu("mfAdminProjectMenu");MF_Utils.hide_menu("mfTeamAlertModal");$("#mfTeamAlertModal").removeClass("animated scaleInSmall");$("#mfLoginBoxModal").css("display","none");$("#mfAccountMenuBoxModal").css("display","none");};this.logoutHandler=function(){window.open("index.jsp?logout=yes","_self");};this.closeHandler=function(){thisClass.closeDialog();};this.interfaceResize=function(resizeSets){if($("#mfAccountMenuBoxModal").css("display")=="block"){$("#mfAccountMenuBoxModal").css("display","none");}if($("#mfLoginBoxModal").css("display")=="block"){$("#mfLoginBoxModal").css("display","none");}$("#mfContentPlaceHolder").height($(window).height());$("#mfDesignBlank").height($("#mfContentPlaceHolder").height()-$("#mfDesignSetsBar").height()-5);if(resizeSets==true){$("#mfDesignSets,#mfProjectListLoader").width($(window).width()-20);}if($("#mfContentLoader").css("display")=="block"){$("#mfContentLoaderSpinner").css({position:"absolute",top:"50%",left:"50%",transform:"translate3d(-50%,-50%,0)"});}if($("#mfLogCanvas").css("display")=="block"){$("#mfLogList").height($("#mfLogCanvas").height()-$("#mfLogActionBar").height()-80);}if(thisClass.dashboardController){thisClass.dashboardController.interfaceResize();}$("#mfLogListLoader").css({position:"relative",top:(($("#mfLogList").height()/2)-($("#mfLogListLoader").height()/2))-20,left:(($("#mfLogList").width()/2)-($("#mfLogListLoader").width()/2))-10});if(thisClass.dashboardController&&thisClass.dashboardController.alertController){thisClass.dashboardController.alertController.centerNotificationBubble();}if(thisClass.dashboardController&&thisClass.dashboardController.uploadController){thisClass.dashboardController.uploadController.resizeUploadBox();}thisClass.closePopUpHandler();if($("#mfMemberCanvas").css("display")=="block"){if($("#mfProjectPermissionUi").css("display")=="block"){$("#mfMemberCanvas").height($(window).height()-195-$("#mfProjectPermissionUi").height());}else{$("#mfMemberCanvas").height($(window).height()-195);}$("#mfMemberList").height($("#mfMemberCanvas").height()-$("#mfMemberActionBar").height()-$("#mfMemberAccessBar").height()-120);$("#mfMemberListLoader").css({position:"relative",top:(($("#mfMemberList").height()/2)-($("#mfMemberListLoader").height()/2))-20,left:(($("#mfMemberList").width()/2)-($("#mfMemberListLoader").width()/2))-10});if($("#mfMemberBlankImage").css("display")=="block"){$("#mfMemberBlankImage").css({position:"relative",top:(($("#mfMemberList").height()/2)-(134/2))-20});}}if($("#mfSubFailedModal").css("display")=="block"){$("#mfSubFailedModal").css({position:"absolute",top:(($(window).height()/2)-($("#mfSubFailedModal").height()/2)),left:(($(window).width()/2)-($("#mfSubFailedModal").width()/2))});$("#mfSettingsBackground").height($(window).height());$("#mfSettingsBackground").width($(window).width());}};this.changeUIByPermission=function(){if(MF_UserSession.getUser().isNewLicense&&!MF_UserSession.getUser().teamPremium){$("#mfAddEditorBtn").css("opacity",0.3);$("#mfAddAdminBtn").css("opacity",0.3);$("#mfSharePermissionTxt").show();}if(MF_UserSession.getUser().isNewLicense&&MF_UserSession.getUser().teamPremium){$("#mfSharePermissionTxt").show();$("#mfSharePermissionTxt").html("<strong>Note:</strong> Users with free basic license cannot co-edit projects shared to them");}};this.registerHandlebarHelpers=function(){Handlebars.registerHelper("permissionTypeMsg",function(project){if(MF_UserSession.getUser()&&project.company!=MF_UserSession.getUser().company){return"Shared as '"+project.permissionType+"' by "+project.creator+"";}else{return"Owned by me";}});Handlebars.registerHelper("localUpdateDate",function(project){return project.updateDate.toLocaleString();});};this.closeDialog=function(){$(".modal").modal("hide");if($("#mfShareModal").is(":visible")){$("#mfShareModal").hide();}};}function receiveRTS(txt){alert(txt);}function MF_Login(){var thisClass=this;this.constructor=function(){$("#login_btn").on("click",thisClass.loginHandler);$("#forgot_btn").on("click",thisClass.forgotPasswordHandler);};this.isValidEmailAddress=function(emailAddress){var pattern2=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return pattern2.test(emailAddress);};this.loginHandler=function(e){$("#login_btn").css("opacity","0.5");$(".error").hide();var email=$("input#username").val();if(email!=""){if(!thisClass.isValidEmailAddress(email)){$("input#username").focus();$("#login_btn").css("opacity","1");alert("Invalid E-mail address");return false;}}else{$("input#username").focus();$("#login_btn").css("opacity","1");alert("Email is required");return false;}var password=$("input#password").val();if(password==""){$("input#password").focus();$("#login_btn").css("opacity","1");alert("Password is Required");return false;}var remember=true;$("#rememberme").val("true");$("#login_btn").hide();$("#loging_btn").show();return true;};this.rememberMeClickHandler=function(e){e.stopPropagation();var remember=true;};this.forgotPasswordHandler=function(e){$(".error").hide();var email=$("input#username").val();if(email!=""){if(!thisClass.isValidEmailAddress(email)){$("input#username").focus();alert("Invalid E-mail address");return;}}else{$("input#username").focus();alert("Email is required");return;}alert("Check e-mail for resetting password.  (If not received check spam folder) ");$.post("forgotPassword.jsp",{uname:email},function(data){data=jQuery.trim(data);if(data=="success"){}else{alert("Some error occurred, is this an registered e-mail?");}});return;};}var gBtnClicked=false;function gBtnHandler(){gBtnClicked=true;}function signinSuccessCallback(authResult){if(gBtnClicked==true){}else{return;}var profile=authResult.getBasicProfile();var id_token=authResult.getAuthResponse().id_token;console.log("ID Token: "+id_token);var publicmid=guidGenerator();var privatemid=guidGenerator();$("#signinButton").hide();$("#mfGoogleSignin").show();$.post("glogin.jsp",{publicid:publicmid,privateid:privatemid,email:profile.getEmail(),dname:profile.getGivenName(),gtoken:id_token,userid:profile.getId()},function(data){data=data.trim();if(data=="pdlsuccess"){window.location.replace("index.jsp");}else{$("#signinButton").show();$("#mfGoogleSignin").hide();alert("Authentication via Google failed");}});}function signinFailCallback(authResult){console.log("Sign-in state: "+authResult.error);}function guidGenerator(){var S4=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1);};return(S4()+S4()+S4()+S4()+S4()+S4()+S4()+S4());}function MF_ProjectController(){var thisClass=this;this.projectCollection=new ArrayCollection();this.selectedProject=null;this.recentProject=null;this.mouseOverProjectID=null;this.selectedMember=null;this.currentOpenedProject=null;this.currentProjectInfoLoaded=false;this.tempProjectType="";this.tempProjectTypeDescription="";this.tempProjectTypeID="";this.tempProjectTypePreview="";this.tempProjectTypeIcon="";this.flashProject=null;this.categoryListed=false;this.categories=new Array();this.selectedCategory=null;this.collaborators=new ArrayCollection();this.logCollection=new ArrayCollection();this.shareController=new MF_ShareController();this.bgcolor="white";this.searchInProgress=false;this.constructor=function(){$("#mfSearchProjectsInput").on("input",thisClass.searchProjectsHandler);$("#mfMemberAccessBtn,.mfMemberAccessShareLink,.mfMemberAccessRemoveLink").on("click",thisClass.publicAccessHandler);$("#mfPublicLinkCreateBtn").on("click",thisClass.createPublicURLHandler);$("#mfPublicLinkresetURL").on("click",thisClass.resetPublicURL);$("#mfNewProjectHTML5ModalBtn").on("click",thisClass.createNewProjectHTML5);$("#mfGoBackProjectTypeBtn").on("click",thisClass.openProjectTypeHandler);$("#mfOldFlashEditor").on("click",thisClass.openNewProjectModalHandler);$("#newProjectHTML5Title").keypress(function(e){if(e.which==13){thisClass.createNewProjectHTML5();}});$(".mfProjectBgColorCls").on("click",thisClass.setBgColor);$(".mfNewProjectHTML5TypeBtn").on("mouseover",thisClass.newProjectHTML5TypeBtnOver);$(".mfNewProjectHTML5TypeBtn").on("mouseout",thisClass.newProjectHTML5TypeBtnOut);$(".mfNewProjectHTML5TypeBtn").on("click",thisClass.newProjectHTML5TypeBtnClick);$("#mfSearchCategoryInput").on("textchange",thisClass.searchCategoryHandler);$("#mfCategoryCloseBtn, #mfCategoryNewProjectWindowCloseBtn").on("click",thisClass.closeCompCategoryHandler);$("#mfCategoryNewProjectCloseBtn,#mfCategorySectionWrapper").on("click",thisClass.goBackCompCategoryHandler);$("#mfNewProjectBtn").on("click",thisClass.openCompCategoryHandler);$("#mfNewProjectModal").on("show",thisClass.newShowHandler);$("#mfNewProjectModal").on("shown",thisClass.newShownHandler);$("#mfNewProjectModalCloseBtn").on("click",thisClass.closeHandler);$("#mfNewProjectModalBtn").on("click",thisClass.createNewProject);$("#mfGoBackProjectTypeBtn").on("click",thisClass.openProjectTypeHandler);$("#mfFlashOpenModalOpenBtn").on("click",thisClass.openFlashProject);$("#mfFlashConvertModalCancelBtn").on("click",thisClass.cancelFlashProject);$("#mfFlashConvertModalConvertBtn").on("click",thisClass.convertFlashProject);$("#newProjectTitle").keypress(function(e){if(e.which==13){thisClass.createNewProject();}});$(".mfNewProjectTypeBtn").on("mouseover",thisClass.newProjectTypeBtnOver);$(".mfNewProjectTypeBtn").on("mouseout",thisClass.newProjectTypeBtnOut);$(".mfNewProjectTypeBtn").on("click",thisClass.newProjectTypeBtnClick);$("#mfDelProjectModal").on("show",thisClass.delShownHandler);$("#mfDelProjectModalCloseBtn").on("click",thisClass.closeHandler);$("#mfDelProjectModalBtn").on("click",thisClass.delProjectHandler);$("#mfReadonlyProjectModalOkBtn").on("click",thisClass.readonlyProjectHandler);$("#mfReadonlyProjectModalUpgradeBtn").on("click",thisClass.readonlyProjectHandler);$("#mfReadonlyProjectModalCloseBtn").on("click",thisClass.closeHandler);$("#mfRenameProjectModal").on("show",thisClass.renameShowHandler);$("#mfRenameProjectModal").on("shown",thisClass.renameShownHandler);$("#mfRenameProjectModalText").keypress(function(e){if(e.which==13){thisClass.renameProjectHandler();}});$("#mfShareMailMemberBtn").on("click",thisClass.memberInviteHandler);$("#mfShareDelMemberBtn").on("click",thisClass.memberDeleteHandler);$("#mfShareChangeMemberBtn").on("click",thisClass.memberModifyHandler);$("#mfRenameProjectModalCloseBtn").on("click",thisClass.closeHandler);$("#mfRenameProjectModalBtn").on("click",thisClass.renameProjectHandler);$("#mfCopyProjectBtn").on("click",thisClass.copyProjectHandler);$("#mfOpenMenuOpenBtn").on("click",thisClass.openMenuOpenHandler);$("#mfOpenMenuShareBtn").on("click",thisClass.openMenuShareHandler);$("#mfOpenMenuLogBtn").on("click",thisClass.openMenuLogHandler);$("#mfOpenMenuReadonlyBtn").on("click",thisClass.openMenuReadonlyHandler);$("#mfOpenMenuDelBtn").on("click",thisClass.openMenuDelHandler);$("#mfOpenMenuDelLabelBtn").on("click",thisClass.openMenuDelLabelHandler);$("#mfOpenMenuDuplicateBtn").on("click",thisClass.openMenuDuplicateHandler);$("#mfOpenMenuCopyBtn").on("click",thisClass.openMenuCopyHandler);$("#mfOpenMenuExportBtn").on("click",thisClass.openMenuExportHandler);$("#mfOpenMenuRenameBtn").on("click",thisClass.openMenuRenameHandler);$("#mfOpenMenuPublicBtn,#mfMemberAccessEdit").on("click",thisClass.openMenuPublicHandler);$("#mfProjectLabelsList").on("click",thisClass.openManageLabelsHandler);$("#mfOpenAdminMenuOpenBtn").on("click",thisClass.openSharedMenuOpenHandler);$("#mfOpenAdminMenuShareBtn").on("click",thisClass.openSharedMenuMembersHandler);$("#mfOpenAdminMenuLogBtn").on("click",thisClass.openSharedMenuLogHandler);$("#mfOpenAdminMenuDelBtn").on("click",thisClass.openSharedMenuDelHandler);$("#mfOpenAdminMenuDelLabelBtn").on("click",thisClass.openSharedMenuDelLabelHandler);$("#mfOpenAdminMenuDuplicateBtn").on("click",thisClass.openMenuDuplicateHandler);$("#mfOpenAdminMenuCopyBtn").on("click",thisClass.openMenuCopyHandler);$("#mfOpenAdminMenuExportBtn").on("click",thisClass.openMenuExportHandler);$("#mfOpenAdminMenuPublicBtn").on("click",thisClass.openMenuPublicHandler);$("#mfOpenAdminMenuLabelsBtn").on("click",thisClass.openManageLabelsHandler);$("#mfOpenAdminMenuRenameBtn").on("click",thisClass.openMenuRenameHandler);$("#mfOpenSharedMenuOpenBtn").on("click",thisClass.openSharedMenuOpenHandler);$("#mfOpenSharedMembersOpenBtn").on("click",thisClass.openSharedMenuMembersHandler);$("#mfOpenSharedMenuLogBtn").on("click",thisClass.openSharedMenuLogHandler);$("#mfOpenSharedMenuRenameBtn").on("click",thisClass.openSharedMenuRenameHandler);$("#mfOpenSharedMenuCloneBtn").on("click",thisClass.openSharedMenuDuplicateHandler);$("#mfOpenSharedMenuDelLabelBtn").on("click",thisClass.openSharedMenuDelLabelHandler);$("#mfOpenSharedMenuDelBtn").on("click",thisClass.openSharedMenuDelHandler);$("#mfOpenSharedMenuExportBtn").on("click",thisClass.openSharedMenuExportHandler);$("#mfOpenSharedMenuLabelsBtn").on("click",thisClass.openManageLabelsHandler);thisClass.shareController.constructor();$("#mfProjectSBOpenBtn").on("click",thisClass.openProjectBtnHandler);$("#mfProjectSBMenuBtn").on("click",thisClass.menuIconClick);$("#mfManageLabelsModalSaveBtn").on("click",thisClass.saveProjectLabels);$("#mfCopyToClipboardBtn, #mfPublicUrlCopy").tooltip({animation:false,placement:"top"});$("#mfCopyToClipboardBtn").on("click",thisClass.handleCopyToClipboard);$("#mfPublicUrlCopy").on("click",thisClass.handleDashboardCopyLink);$(".mfCategoryTypeSelector").on("click",thisClass.filterCategoryHandler);$("#mfDashboardEmptyTrashBtn").on("click",thisClass.emptyTrashHandler);};this.handleDashboardCopyLink=function(){var urlValue=$("#mfMemberAccessURL").attr("href");$("#mfPublicUrlCopyVal").val(urlValue);MF_Utils.copyToClipBoard2($("#mfPublicUrlCopyVal"));};this.setBgColor=function(){$(".mfProjectBgColorCls").css("border-width","0px");$(this).css("border-width","1px");thisClass.bgcolor=$(this).attr("data-bg");};this.handleCopyToClipboard=function(){var urlValue=$(".mfTextboxWrapper").text().trim()+$("#mfPublicAccessURL").val();$("#mfPublicAccessURLVal").val(urlValue);MF_Utils.copyToClipBoard2($("#mfPublicAccessURLVal"));};this.openProjectTypeHandler=function(e){$("#mfNewProjectModalScreen1").show();$("#mfNewProjectModalScreen2").hide();$("#mfNewProjectModalScreen3").hide();};this.newProjectTypeBtnOver=function(e){$(this).css("background-color","#f0f0f0");};this.newProjectTypeBtnOut=function(e){$(this).css("background-color","transparent");};this.newProjectTypeBtnClick=function(e){};this.createNewProject=function(){var projectTitle=$.trim($("#newProjectTitle").val());if(projectTitle==""){alert("Project title cannot be empty");return;}if(MF_UserSession.createAllowed()){$("#mfNewProjectModalScreen3").show();$("#mfNewProjectModalScreen2").hide();$("#mfNewProjectModalScreen1").hide();$("#mfNewProjectModalLoader").css("left",($("#mfNewProjectModal").width()/2)-16);$("#mfNewProjectModalLoader").css("top",($("#mfNewProjectModal").height()/2)-16);var p=new MF_Project();p.title=$("#newProjectTitle").val();p.id=MF_Utils.guidGenerator();p.creator=MF_UserSession.getUser().username;p.company=MF_UserSession.getUser().company;p.createDate=new Date();p.updateDate=new Date();p.flash=true;var publicid=MF_Utils.guidGenerator();var privateid=MF_Utils.guidGenerator();if(thisClass.tempProjectTypeID==null){thisClass.tempProjectTypeID=="";}mf_main.closeDialog();window.open("https://app.mockflow.com/index.jsp?editor=on&publicid="+mf_main.PUBLICID+"&projectid="+p.id+"&perm=Create&ptitle="+p.title+"&template="+thisClass.tempProjectTypeID);mf_main.PUBLICID=publicid;thisClass.projectCollection.addItemAt(p,0);var projarr=thisClass.projectCollection.toArray();$("#mfDesignSets").empty();var cachedTemplate=mf_main.getTemplateFromCache("mfProjectItemTemplate");if(cachedTemplate==null){$.get("templates/ProjectItem.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfProjectItemTemplate").html());mf_main.addTemplateToCache("mfProjectItemTemplate",template);mf_main.dashboardController.listProjects(template,projarr,true);thisClass.selectProject("mfProjectItem"+p.id);mf_main.dashboardController.openSidebar();});}else{mf_main.dashboardController.listProjects(cachedTemplate,projarr,true);thisClass.selectProject("mfProjectItem"+p.id);mf_main.dashboardController.openSidebar();}MF_Authentication.addSecureKeyHash(MF_UserSession.getUser(),publicid,privateid,{callback:function(str){}});mf_main.dashboardController.labelController.listLabels();try{var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(MF_UserSession.getUser().username);rtcObj.messageStr='have created a project "'+projectTitle+'"';mf_main.dashboardRtcController.projectShareSync("project_share",rtcObj);}catch(error){console.log(error);}}else{var answer=confirm(MF_UserSession.createAllowedAlertMsg());if(answer){mf_main.openUpgradeModal();return;}else{return;}return;}};this.openCompCategoryHandler=function(e){thisClass.resetCategoryPics();$("#mfCategoryNewProjectThumb").attr("src","");$(".mfCategoryContentCls").hide();$("#mfCategoryWrapper").fadeIn();thisClass.listCategories();$("#mfCategoryInterface").show();mf_main.interfaceResize();$("#mfSearchCategoryInput").focus();};this.goBackCompCategoryHandler=function(e){thisClass.resetCategoryPics();$("#mfCategoryNewProjectThumb").attr("src","");$(".mfCategoryContentCls").hide();$("#mfCategoryWrapper").fadeIn();};this.closeCompCategoryHandler=function(e){$("#mfCategoryInterface").hide();};this.listCategories=function(){if(thisClass.categoryListed==false){thisClass.categoryListed=true;}else{return;}var cat=new MF_CompCategory();cat.id="featured";cat.name="Blank";cat.type=["all"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="web";cat.name="Web";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="sketchui";cat.name="Hand drawn UI";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="bootstrap4";cat.name="Bootstrap 4";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="bootstrap3";cat.name="Bootstrap 3";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="materialdesignweb1";cat.name="Material Design 1";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="foundation6";cat.name="Foundation 6";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="f6buildingblocks";cat.name="F6 Building Blocks";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M4e59f7c30310a32b16d2f080472297a21573016157647";cat.name="iPhone iOS 13";cat.type=["all","devices"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Mf73bae0d04590ada7359eb445546cd321573016220439";cat.name="iPadOS 13";cat.type=["all","devices"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M8e2a242b14bde769beb5a545208c182b1583744374417";cat.name="Android 10";cat.type=["all","devices"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M3b9ee01bc9e5b764514e7c232962e1941573212698441";cat.name="Apple watchOS 6";cat.type=["all","devices"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="androidwatch2";cat.name="Android Watch 2";cat.type=["all","devices"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="tvos10";cat.name="Apple tvOS 10";cat.type=["all","devices"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M582bda7ec7e3f2feedd661bb4134fa041535612170127";cat.name="Android TV";cat.type=["all","devices"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="windows10desktop";cat.name="Windows 10 Desktop";cat.type=["all","devices"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="macos1012";cat.name="Mac OSX Desktop";cat.type=["all","devices"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M54d816ee69a89151b97ccae7d5c0be301542947842503";cat.name="KDE 5";cat.mockstore=true;cat.type=["all","devices"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M280b08bea4eb69b2912fd64ef07460451542688235812";cat.name="GNOME 3";cat.mockstore=true;cat.type=["all","devices"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="form";cat.name="Form";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="flowchart";cat.name="Flowchart";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="touchbar1012";cat.name="TouchBar Apps";cat.type=["all","devices"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="fluentdesign1";cat.name="MS Fluent Design 1";cat.type=["all","web","enterprise"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="ribbonui";cat.name="MS Ribbon UI";cat.type=["all","devices","enterprise"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="salesforce_lds2";cat.name="Salesforce LDS2";cat.type=["all","enterprise"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M65e309f71d0a38b2fb627abc16a5ac621528375684356";cat.name="Oracle AltaUI";cat.type=["all","enterprise"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Md1a2bd0e198ce1beee7b6541116dce681528811452225";cat.name="SAP UI5";cat.type=["all","enterprise"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M977169d3bf18f228cd59f6684bcd02e01531118306257";cat.name="VMware clarity";cat.type=["all","enterprise"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="ecommerceweb";cat.name="Ecommerce Web";cat.type=["all","enterprise"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="crmweb";cat.name="CRM Web";cat.type=["all","enterprise"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="projectmanagerweb";cat.name="ProjectManager Web";cat.type=["all","enterprise"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M30d7aa8537e6c8a4716658d9b8273cce1549860575880";cat.name="ERP UI kit";cat.type=["all","enterprise"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Mc690674cbb1ee955c4a6fd0ecc769f241535611686597";cat.name="PrestaShop ";cat.type=["all","enterprise"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="kendoui2017";cat.name="KendoUI 2017";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M8bcf1f69a9aacbfd932b388bce70ed111580201335661";cat.name="Ant design 3";cat.type=["all","web"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="semanticui2";cat.name="SemanticUI v2";cat.type=["all","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Ma874f3a71fa374851f6627185a8854ed1568869850328";cat.name="Healthcare UI ";cat.type=["all","enterprise"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Md084469c56b0d87cb83ba5b23650edd01569390669528";cat.name="ATM UI ";cat.type=["all","devices"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Deae3e779dc4599261fe550d7f7540bb8";cat.name="Ionic v3";cat.mockstore=true;cat.type=["all","app","web"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Dd260888c883d4c574baa560faaf6c2d1";cat.name="Mobile game kit";cat.mockstore=true;cat.type=["all"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M8f8f9638285cec6680112ec9b20bfdcd1529399353934";cat.name="AR Mobile kit";cat.mockstore=true;cat.type=["all"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Da192652a91b899313dc7ad4d2f55a47a";cat.name="Business Dashboard";cat.mockstore=true;cat.type=["all","enterprise"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="D6dac8599a071707a3c6bf9932b3dfb9f";cat.name="Camera app kit";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Dea13f6a62fb68f81af01cdd6bdd2fdfb";cat.name="Newsletter pack";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="D37835d63a24d01ee98c03e03dc5f6090";cat.name="VR UI elements";cat.mockstore=true;cat.type=["all","devices"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M449cf727670fc28fa03951bd097626021555930374597";cat.name="Smart Home UI";cat.mockstore=true;cat.type=["all","devices"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="D93495904b06b5ab33c766a47a1edb837";cat.name="Invoice pack";cat.mockstore=true;cat.type=["all","enterprise"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Dbd0b90a35492e30b2ae0a06404b914bc";cat.name="Chat apps";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Dbef2366b7e258e64d1a41a8af8496ec6";cat.name="Bank UI pack";cat.mockstore=true;cat.type=["all","enterprise","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M9d0b4293088971f40cb53267fc68adf91545332238351";cat.name="Accounting pack";cat.mockstore=true;cat.type=["all","enterprise","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Mbb0cf30207e60e416aa2f4bb6dd4a2c41545332142058";cat.name="School Management pack";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Dc069af937542580a53f338f6b583467d";cat.name="Hotel portal UI";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Da0f42b3da04a7c4bae17c46613901454";cat.name="Music apps UI";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="D8e7b2b8c559eb0757b5261faecc8d495";cat.name="Video apps UI";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Dc476e485aa63fb4a0af3e9ea10bbe032";cat.name="HR app pack";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="D8607038c3ffc57c7f88030a779926063";cat.name="Helpdesk UI";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="D533eedf743897bac12f6ea31ff7a9ea8";cat.name="Marketing pack";cat.mockstore=true;cat.type=["all","apps","enterprise"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Db30105db11cb47cde8291a69f219acd3";cat.name="Social UI kit";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="D7fd42be5736a26bb5bd48e197f075bcc";cat.name="Image Editor kit";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M7f0cdbdeee1a5dceaac040de25945ffa1526047623221";cat.name="Food order UI";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Me4655c8982023138b9ec6dbb3ca1b3e41527519652743";cat.name="News app UI";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M504f80dce92d6e1b8b0d966fb466a1011536234307690";cat.name="POS UI pack";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Me91de89b18586f32d265fa3be517bda91535976712975";cat.name="Mobile recharge app";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M755f542dfd4f7f08ccb9105f96274ba21540359228945";cat.name="Job search app";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M61e087393f8f4e53a2518e214aa28ce21540530848015";cat.name="Movie Booking app";cat.mockstore=true;cat.type=["all","apps"];thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Mcd57275c935e11a94292d89c4bf60e501568100181141";cat.name="Darkmode UI";cat.type=["all","devices"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="M01963b941efc8cf08e11eaea38dfe5a11581402126530";cat.name="Sci-fi UI";cat.type=["all","devices"];cat.mockstore=true;thisClass.categories.push(cat);cat=new MF_CompCategory();cat.id="Ma075999a4338333eed91b3af8ac6507f1583824829811";cat.name="Illustration UI";cat.type=["all","apps"];cat.mockstore=true;thisClass.categories.push(cat);thisClass.applyCategoryTemplate(thisClass.categories);};this.applyCategoryTemplate=function(arr){var cachedTemplate=mf_main.getTemplateFromCache("mfComponentCategoryItemTemplate");if(cachedTemplate==null){$.get("templates/dashboard/ComponentCategoryItem.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfComponentCategoryItemTemplate").html());mf_main.addTemplateToCache("mfComponentCategoryItemTemplate",template);thisClass.renderCategoryItems(template,arr);});}else{thisClass.renderCategoryItems(cachedTemplate,arr);}};this.renderCategoryItems=function(template,arr){var i=0;$("#mfCategoryListing").empty();var len=arr.length;var htmldom="";for(i=0;i<=len-1;i++){htmldom=htmldom+template(arr[i]);}$("#mfCategoryListing").append(htmldom);$(".mfComponentCategoryItemCls").on("click",thisClass.categoryItemClick);};this.getCategoryByID=function(cid){for(i=0;i<=thisClass.categories.length-1;i++){var cat=thisClass.categories[i];if(cat.id==cid){return cat;}}return null;};this.categoryItemClick=function(e){var category=$(this).attr("id");category=category.replace("mfComponentCategoryItem_","");$(".mfCategoryContentCls, #mfCategoryWrapper").hide();$("#mfCategoryNewProject").fadeIn();$("#newProjectHTML5Title").focus();thisClass.selectedCategory=thisClass.getCategoryByID(category);$("#mfCategoryNewProjectTitle").text(thisClass.selectedCategory.name);$("#mfCategoryNewProject").css("background-image",'url("images/dashboard/category/backgroundimages/'+thisClass.selectedCategory.id+'.jpg")');$("#mfCategoryNewProjectThumb").attr("src","images/dashboard/category/"+thisClass.selectedCategory.id+".png");$("#mfCategoryNewProjectSample").attr("src","images/dashboard/category/samples/"+thisClass.selectedCategory.id+".jpg");};this.resetCategoryPics=function(e){$("#mfCategoryNewProject").css("background-image","none");$("#mfCategoryNewProjectThumb").attr("src","");$("#mfCategoryNewProjectSample").attr("src","");};this.searchCategoryHandler=function(e){var searchval=$("#mfSearchCategoryInput").val().toLowerCase().trim();for(var i=0;i<thisClass.categories.length;i++){var item=thisClass.categories[i];if(item.name.toLowerCase().indexOf(searchval)>=0){$("#mfComponentCategoryItem_"+item.id).show();}else{$("#mfComponentCategoryItem_"+item.id).hide();}}};this.filterCategoryHandler=function(e){$("#mfSearchCategoryInput").val("");$(".mfCategoryTypeSelector").removeClass("active");$(this).addClass("active");var selectedItemType=$(this).attr("data-type");var arr=[];if(selectedItemType!="all"){for(var i=0;i<thisClass.categories.length;i++){if($.inArray(selectedItemType,thisClass.categories[i].type)>=0){arr.push(thisClass.categories[i]);}}}else{arr=thisClass.categories;}thisClass.applyCategoryTemplate(arr);};this.newShowHandler=function(e){thisClass.mfNewProjectModalReset();};this.newShownHandler=function(e){$("#newProjectTitle").focus();};this.mfNewProjectModalReset=function(){$("#mfNewProjectModalScreen3").hide();$("#mfNewProjectModalScreen2").hide();$("#mfNewProjectModalScreen1").show();$("#newProjectTitle").val("");};this.openNewProjectModalHandler=function(){thisClass.closeCompCategoryHandler();$("#mfNewProjectModal").modal();};this.listMembers=function(){thisClass.collaborators=new ArrayCollection();var currentProjectID=thisClass.selectedProject.id;if(!thisClass.selectedProject.owner){$("#mfProjectPermissionUi").removeClass("hidden");$("#mfPermissionTxt").text("Shared by "+thisClass.selectedProject.creator);}else{$("#mfProjectPermissionUi").addClass("hidden");}if(thisClass.allowManageUsers()){$("#mfMemberActionBar").css("display","block");$("#mfMemberAccessBar").css("display","block");$("#mfPublicUrlCopyVal").css("display","block");}else{$("#mfMemberActionBar").css("display","none");$("#mfMemberAccessBar").css("display","none");$("#mfPublicUrlCopyVal").css("display","none");}if(thisClass.selectedProject.getCollaborators()==null){thisClass.selectedProject.setCollaborators(new Array());}var memberArr=thisClass.selectedProject.getCollaborators();$("#mfMemberList").empty();var cachedTemplate=mf_main.getTemplateFromCache("mfProjectMemberTemplate");if(cachedTemplate==null){$.get("templates/dashboard/ProjectMember.htm",function(templates){$("#mfMemberListLoader").css("display","none");var template=Handlebars.compile($(templates).filter("#mfProjectMemberTemplate").html());mf_main.addTemplateToCache("mfProjectMemberTemplate",template);thisClass.renderProjectMemberItems(template,memberArr);});}else{thisClass.renderProjectMemberItems(cachedTemplate,memberArr);}};this.logListOver=function(e){$("#mfLogList").css("overflow-y","auto");};this.logListOut=function(e){$("#mfLogList").css("overflow-y","hidden");};this.openMenuOpenHandler=function(e){thisClass.openProject(thisClass.selectedProject);};this.openMenuShareHandler=function(e){mf_main.dashboardController.showMemberList();};this.setupBlankMemberPlaceHolder=function(){$("#mfMemberList").html($("#mfMemberListBlankWrapper").html());$("#mfMemberBlankImage").css("display","block");thisClass.shareController.addBlankImageEvent();mf_main.interfaceResize();};this.openMenuLogHandler=function(e){mf_main.dashboardController.showLogList();};this.openSharedMenuOpenHandler=function(e){thisClass.openProject(thisClass.selectedProject);};this.openSharedMenuMembersHandler=function(e){mf_main.dashboardController.showMemberList();};this.openSharedMenuLogHandler=function(e){mf_main.dashboardController.showLogList();};this.openSharedMenuRenameHandler=function(e){MF_Utils.display_ActionIndicator("Only project owner and admins can rename project");};this.openSharedMenuDelLabelHandler=function(e){thisClass.openMenuDelLabelHandler(null);};this.openMenuExportHandler=function(e){mf_main.closeDialog();thisClass.openProject(thisClass.selectedProject,"",true,"export");};this.openSharedMenuExportHandler=function(e){mf_main.closeDialog();thisClass.openProject(thisClass.selectedProject,"",true,"export");};this.openMenuCopyHandler=function(e){mf_main.closeDialog();if(MF_UserSession.getUser().isTrial||MF_UserSession.getUser().hadTrial){alert("Sorry!, This feature is disabled for Trial Licenses.");return;}$("#mfCopyProjectModalScreen2").hide();$("#mfCopyProjectModalScreen1").show();$("#mfCopyProjectModalTitle").text("For: "+thisClass.selectedProject.title);$("#mfCopyProjectModalText").val("");$("#mfCopyProjectModal").modal();$("#mfCopyProjectModalText").focus();};this.openMenuDuplicateHandler=function(e){if(MF_UserSession.createAllowed()){var answer=confirm('This will create a new version of this project "'+thisClass.selectedProject.title+'"  Continue?');if(answer){mf_main.dashboardController.closeSidebar();$("#mfDuplicateProjectModal").modal();if(thisClass.selectedProject.flash){MF_ProjectManagerFlash.duplicate(MF_UserSession.getUser(),MF_UserSession.getUser().company,thisClass.selectedProject,MF_Utils.guidGenerator(),{callback:function(str){mf_main.dashboardController.refreshHandler(null);mf_main.closeDialog();try{var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(MF_UserSession.getUser().username);rtcObj.messageStr='has duplicated the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_share",rtcObj);}catch(error){console.log(error);}}});}else{MF_ProjectManager.duplicate(MF_UserSession.getUser(),MF_UserSession.getUser().company,thisClass.selectedProject,MF_Utils.guidGenerator(),{callback:function(str){mf_main.dashboardController.refreshHandler(null);mf_main.closeDialog();try{var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(MF_UserSession.getUser().username);rtcObj.messageStr='has duplicated the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_share",rtcObj);}catch(error){console.log(error);}}});}}}else{var answer=confirm(MF_UserSession.createAllowedAlertMsg());if(answer){mf_main.openUpgradeModal();return;}}};this.openSharedMenuDuplicateHandler=function(e){if(MF_Permission.deny(thisClass.selectedProject,"canDuplicateProject")){MF_Utils.display_ActionIndicator("Permission denied by project owner: To clone project");}else{if(MF_UserSession.createAllowed()){var answer=confirm('This will create a new version of this project "'+thisClass.selectedProject.title+'"  Continue?');if(answer){MF_Utils.display_ActionIndicator("Duplicating project: "+thisClass.selectedProject.title);if(thisClass.selectedProject.flash){MF_ProjectManagerFlash.duplicateSharedProject(thisClass.selectedProject.company,thisClass.selectedProject,MF_UserSession.getUser().username,{callback:function(str){mf_main.dashboardController.refreshHandler(null);}});}else{MF_ProjectManager.duplicateSharedProject(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject,MF_UserSession.getUser().username,{callback:function(str){mf_main.dashboardController.refreshHandler(null);}});}}}else{var answer=confirm(MF_UserSession.createAllowedAlertMsg());if(answer){mf_main.openUpgradeModal();return;}}}};this.openSharedMenuDelHandler=function(e){var answer=confirm('Remove access from this project "'+thisClass.selectedProject.title+'" ?');if(answer){var delProject=thisClass.selectedProject;mf_main.dashboardController.closeSidebar();$("#mfProjectItem"+delProject.id).css("height","0px");$("#mfProjectItem"+delProject.id).css("display","none");var pind=thisClass.projectCollection.getItemIndex(delProject);if(pind!=-1){thisClass.projectCollection.removeItemAt(pind);}for(var j=0;j<mf_main.dashboardController.labelController.labelCollection.size();j++){mf_main.dashboardController.labelController.removeProjectFromLabel(delProject.id,mf_main.dashboardController.labelController.labelCollection.getItemAt(j));}mf_main.dashboardController.labelController.removeProjectFromDefaultLabel(delProject,false);mf_main.rtsController.sendRefreshDashboard();$("#mfDesignSets").hide();$("#mfProjectListLoader").show();if(delProject.flash){MF_ProjectManagerFlash.deleteSharedMockup(MF_UserSession.getUser().username,delProject.id,{callback:function(str){mf_main.dashboardController.labelController.selectLabelUI("all");mf_main.dashboardController.projectListLabel="all";mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);try{var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr='has left from the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}else{MF_ProjectManager.deleteSharedProject(MF_UserSession.getUser(),delProject.id,{callback:function(str){mf_main.dashboardController.labelController.selectLabelUI("all");mf_main.dashboardController.projectListLabel="all";mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);try{var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr='has left from the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}}};this.openNewProjectHTML5ModalHandler=function(){mf_main.closeDialog();thisClass.mfNewProjectHTML5ModalReset();if(MF_UserSession.createAllowed()){$("#mfNewProjectHTML5Modal").modal();}else{var answer=confirm(MF_UserSession.createAllowedAlertMsg());if(answer){mf_main.openUpgradeModal();return;}else{return;}return;}};this.closeHandler=function(){$(".modal").modal("hide");};this.bindMoreiconEvents=function(){$(".projectItemOverRestoreBtn").click(thisClass.restoreFromTrashHandler);$(".projectItemOverDeleteFromTrashBtn").click(thisClass.deleteFromTrashcan);$(".mfReadonlyProjectRestoreBtn").click(thisClass.restoreFromArchiveHandler);$(".mfReadonlyProjectPreviewBtn").click(function(e){e.stopImmediatePropagation();var projectID=$(this).attr("data-projectid");var project=thisClass.getProjectByID(projectID);thisClass.openProject(project);});};this.addProjectToTemplate=function(project){$("#mfProjectItem"+project.id).on("click",thisClass.projectItemClick);};this.openProjectHandler2=function(e){var projectID=$(this).attr("id");var project=thisClass.getSelectedProject2("mfProjectItemThumb",projectID);thisClass.openProject(project);};this.openProjectHandler3=function(e){var projectID=$(this).attr("id");var project=thisClass.getSelectedProject2("mfProjectItemThumbImg",projectID);thisClass.openProject(project);};this.getSelectedProject2=function(did,pid){for(var i=0;i<thisClass.projectCollection.size();i++){var item=thisClass.projectCollection.getItemAt(i);if(did+item.id==pid){return item;}}return null;};this.openProjectHandler=function(e){var projectID=$(this).attr("id");var project=thisClass.getSelectedProject(projectID);thisClass.openProject(project);};this.openProjectBtnHandler=function(e){e.stopImmediatePropagation();thisClass.openProject(thisClass.selectedProject);};this.openProject=function(project,template,comment,pageid){if(!MF_UserSession.IsOpenAllowed()&&project.company==MF_UserSession.getUser().company){if(MF_UserSession.getUser().hadTrial){alert("Your trial period has expired. Upgrade account for continued access");}else{alert("Resubscribe to MockFlow for accessing projects");}mf_main.openUpgradeModal();return;}if(project.flash){thisClass.flashProject=project;$(".mfFlashConvertProjectModalCls").hide();$("#mfFlashConvertProjectInitScreen").show();$("#mfFlashConvertModal").modal();}else{var publicid=MF_Utils.guidGenerator();var privateid=MF_Utils.guidGenerator();var ptype=project.permissionType;if(ptype==null||ptype=="null"){ptype="Owner";}var readonlyvar="";if(project.readonly){readonlyvar="&readonly=true";}var url="editor.jsp?editor=off&publicid="+mf_main.PUBLICID+"&projectid="+project.id+"&perm="+ptype+readonlyvar;if(comment==true){url=url+"&comments=on#/page/"+pageid;}window.open(url);mf_main.PUBLICID=publicid;MF_Authentication.addSecureKeyHash(MF_UserSession.getUser(),publicid,privateid,{callback:function(str){}});}};this.convertFlashProject=function(){$("#mfFlashConvertTitle").hide();$(".mfFlashConvertProjectModalCls").hide();$("#mfFlashConvertProjectModalLoadScreen").show();var localfile="File_"+MF_Utils.guidGenerator();var keyname="app/wireframepro/fileexport/HTML_Flash_Export_"+MF_Utils.guidGenerator()+".zip";MF_ProjectManager.exportFlashAsHTML5(thisClass.flashProject.title,keyname,localfile,thisClass.flashProject,MF_UserSession.getUser(),{callback:function(res){if(res=="fail"){alert("Unable to convert project to HTML5!");mf_main.closeDialog();}else{$(".mfFlashConvertProjectModalCls").hide();$("#mfFlashConvertProjectModalDownloadScreen").show();$("#mfFlashConvertDownloadBtn").attr("href",MF_Global.getS3URL()+keyname);}}});};this.cancelFlashProject=function(){mf_main.closeDialog();};this.openFlashProject=function(){mf_main.closeDialog();if(thisClass.flashProject==null){alert("Error opening...");return;}var publicid=MF_Utils.guidGenerator();var privateid=MF_Utils.guidGenerator();var project=thisClass.flashProject;var ptype=thisClass.flashProject.permissionType;if(ptype==null||ptype=="null"){ptype="Owner";}var template="";var url="https://app.mockflow.com/index.jsp?editor=on&publicid="+mf_main.PUBLICID+"&projectid="+project.id+"&perm="+ptype+"&template="+template;window.open(url);mf_main.PUBLICID=publicid;MF_Authentication.addSecureKeyHash(MF_UserSession.getUser(),publicid,privateid,{callback:function(str){}});};this.openProjectById=function(projectid,template,comment,pageid){var publicid=MF_Utils.guidGenerator();var privateid=MF_Utils.guidGenerator();var url="editor.jsp?editor=off&publicid="+mf_main.PUBLICID+"&projectid="+projectid+"&perm=Owner";if(comment==true){url=url+"&comments=on#/page/"+pageid;}window.open(url);mf_main.PUBLICID=publicid;MF_Authentication.addSecureKeyHash(MF_UserSession.getUser(),publicid,privateid,{callback:function(str){}});};function clearProjectSelection(){for(var i=0;i<thisClass.projectCollection.size();i++){var item=thisClass.projectCollection.getItemAt(i);$("#mfProjectItem"+item.id).css({"background-color":"#fff"});}}this.menuIconClick=function(e){e.stopImmediatePropagation();var menuBtn="";if(thisClass.selectedProject.owner){menuBtn="mfProjectMenu";}else{if(thisClass.selectedProject.permissionType=="Admin"){menuBtn="mfAdminProjectMenu";}else{menuBtn="mfSharedProjectMenu";}}if($("#"+menuBtn).css("display")=="block"){$("#"+menuBtn).css("display","none");}else{$("#"+menuBtn).css("display","block");$("#"+menuBtn).css("left",$("#mfDashSidebar").position().left+186);$("#"+menuBtn).css("top",($("#mfProjectSBMenuBtn").position().top+35)+"px");}if(thisClass.selectedProject.flash||thisClass.selectedProject.readonly){$("#mfOpenMenuReadonlyBtn").hide();}else{$("#mfOpenMenuReadonlyBtn").show();}};this.moreIconOver=function(e){$(this).css({opacity:1});$(this).css("cursor","pointer");};this.moreIconOut=function(e){$(this).css({opacity:0.5});$(this).css("cursor","default");};this.projectItemOver=function(e){thisClass.mouseOverProjectID=$(this).attr("id");var currentProjectID=thisClass.mouseOverProjectID.replace("mfProjectItem","");$("#mfProjectItemOver"+currentProjectID).show();};this.addProjectMemberToTemplate=function(member){};this.showMemberHandler=function(e){e.stopImmediatePropagation();thisClass.mouseOverProjectID=$(this).attr("id");thisClass.selectProject(thisClass.mouseOverProjectID.replace("mfProjectItemMembers","mfProjectItem"));mf_main.dashboardController.showMemberList();};this.showCommentsHandler=function(e){e.stopImmediatePropagation();thisClass.mouseOverProjectID=$(this).attr("id");thisClass.selectProject(thisClass.mouseOverProjectID.replace("mfProjectItemComments","mfProjectItem"));thisClass.openProject(thisClass.selectedProject,"",true,"all");};this.projectItemOut=function(e){$(".projectItemTemplateOver").hide();};this.selectProject=function(pid){clearProjectSelection();for(var i=0;i<thisClass.projectCollection.size();i++){var item=thisClass.projectCollection.getItemAt(i);if("mfProjectItem"+item.id==pid){thisClass.selectedProject=item;$("#mfProjectItem"+item.id).css({"background-color":"#fff"});thisClass.currentProjectInfoLoaded=false;break;}}};this.getProjectByID=function(pid){for(var i=0;i<thisClass.projectCollection.size();i++){var item=thisClass.projectCollection.getItemAt(i);if(item.id==pid){return item;break;}}return null;};this.getSelectedMember=function(pid){for(var i=0;i<thisClass.collaborators.size();i++){var item=thisClass.collaborators.getItemAt(i);if("mfProjectMemberItem"+item.id==pid){return item;}}return null;};this.getSelectedProject=function(pid){for(var i=0;i<thisClass.projectCollection.size();i++){var item=thisClass.projectCollection.getItemAt(i);if("mfProjectItem"+item.id==pid){return item;}}return null;};this.projectItemClick=function(e){thisClass.selectProject($(this).attr("id"));mf_main.dashboardController.openSidebar();};this.updateMemberCount=function(add){if(add==null){add=true;}if(thisClass.selectedProject){if(add){thisClass.selectedProject.members++;}else{thisClass.selectedProject.members--;}$("#mfProjectItemMembers"+thisClass.selectedProject.id).text(thisClass.selectedProject.members.toString());}};this.renderProjectMemberItems=function(template,memberArr){$("#mfMemberList").empty();thisClass.collaborators=new ArrayCollection();if(memberArr.length==0){thisClass.setupBlankMemberPlaceHolder();}else{$("#mfMemberBlankImage").css("display","none");}var mlen=memberArr.length;var htmldom="";for(var i=0,j=mlen;i<j;i++){var nitem=new MF_Collaborator();nitem.cast(memberArr[i]);thisClass.collaborators.addItem(nitem);htmldom=htmldom+template(nitem);}$("#mfMemberList").append(htmldom);$(".mfProjectMemberItemCls").on("mouseover",thisClass.memberItemOver);$(".mfProjectMemberItemCls").on("mouseout",thisClass.memberItemOut);$(".mfProjectMemberItemCls").on("click",thisClass.memberItemClick);};this.memberModifyHandler=function(e){var selectedMember=thisClass.selectedMember;if(selectedMember!=null){thisClass.shareController.hideAllCanvas();$("#mfShareModalTitle").text("Select Permission");$("#mfShareModalTypeScreen").show();}};this.memberItemClick=function(e){e.stopImmediatePropagation();if(thisClass.allowManageUsers()){}else{return false;}var selClass=$(this).attr("id");var selectedMember=thisClass.getSelectedMember(selClass);if(selectedMember!=null){if(thisClass.selectedMember==selectedMember){if($("#mfShareModal").is(":visible")){$("#mfShareModal").hide();return;}}if(selectedMember.userid.toLowerCase()==MF_UserSession.getUser().username.toLowerCase()){return;}thisClass.selectedMember=selectedMember;thisClass.shareController.changeMember=selectedMember;thisClass.shareController.changeMode=true;thisClass.shareController.hideAllCanvas();thisClass.shareController.showShareModal();}};this.memberItemOver=function(e){$(this).css({opacity:"0.5"});};this.memberItemOut=function(e){$(this).css({opacity:"1"});};this.allowManageUsers=function(){var allowEditing=false;if(thisClass.selectedProject.owner){allowEditing=true;}else{if(thisClass.selectedProject.permissionType=="Admin"){allowEditing=true;}}return allowEditing;};this.memberTypeHandler=function(e){var selClass=$(this).attr("class");var selectedMember=thisClass.getSelectedMember(selClass);if(selectedMember!=null){thisClass.selectedMember=selectedMember;thisClass.shareController.changeMember=selectedMember;thisClass.shareController.changeMode=true;thisClass.shareController.showShareModal();}};this.memberInviteHandler=function(e){var selectedMember=thisClass.selectedMember;if(selectedMember!=null){mf_main.closeDialog();MF_Utils.display_ActionIndicator("Email invitation has been sent");MF_UserManager.sendInvite(thisClass.selectedProject.company,MF_UserSession.getUser(),thisClass.selectedProject,selectedMember.userid,selectedMember.type,mf_main.gappAccess,{callback:function(){}});}};this.memberDeleteHandler=function(e){var selectedMember=thisClass.selectedMember;if(selectedMember!=null){if(thisClass.selectedProject&&(thisClass.selectedProject.permissionType=="Admin")){if(selectedMember.type=="Admin"){alert("Only project owner can remove administrators.");return;}}mf_main.closeDialog();$("#mfProjectMemberItem"+selectedMember.id).css("height","0px");$("#mfProjectMemberItem"+selectedMember.id).css("display","none");thisClass.updateMemberCount(false);var cind=thisClass.collaborators.getItemIndex(selectedMember);if(cind!=-1){thisClass.collaborators.removeItemAt(cind);}if(thisClass.collaborators.size()==0){thisClass.setupBlankMemberPlaceHolder();}thisClass.selectedProject.setCollaborators(thisClass.collaborators.toArray());if(thisClass.selectedProject.flash){MF_UserManagerFlash.deleteCollaborator(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject.id,selectedMember.userid,{callback:function(){try{var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(selectedMember.userid);rtcObj.messageStr='has removed you from the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_share",rtcObj);var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators(selectedMember.userid);rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr="has removed "+selectedMember.userid+' from the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}else{MF_UserManager.deleteCollaborator(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject.id,selectedMember.userid,{callback:function(){try{var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(selectedMember.userid);rtcObj.messageStr='has removed you from the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_share",rtcObj);var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators(selectedMember.userid);rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr="has removed "+selectedMember.userid+' from the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}mf_main.logController.logDelMember(selectedMember.userid,thisClass.selectedProject.id,thisClass.selectedProject.title);}};this.searchProjectsHandler=function(e){var searchval=$("#mfSearchProjectsInput").val().toLowerCase().trim();mf_main.dashboardController.closeSidebar();var performSearch=true;if(!thisClass.searchInProgress&&searchval.length==0){performSearch=false;}thisClass.searchInProgress=false;if(searchval.length>0){thisClass.searchInProgress=true;}if(performSearch){mf_main.dashboardController.projectListSearchText=searchval;mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);}};this.newShowHTML5Handler=function(e){thisClass.mfNewProjectHTML5ModalReset();};this.newShownHTML5Handler=function(e){$("#newProjectHTML5Title").focus();};this.createNewProjectHTML5=function(){var projectTitle=$.trim($("#newProjectHTML5Title").val());if(projectTitle==""){alert("Project Title cannot be empty");return;}if(MF_UserSession.createAllowed()){thisClass.closeCompCategoryHandler();$("#mfNewProjectHTML5ModalScreen2").show();$("#mfNewProjectHTML5ModalScreen1").hide();$("#mfNewProjectHTML5ModalCloseBtn").hide();$("#mfNewProjectHTML5ModalTitle").text("Saving Project");$("#mfNewProjectHTML5ModalLoader").css("left",($("#mfNewProjectHTML5Modal").width()/2)-16);$("#mfNewProjectHTML5ModalLoader").css("top",($("#mfNewProjectHTML5Modal").height()/2)-16);var p=new MF_Project();p.title=$("#newProjectHTML5Title").val();p.id=MF_Utils.guidGenerator();p.creator=MF_UserSession.getUser().username;p.company=MF_UserSession.getUser().company;p.createDate=new Date();p.updateDate=new Date();var publicid=MF_Utils.guidGenerator();var privateid=MF_Utils.guidGenerator();$("#newProjectHTML5Title").val("");mf_main.closeDialog();var urlstr="editor.jsp?editor=on&publicid="+mf_main.PUBLICID+"&perm=Create&projectid="+p.id+"&ptitle="+encodeURIComponent(p.title)+"&bgcolor="+thisClass.bgcolor+"&category="+thisClass.selectedCategory.id;if(thisClass.selectedCategory.mockstore==true){urlstr=urlstr+"&store=yes";}window.open(urlstr);mf_main.PUBLICID=publicid;thisClass.recentProject=p;mf_main.dashboardController.openRecentProject=true;MF_Authentication.addSecureKeyHash(MF_UserSession.getUser(),publicid,privateid,{callback:function(str){}});mf_main.dashboardController.refreshHandler();try{var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(MF_UserSession.getUser().username);rtcObj.messageStr='have created a project "'+projectTitle+'"';mf_main.dashboardRtcController.projectShareSync("project_share",rtcObj);}catch(error){console.log(error);}}else{var answer=confirm(MF_UserSession.createAllowedAlertMsg());if(answer){mf_main.openUpgradeModal();return;}else{return;}return;}};this.mfNewProjectHTML5ModalReset=function(){$("#mfNewProjectHTML5ModalScreen1").show();$("#mfNewProjectHTML5ModalScreen2").hide();$("#mfNewProjectHTML5ModalCloseBtn").show();$("#mfNewProjectHTML5ModalBtn").show();$("#mfNewProjectHTML5ModalTitle").text("New wireframe");$("#newProjectHTML5Title").val("");};this.renameShowHandler=function(e){thisClass.renameProjectModalReset();};this.renameShownHandler=function(e){$("#mfRenameProjectModalText").focus();};this.delShownHandler=function(e){thisClass.delProjectModalReset();};this.openMenuReadonlyHandler=function(){$("#mfReadonlyProjectModal").modal();if(MF_UserSession.getUser().teamPremium&&MF_UserSession.getUser().offlineMode){$("#mfReadonlyModalOthersMsg,#mfReadonlyProjectModalUpgradeBtn").hide();$("#mfReadonlyModalTeamPackMsg,#mfReadonlyProjectModalOkBtn").show();}else{$("#mfReadonlyModalTeamPackMsg,#mfReadonlyProjectModalOkBtn").hide();$("#mfReadonlyModalOthersMsg,#mfReadonlyProjectModalUpgradeBtn").show();}};this.readonlyProjectHandler=function(){thisClass.closeHandler();if(MF_UserSession.getUser().teamPremium&&MF_UserSession.getUser().offlineMode){var archiveProject=thisClass.selectedProject;archiveProject.readonly=true;$("#mfProjectItem"+archiveProject.id).remove();mf_main.dashboardController.closeSidebar();$("#mfDesignSets").hide();$("#mfProjectListLoader").show();mf_main.dashboardController.labelController.allLabel.count--;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.allLabel.id).text(mf_main.dashboardController.labelController.allLabel.count.toString());mf_main.dashboardController.labelController.ownerLabel.count--;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.ownerLabel.id).text(mf_main.dashboardController.labelController.ownerLabel.count.toString());if(archiveProject.share){if(thisClass.selectedProject.creator==MF_UserSession.getUser().username){mf_main.dashboardController.labelController.publicLabel.count--;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.publicLabel.id).text(mf_main.dashboardController.labelController.publicLabel.count.toString());}}mf_main.dashboardController.labelController.readonlyLabel.count++;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.readonlyLabel.id).text(mf_main.dashboardController.labelController.readonlyLabel.count.toString());mf_main.rtsController.sendRefreshDashboard();MF_ProjectManager.updateReadonlyProject(MF_UserSession.getUser(),archiveProject,{callback:function(res){if(res){mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);try{var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.messageStr='has archived the project "'+archiveProject.title+'"';var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();rtcObj.collabarators=collaboratorsCollection.slice(0);mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}}});}else{mf_main.openUpgradeModal();}};this.openMenuDelHandler=function(e){if(mf_main.gAccess){if(MF_UserSession.getUser().isBasic||thisClass.selectedProject.flash){var upgradeMessage="\n\nNote: Upgrade your account to enable Trash feature\n\n";if(thisClass.selectedProject.flash){upgradeMessage="";}var answer=confirm('Do you want to delete this project " '+thisClass.selectedProject.title+'" permanently ?'+upgradeMessage);if(answer){var answer2=confirm('Are you sure you want delete this project " '+thisClass.selectedProject.title+'" permanently ?');if(answer2){thisClass.delProjectGLoginHandler();}}}else{$("#mfDelProjectModal").modal();}}else{$("#mfDelProjectModal").modal();}};this.openMenuDelLabelHandler=function(e){if(mf_main.dashboardController.labelController.selectedLabel){if(mf_main.dashboardController.labelController.selectedLabel.defaultLabel){MF_Utils.display_ActionIndicator("Cannot remove from 'Default' labels");}else{var answer=confirm('Remove project "'+thisClass.selectedProject.title+'" from this label "'+mf_main.dashboardController.labelController.selectedLabel.name+'" (this does not remove access from the project itself). Continue?');if(answer){var newStr="";var arr=mf_main.dashboardController.labelController.selectedLabel.projects.split(",");var count=0;for(var p=0;p<arr.length;p++){var thisProjectID=arr[p];if(thisProjectID!=thisClass.selectedProject.id){if(count==0){newStr=thisProjectID;}else{newStr=newStr+","+thisProjectID;}count++;}}mf_main.dashboardController.labelController.selectedLabel.count=newStr.split(",").length-1;mf_main.dashboardController.labelController.selectedLabel.projects=newStr;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.selectedLabel.id).text(mf_main.dashboardController.labelController.selectedLabel.count.toString());mf_main.dashboardController.labelController.selectLabel("mfLabelItem"+mf_main.dashboardController.labelController.selectedLabel.id);MF_LabelManager.update(mf_main.dashboardController.labelController.selectedLabel,{callback:function(){}});}}}else{MF_Utils.display_ActionIndicator("No label selected");}};this.openMenuRenameHandler=function(e){$("#mfRenameProjectModal").modal();};this.openManageLabelsHandler=function(e){$("#mfShareModal").hide();$("#mfManageLabelsList").empty();var cachedTemplate=mf_main.getTemplateFromCache("mfManageLabelItemTemplate");if(cachedTemplate==null){$.get("templates/dashboard/LabelManageItem.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfManageLabelItemTemplate").html());mf_main.addTemplateToCache("mfManageLabelItemTemplate",template);thisClass.renderManageLabelListing(template);});}else{thisClass.renderManageLabelListing(cachedTemplate);}};this.renderManageLabelListing=function(template){for(var k=0;k<mf_main.dashboardController.labelController.labelCollection.size();k++){var litem=mf_main.dashboardController.labelController.labelCollection.getItemAt(k);if(!litem.defaultLabel){$("#mfManageLabelsList").append(template(litem));$("#mfManageLabelItemChk"+litem.id).attr("checked",false);if(litem.projects==null){litem.projects="";}var arr=litem.projects.split(",");for(var m=0;m<arr.length;m++){var mid=arr[m];if(mid==thisClass.selectedProject.id){$("#mfManageLabelItemChk"+litem.id).attr("checked",true);}}}}$(".mfManageLabelGlobalItemCls").off("click");$(".mfManageLabelGlobalItemCls").on("click",thisClass.saveProjectLabels);};this.saveProjectLabels=function(){var labelArr=new Array();for(var k=0;k<mf_main.dashboardController.labelController.labelCollection.size();k++){var litem=mf_main.dashboardController.labelController.labelCollection.getItemAt(k);if(litem.projects==null){litem.projects="";}if(!litem.defaultLabel){var arr=litem.projects.split(",");var projects="";var present=false;var val=MF_Utils.getCheckBoxValue("mfManageLabelItemChk"+litem.id);for(var m=0;m<arr.length;m++){var mid=arr[m];if(val){if(mid==thisClass.selectedProject.id){present=true;if(projects==""){projects=mid;}else{projects=projects+","+mid;}}else{if(projects==""){projects=mid;}else{projects=projects+","+mid;}}}else{if(mid!=thisClass.selectedProject.id){if(projects==""){projects=mid;}else{projects=projects+","+mid;}}}}if(val){if(!present){projects=projects+","+thisClass.selectedProject.id;}}litem.projects=projects;litem.count=litem.projects.split(",").length;if(litem.projects.split(",").length>0){var lb1=litem.projects.split(",")[0];if(lb1==""){litem.count=litem.count-1;}}if(litem.count<0){litem.count=0;}labelArr.push(litem);}}mf_main.closeDialog();mf_main.dashboardController.labelController.listLabels();MF_LabelManager.updateLabels(labelArr,{callback:function(){}});};this.openMenuPublicHandler=function(e){thisClass.renderPublicAccess();$("#mfPublicLinkError").hide();if(thisClass.selectedProject.publicURL==null){thisClass.selectedProject.publicURL=thisClass.selectedProject.id;}$("#mfPublicLinkresetURL").show();$("#mfPublicLinkCreateBtn").text("Create");$("#mfurlviewpage").attr("checked","");$("#mfurlviewgrid").attr("checked","");$("#mfurlviewmap").attr("checked","");$("#mfurlviewworkflow").attr("checked","");if(thisClass.selectedProject.urlview=="grid"){$("#mfurlviewgrid").attr("checked","checked");}else{if(thisClass.selectedProject.urlview=="map"){$("#mfurlviewmap").attr("checked","checked");}else{if(thisClass.selectedProject.urlview=="workflow"){$("#mfurlviewworkflow").attr("checked","checked");}else{$("#mfurlviewpage").attr("checked","checked");}}}$("#mfPublicAccessURL").val(thisClass.selectedProject.publicURL);$("#mfPublicLinkModal").modal();if(thisClass.selectedProject.share){$("#mfCopyToClipboardBtn").show();$(".mfTextboxWrapper").addClass("mfTextboxWrapperWithCopyLink");$("#mfPublicAccessURL").addClass("mfCopyToClipboardInput");$("#mfEnableExportShareDashboardDiv").hide();$("#mfEnableCommentsShareDashboardDiv").hide();MF_ProjectManager.getProjectPublicPermissionObj(thisClass.selectedProject.id,thisClass.selectedProject.company,{callback:function(proj){$("#mfEnableExportShareDashboardDiv").show();$("#mfEnableCommentsShareDashboardDiv").show();if(proj.enableExport){$("#mfEnableExportShareDashboard").attr("checked","checked");}else{$("#mfEnableExportShareDashboard").attr("checked",false);}if(proj.enableComments){$("#mfEnableCommentsShareDashboard").attr("checked","checked");}else{$("#mfEnableCommentsShareDashboard").attr("checked",false);}}});}else{$("#mfEnableExportShareDashboard").attr("checked","checked");$("#mfEnableCommentsShareDashboard").attr("checked","checked");$("#mfEnableExportShareDashboardDiv").show();$("#mfEnableCommentsShareDashboardDiv").show();$("#mfCopyToClipboardBtn").hide();$(".mfTextboxWrapper").removeClass("mfTextboxWrapperWithCopyLink");$("#mfPublicAccessURL").removeClass("mfCopyToClipboardInput");}};this.delProjectModalReset=function(){$("#mfDelProjectModalScreen1").show();$("#mfDelProjectModalScreen2").hide();$("#mfDelProjectModalBtn").show();$("#mfDelProjectModalCloseBtn").show();$("#mfDelProjectModalTitle").text("Delete project");$("#mfDelProjectModalBtn").removeAttr("disabled");$("#mfDelProjectModalPass").val("");if(thisClass.selectedProject.flash){$("#mfDelProjectModalNotePremium").hide();$("#mfDelProjectModalNoteBasic").hide();$("#mfDelProjectModalNoteFlash").show();}else{if(MF_UserSession.getUser().isBasic){$("#mfDelProjectModalNotePremium").hide();$("#mfDelProjectModalNoteFlash").hide();$("#mfDelProjectModalNoteBasic").show();}else{$("#mfDelProjectModalNoteBasic").hide();$("#mfDelProjectModalNoteFlash").hide();$("#mfDelProjectModalNotePremium").show();}}if(mf_main.gAccess){$("#mfDelProjectModalScreen1 .mfModalSubTitle, #mfDelProjectModalPass").hide();}};this.renameProjectModalReset=function(){$("#mfRenameProjectModalScreen1").show();$("#mfRenameProjectModalScreen2").hide();$("#mfRenameProjectModalBtn").show();$("#mfRenameProjectModalCloseBtn").show();$("#mfRenameProjectModalTitle").text("Rename Project");$("#mfRenameProjectModalBtn").removeAttr("disabled");$("#mfRenameProjectModalText").val(thisClass.selectedProject.title);};this.renameProjectHandler=function(){var projectTitle=$.trim($("#mfRenameProjectModalText").val());if(projectTitle==""){alert("Project Title cannot be empty");return;}mf_main.dashboardController.closeSidebar();$("#mfRenameProjectModalScreen2").show();$("#mfRenameProjectModalScreen1").hide();$("#mfRenameProjectModalCloseBtn").hide();$("#mfRenameProjectModalBtn").hide();$("#mfRenameProjectModalTitle").text("Renaming Project");$("#mfRenameProjectModalBtn").attr("disabled","disabled");var oldname=thisClass.selectedProject.title;var renameProject=thisClass.selectedProject;renameProject.title=projectTitle;$("#mfRenameProjectModalText"+renameProject.id).text(renameProject.title);$("#mfProjectItemTitle"+renameProject.id).text(renameProject.title);mf_main.closeDialog();if(renameProject.flash){MF_ProjectManagerFlash.rename(MF_UserSession.getUser(),renameProject.company,renameProject,{callback:function(str){if(oldname==projectTitle){return;}try{var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr='has renamed "'+oldname+'" project as "'+projectTitle+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}else{MF_ProjectManager.rename(MF_UserSession.getUser(),MF_UserSession.getUser().company,renameProject,{callback:function(str){if(oldname==projectTitle){return;}try{var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr='has renamed "'+oldname+'" project as "'+projectTitle+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}mf_main.logController.logRename(oldname,thisClass.selectedProject);};this.copyProjectHandler=function(){var memberID=$("#mfCopyProjectModalText").val();if(memberID.toLowerCase()==MF_UserSession.getUser().username.toLowerCase()){alert("You cannot share it with yourself");return;}if(memberID==""){return;}memberID=memberID.toLowerCase();if(!MF_Utils.isValidEmailAddress(memberID)){alert("Invalid email");return;}$("#mfCopyProjectModalScreen2").show();$("#mfCopyProjectModalScreen1").hide();$("#mfCopyProjectModalTitle").text("Copying Project");if(thisClass.selectedProject.flash){MF_ProjectManagerFlash.copyProject(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject,memberID,{callback:function(str){mf_main.closeDialog();if(str=="fail"){alert("Some error occurred in copying project. Try again!");}else{if(str=="notexist"||str=="basic"){alert("No MockFlow premium account exists for this email");}else{alert("Project copy transfer is complete!");try{var collaboratorsCollection=[];var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(memberID);rtcObj.messageStr='has sent a copy of the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_share",rtcObj);}catch(error){console.log(error);}}}}});}else{MF_ProjectManager.copyProject(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject,memberID,{callback:function(str){mf_main.closeDialog();if(str=="fail"){alert("Some error occurred in copying project. Try again!");}else{if(str=="notexist"||str=="basic"){alert("No MockFlow premium account exists for this email");}else{alert("Project copy transfer is complete!");try{var collaboratorsCollection=[];var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(memberID);rtcObj.messageStr='has sent a copy of the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_share",rtcObj);}catch(error){console.log(error);}}}}});}};this.delProjectHandler=function(){var delProject=thisClass.selectedProject;if(mf_main.gAccess&&!MF_UserSession.getUser().isBasic&&delProject!=null){delProject.isdeleted=true;delProject.deletedon=new Date();thisClass.moveToTrashHandler(delProject);mf_main.dashboardController.closeSidebar();$("#mfProjectItem"+delProject.id).remove();mf_main.closeDialog();return;}var userpass=$("#mfDelProjectModalPass").val();if(userpass==""){alert("Your MockFlow password is required to delete projects");return;}mf_main.dashboardController.closeSidebar();$("#mfDelProjectModalScreen2").show();$("#mfDelProjectModalScreen1").hide();$("#mfDelProjectModalCloseBtn").hide();$("#mfDelProjectModalBtn").hide();$("#mfDelProjectModalTitle").text("Deleting Project");$("#mfDelProjectModalBtn").attr("disabled","disabled");MF_Authentication.checkUser(MF_UserSession.getUser().username,userpass,true,{callback:function(str){if(str!=null){if(delProject!=null){$("#mfProjectItem"+delProject.id).remove();if(MF_UserSession.getUser().isBasic||delProject.flash){var dind=thisClass.projectCollection.getItemIndex(delProject);if(dind!=-1){thisClass.projectCollection.removeItemAt(dind);}for(var j=0;j<mf_main.dashboardController.labelController.labelCollection.size();j++){mf_main.dashboardController.labelController.removeProjectFromLabel(delProject.id,mf_main.dashboardController.labelController.labelCollection.getItemAt(j));}mf_main.dashboardController.labelController.removeProjectFromDefaultLabel(delProject,true);mf_main.rtsController.sendRefreshDashboard();$("#mfDesignSets").hide();$("#mfProjectListLoader").show();if(delProject.flash){MF_ProjectManagerFlash.deleteMockup(MF_UserSession.getUser(),MF_UserSession.getUser().company,delProject.id,{callback:function(str){mf_main.dashboardController.labelController.selectLabelUI("all");mf_main.dashboardController.projectListLabel="all";mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);try{var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators(userid);var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr='has deleted the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}else{MF_ProjectManager.deleteProject(MF_UserSession.getUser(),MF_UserSession.getUser().company,delProject.id,{callback:function(str){mf_main.dashboardController.labelController.selectLabelUI("all");mf_main.dashboardController.projectListLabel="all";mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);try{var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr='has deleted the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}}else{delProject.isdeleted=true;delProject.deletedon=new Date();thisClass.moveToTrashHandler(delProject);}}mf_main.closeDialog();}else{alert("Authentication failed!");thisClass.delProjectModalReset();}}});};this.setupBlankProjectPlaceHolder=function(){$("#mfDesignSets").hide();$("#mfDesignBlank").show();};this.delProjectGLoginHandler=function(){mf_main.dashboardController.closeSidebar();var delProject=thisClass.selectedProject;if(delProject!=null){$("#mfProjectItem"+delProject.id).remove();if(MF_UserSession.getUser().isBasic||delProject.flash){var dind=thisClass.projectCollection.getItemIndex(delProject);if(dind!=-1){thisClass.projectCollection.removeItemAt(dind);}for(var j=0;j<mf_main.dashboardController.labelController.labelCollection.size();j++){mf_main.dashboardController.labelController.removeProjectFromLabel(delProject.id,mf_main.dashboardController.labelController.labelCollection.getItemAt(j));}mf_main.dashboardController.labelController.removeProjectFromDefaultLabel(delProject,true);mf_main.rtsController.sendRefreshDashboard();$("#mfDesignSets").hide();$("#mfProjectListLoader").show();if(delProject.flash){MF_ProjectManagerFlash.deleteMockup(MF_UserSession.getUser(),MF_UserSession.getUser().company,delProject.id,{callback:function(str){mf_main.dashboardController.labelController.selectLabelUI("all");mf_main.dashboardController.projectListLabel="all";mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);try{var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr='has deleted the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}else{MF_ProjectManager.deleteProject(MF_UserSession.getUser(),MF_UserSession.getUser().company,delProject.id,{callback:function(str){mf_main.dashboardController.labelController.selectLabelUI("all");mf_main.dashboardController.projectListLabel="all";mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);try{var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr='has deleted the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}}}};this.publicAccessHandler=function(){if(thisClass.selectedProject.flash){if(thisClass.selectedProject.share){thisClass.selectedProject.share=false;$("#mfMemberAccessBtn").text("Removing...");if(thisClass.selectedProject.creator==MF_UserSession.getUser().username){mf_main.dashboardController.labelController.publicLabel.count--;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.publicLabel.id).text(mf_main.dashboardController.labelController.publicLabel.count.toString());}}else{if(MF_UserSession.getUser().hadTrial){alert("Your trial period has expired. Upgrade account for continued access");return;}thisClass.selectedProject.share=true;$("#mfMemberAccessBtn").text("Generating...");if(thisClass.selectedProject.creator==MF_UserSession.getUser().username){mf_main.dashboardController.labelController.publicLabel.count++;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.publicLabel.id).text(mf_main.dashboardController.labelController.publicLabel.count.toString());}}MF_ProjectManagerFlash.share(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject,{callback:function(res){if(!res){alert("Some error occurred");}else{thisClass.renderPublicAccess();}}});}else{if(thisClass.selectedProject.share){thisClass.selectedProject.share=false;$("#mfMemberAccessBtn").text("Removing...");if(!thisClass.selectedProject.readonly){if(thisClass.selectedProject.creator==MF_UserSession.getUser().username){mf_main.dashboardController.labelController.publicLabel.count--;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.publicLabel.id).text(mf_main.dashboardController.labelController.publicLabel.count.toString());}}thisClass.selectedProject.publicURL=thisClass.selectedProject.id;MF_ProjectManager.share(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject,{callback:function(res){if(!res){alert("Some error occurred");}else{thisClass.renderPublicAccess();}}});MF_ProjectManager.removePublicURL(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject,{callback:function(res){}});}else{if(MF_UserSession.getUser().hadTrial){alert("Your trial period has expired. Upgrade account for continued access");return;}thisClass.openMenuPublicHandler();}}};this.renderPublicAccess=function(){$("#mfMemberAccessEdit").css("display","none");if(thisClass.selectedProject.share){$("#mfMemberAccessIcon").attr("src","images/dashboard/unLockAccess.png");$("#mfMemberAccessBtn").text("Remove Public URL");$("#mfMemberAccessURL").css("display","inline-block");if(thisClass.selectedProject.flash){$("#mfMemberAccessURL").attr("href","https://app.mockflow.com/view/"+thisClass.selectedProject.id);}else{$("#mfMemberAccessURL").attr("href",MF_Global.serverURL()+"view/"+thisClass.selectedProject.publicURL);$("#mfMemberAccessEdit").css("display","inline-block");}$(".mfMemberAccessShareLink ").hide();$(".mfMemberAccessRemoveLinkWrapper").show();}else{$("#mfMemberAccessIcon").attr("src","images/dashboard/lockAccess.png");$("#mfMemberAccessBtn").text("Create Public URL");$("#mfMemberAccessURL").css("display","none");$("#mfMemberAccessURL").attr("href","");$(".mfMemberAccessShareLink").show();$(".mfMemberAccessRemoveLinkWrapper").hide();}};this.createPublicURLHandler=function(){$("#mfPublicLinkError").hide();var inputURL=$("#mfPublicAccessURL").val().trim();var urlType="page";if($("#mfurlviewgrid").is(":checked")){urlType="grid";}else{if($("#mfurlviewmap").is(":checked")){urlType="map";}else{if($("#mfurlviewworkflow").is(":checked")){urlType="workflow";}}}if($("#mfEnableExportShareDashboard").is(":checked")){thisClass.selectedProject.enableExport=true;}else{thisClass.selectedProject.enableExport=false;}if($("#mfEnableCommentsShareDashboard").is(":checked")){thisClass.selectedProject.enableComments=true;}else{thisClass.selectedProject.enableComments=false;}thisClass.selectedProject.urlview=urlType;if(inputURL!=thisClass.selectedProject.id){var newinputURL=inputURL.replace(/[^a-zA-Z0-9_-]/g,"");if(newinputURL.length!=inputURL.length){$("#mfPublicLinkError").text("URL should not contain special characters");$("#mfPublicLinkError").show();}else{if(inputURL.length<5){$("#mfPublicLinkError").text("URL should be minimum of 5 characters");$("#mfPublicLinkError").show();}else{if(inputURL.length>200){$("#mfPublicLinkError").text("URL cannot exceed 200 characters");$("#mfPublicLinkError").show();}else{if($("#mfPublicLinkresetURL").css("display")=="none"){return;}$("#mfPublicLinkresetURL").hide();$("#mfPublicLinkCreateBtn").text("Creating...");MF_ProjectManager.createPublicURL(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject,inputURL,{callback:function(res){if(res=="exist"){$("#mfPublicLinkError").text("URL is not available");$("#mfPublicLinkError").show();$("#mfPublicLinkresetURL").show();$("#mfPublicLinkCreateBtn").text("Create");}else{if(res=="success"){$("#mfPublicLinkModal").modal("hide");thisClass.selectedProject.publicURL=inputURL;if(!thisClass.selectedProject.share){thisClass.selectedProject.share=true;if(!thisClass.selectedProject.readonly){if(thisClass.selectedProject.creator==MF_UserSession.getUser().username){mf_main.dashboardController.labelController.publicLabel.count++;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.publicLabel.id).text(mf_main.dashboardController.labelController.publicLabel.count.toString());}}}thisClass.renderPublicAccess();}}}});}}}}else{thisClass.selectedProject.publicURL=thisClass.selectedProject.id;thisClass.renderPublicAccess();if($("#mfPublicLinkresetURL").css("display")=="none"){return;}$("#mfPublicLinkresetURL").hide();$("#mfPublicLinkCreateBtn").text("Creating...");if(!thisClass.selectedProject.share){thisClass.selectedProject.share=true;if(!thisClass.selectedProject.readonly){if(thisClass.selectedProject.creator==MF_UserSession.getUser().username){mf_main.dashboardController.labelController.publicLabel.count++;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.publicLabel.id).text(mf_main.dashboardController.labelController.publicLabel.count.toString());}}MF_ProjectManager.share2(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject,{callback:function(res){if(!res){alert("Some error occurred");}else{thisClass.renderPublicAccess();}$("#mfPublicLinkModal").modal("hide");}});}else{$("#mfPublicLinkModal").modal("hide");}MF_ProjectManager.removePublicURL(MF_UserSession.getUser(),thisClass.selectedProject.company,thisClass.selectedProject,{callback:function(res){}});MF_ProjectManager.updateURLView(MF_UserSession.getUser(),thisClass.selectedProject,{callback:function(res){}});}};this.resetPublicURL=function(){$("#mfPublicAccessURL").val(thisClass.selectedProject.id);};this.moveToTrashHandler=function(delProject){for(var j=0;j<mf_main.dashboardController.labelController.labelCollection.size();j++){mf_main.dashboardController.labelController.removeProjectFromLabel(delProject.id,mf_main.dashboardController.labelController.labelCollection.getItemAt(j));}mf_main.dashboardController.labelController.removeProjectFromDefaultLabel(delProject,true);mf_main.rtsController.sendRefreshDashboard();$("#mfDesignSets").hide();$("#mfProjectListLoader").show();MF_ProjectManager.moveToTrashCan(MF_UserSession.getUser(),MF_UserSession.getUser().company,delProject.id,{callback:function(str){mf_main.dashboardController.labelController.selectLabelUI("all");mf_main.dashboardController.projectListLabel="all";mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);try{var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr='has moved the project "'+mf_main.dashboardController.projectController.selectedProject.title+'" to trash.';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});};this.restoreFromTrashHandler=function(e){e.stopImmediatePropagation();var confirmDelete=confirm("Are you sure you want to restore this project?");if(confirmDelete){var currentProjectID=$(this).attr("id");currentProjectID=currentProjectID.replace("mfProjectItemOverRestoreBtn","");thisClass.selectProject("mfProjectItem"+currentProjectID);var restoreProject=thisClass.selectedProject;$("#mfProjectItem"+restoreProject.id).remove();restoreProject.isdeleted=false;restoreProject.deletedon=null;mf_main.dashboardController.labelController.trashLabel.count--;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.trashLabel.id).text(mf_main.dashboardController.labelController.trashLabel.count.toString());if(!restoreProject.readonly){mf_main.dashboardController.labelController.allLabel.count++;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.allLabel.id).text(mf_main.dashboardController.labelController.allLabel.count.toString());if(restoreProject.company==MF_UserSession.getUser().company){mf_main.dashboardController.labelController.ownerLabel.count++;}if(restoreProject.company!=MF_UserSession.getUser().company){mf_main.dashboardController.labelController.sharedLabel.count++;}if(restoreProject.company==MF_UserSession.getUser().company&&restoreProject.share){if(thisClass.selectedProject.creator==MF_UserSession.getUser().username){mf_main.dashboardController.labelController.publicLabel.count++;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.publicLabel.id).text(mf_main.dashboardController.labelController.publicLabel.count.toString());}}$("#mfLabelItemCount"+mf_main.dashboardController.labelController.ownerLabel.id).text(mf_main.dashboardController.labelController.ownerLabel.count.toString());$("#mfLabelItemCount"+mf_main.dashboardController.labelController.sharedLabel.id).text(mf_main.dashboardController.labelController.sharedLabel.count.toString());}else{mf_main.dashboardController.labelController.readonlyLabel.count++;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.readonlyLabel.id).text(mf_main.dashboardController.labelController.readonlyLabel.count.toString());}if($("#mfDesignSets").find(".mfProjectItemWrapper").length==0){$("#mfDashboardEmptyTrashContainer").hide();}mf_main.rtsController.sendRefreshDashboard();MF_ProjectManager.restoreFromTrashCan(MF_UserSession.getUser(),MF_UserSession.getUser().company,restoreProject.id,{callback:function(str){try{var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr='has restored the project "'+mf_main.dashboardController.projectController.selectedProject.title+'" from trash.';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}};this.deleteFromTrashcan=function(e){e.stopImmediatePropagation();var currentProjectID=$(this).attr("data-projectid");thisClass.selectProject("mfProjectItem"+currentProjectID);var delProject=thisClass.selectedProject;var confirmDelete=confirm("Are you sure you want to permanently delete this project?");if(confirmDelete){$("#mfProjectItem"+delProject.id).remove();var dind=thisClass.projectCollection.getItemIndex(delProject);if(dind!=-1){thisClass.projectCollection.removeItemAt(dind);}if($("#mfDesignSets").find(".mfProjectItemWrapper").length==0){$("#mfDashboardEmptyTrashContainer").hide();}mf_main.dashboardController.labelController.trashLabel.count--;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.trashLabel.id).text(mf_main.dashboardController.labelController.trashLabel.count.toString());mf_main.rtsController.sendRefreshDashboard();if(delProject.flash){MF_ProjectManagerFlash.deleteMockup(MF_UserSession.getUser(),MF_UserSession.getUser().company,delProject.id,{callback:function(str){}});}else{MF_ProjectManager.deleteProject(MF_UserSession.getUser(),MF_UserSession.getUser().company,delProject.id,{callback:function(str){}});}}};this.emptyTrashHandler=function(e){e.preventDefault();var confirmDelete=confirm("Are you sure you want to permanently delete all the projects in Trash?");if(confirmDelete){var projectList=[];for(var i=0;i<thisClass.projectCollection.size();i++){var projectItem=thisClass.projectCollection.getItemAt(i);if(projectItem.isdeleted){projectList.push(projectItem);}}for(var i=0;i<projectList.length;i++){var delProject=projectList[i];var dind=thisClass.projectCollection.getItemIndex(delProject);if(dind!=-1){thisClass.projectCollection.removeItemAt(dind);}$("#mfProjectItem"+delProject.id).remove();if(delProject.flash){MF_ProjectManagerFlash.deleteMockup(MF_UserSession.getUser(),MF_UserSession.getUser().company,delProject.id,{callback:function(str){}});}else{MF_ProjectManager.deleteProject(MF_UserSession.getUser(),MF_UserSession.getUser().company,delProject.id,{callback:function(str){}});}}mf_main.dashboardController.labelController.trashLabel.count=0;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.trashLabel.id).text(mf_main.dashboardController.labelController.trashLabel.count.toString());$("#mfDashboardEmptyTrashContainer").hide();mf_main.rtsController.sendRefreshDashboard();}};this.restoreFromArchiveHandler=function(e){e.stopImmediatePropagation();if(!MF_UserSession.getUser().teamPremium||!MF_UserSession.getUser().offlineMode){alert("The project archiving feature is available only for TeamPack users with yearly license.");return;}var confirmRestore=confirm("Are you sure you want to restore this project?");if(confirmRestore){var currentProjectID=$(this).attr("id");currentProjectID=currentProjectID.replace("mfReadOnlyProjectRestoreBtn","");thisClass.selectProject("mfProjectItem"+currentProjectID);var restoreProject=thisClass.selectedProject;$("#mfProjectItem"+restoreProject.id).remove();restoreProject.readonly=false;mf_main.dashboardController.labelController.readonlyLabel.count--;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.readonlyLabel.id).text(mf_main.dashboardController.labelController.readonlyLabel.count.toString());mf_main.dashboardController.labelController.allLabel.count++;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.allLabel.id).text(mf_main.dashboardController.labelController.allLabel.count.toString());mf_main.dashboardController.labelController.ownerLabel.count++;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.ownerLabel.id).text(mf_main.dashboardController.labelController.ownerLabel.count.toString());if(restoreProject.share==true){if(thisClass.selectedProject.creator==MF_UserSession.getUser().username){mf_main.dashboardController.labelController.publicLabel.count++;$("#mfLabelItemCount"+mf_main.dashboardController.labelController.publicLabel.id).text(mf_main.dashboardController.labelController.publicLabel.count.toString());}}mf_main.rtsController.sendRefreshDashboard();MF_ProjectManager.restoreReadonlyProject(MF_UserSession.getUser(),restoreProject,{callback:function(str){mf_main.dashboardController.projectListStartIndex=0;mf_main.dashboardController.getDashboardProjects(true);try{var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.messageStr='has unarchived the project "'+restoreProject.title+'"';var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators();rtcObj.collabarators=collaboratorsCollection.slice(0);mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}});}};}function MF_ShareController(){var thisClass=this;this.constructor=function(){$("#mfOpenShareBtn").on("click",thisClass.openShareModalHandler);$("#mfMemberBlankImage").on("click",thisClass.openShareModalHandler);$("#mfShareCloseBtn").on("click",thisClass.closeShareModalHandler);$("#mfShareAddMemberBox").on("textchange",thisClass.textChangeHandler);$("#mfShareAddMemberBox").on("keypress",thisClass.enterHandler);$("#mfShareGoBackBtn").on("click",thisClass.goBackHandler);$("#mfAddReviewerBtn").on("click",thisClass.addReviewerClickHandler);$("#mfAddEditorBtn").on("click",thisClass.addEditorClickHandler);$("#mfAddAdminBtn").on("click",thisClass.addAdminClickHandler);$(".mfShareMemberTypeAdd").on("mouseover",thisClass.memberTypeOver);$(".mfShareMemberTypeAdd").on("mouseout",thisClass.memberTypeOut);$(".mfAdvancedPermChk").on("click",thisClass.advancedPermissionHandler);$("#mfShareMemberChkAll").on("click",thisClass.checkAllMemberHandler);$("#mfShareMemberBtn").on("click",thisClass.shareMemberHandler);$("#mfAddToUserList").on("click",thisClass.addClickHandler);};this.selectedMember=null;this.selectedMemberCollection=[];this.tempMemberType="Reviewer";this.shareMember=null;this.changeMode=false;this.changeMember=null;this.listed=false;this.advancedPermissionHandler=function(e){var $this=$(this);if(!MF_UserSession.getUser().teamPremium){if($this.is(":checked")){$(this).attr("checked",false);}else{$(this).attr("checked",true);}alert("Only users with Team-Pack licenses can set 'Advanced sharing permissions'");}};this.addBlankImageEvent=function(){$("#mfMemberBlankImage").on("click",thisClass.openShareModalHandler);};this.memberTypeOver=function(e){$(this).css({opacity:0.5});};this.memberTypeOut=function(e){$(this).css({opacity:1});};this.showShareModal=function(e){var rect=MF_Utils.localToGlobal(document.getElementById("mfOpenShareBtn"));thisClass.mfShareModalReset();$("#mfShareModal").css("left",((rect.left)-230-($("#mfShareModal").width()))+"px");$("#mfShareModal").show();$("#mfShareMemberChkAll").prop("checked",false);$("#mfShareList .mfShareMemberChk").prop("checked",false).attr("disabled",false);thisClass.list();$("#mfShareAddMemberBox").focus();};this.closeShareModalHandler=function(e){$("#mfShareModal").hide();};this.openShareModalHandler=function(e){if($("#mfShareModal").is(":visible")){$("#mfShareModal").hide();return;}if(!MF_UserSession.IsOpenAllowed()){if(MF_UserSession.getUser().isTrial){alert(MF_UserSession.createAllowedAlertMsg());}else{alert("Resubscribe to MockFlow for continued access");}mf_main.openUpgradeModal();return;}var pass=true;if(MF_UserSession.getUser().isBasic){if(mf_main.dashboardController.projectController.collaborators.size()>=2){pass=false;}}if(pass){thisClass.changeMode=false;thisClass.changeMember=null;thisClass.showShareModal();}else{var answer=confirm("Your Basic MockFlow account allows only 2 reviewers per project, Upgrade now?");if(answer){mf_main.openUpgradeModal();return;}}};this.addReviewerClickHandler=function(e){if(thisClass.changeMode==true){thisClass.tempMemberType="Reviewer";thisClass.updateCollaborator(sharePerm);}else{for(i=0;i<thisClass.selectedMemberCollection.length;i++){var sharePerm=new MF_SharePerm();thisClass.selectMemberbyID(thisClass.selectedMemberCollection[i]);thisClass.shareMember=thisClass.selectedMember;thisClass.addCollaborator(thisClass.shareMember.userid,"Reviewer",sharePerm);}}};this.addEditorClickHandler=function(e){if(MF_UserSession.getUser().isNewLicense&&!MF_UserSession.getUser().teamPremium){return;}if(thisClass.changeMode==true){thisClass.tempMemberType="Editor";thisClass.updateCollaborator(sharePerm);}else{for(i=0;i<thisClass.selectedMemberCollection.length;i++){var sharePerm=new MF_SharePerm();thisClass.selectMemberbyID(thisClass.selectedMemberCollection[i]);thisClass.shareMember=thisClass.selectedMember;thisClass.addCollaborator(thisClass.shareMember.userid,"Editor",sharePerm);}}};this.resetAdvancedPermissions=function(){var sharePerm=new MF_SharePerm();$("#mfEditorPermSiteMap").attr("checked",sharePerm.canChangeSiteMap);$("#mfEditorPermUploadImage").attr("checked",sharePerm.canUploadImage);$("#mfEditorPermDeleteImage").attr("checked",sharePerm.canDeleteImage);$("#mfEditorPermPreviewRev").attr("checked",sharePerm.canPreviewRevision);$("#mfEditorPermDeleteRev").attr("checked",sharePerm.canDeleteRevision);};this.addAdminClickHandler=function(e){if(mf_main.dashboardController.projectController.selectedProject.permissionType=="Admin"){alert("Only project owner can add new administrators. Choose other permissions.");return;}if(!MF_UserSession.getUser().teamPremium){return;}if(thisClass.changeMode==true){thisClass.tempMemberType="Admin";thisClass.updateCollaborator(sharePerm);}else{for(i=0;i<thisClass.selectedMemberCollection.length;i++){thisClass.selectMemberbyID(thisClass.selectedMemberCollection[i]);thisClass.shareMember=thisClass.selectedMember;var sharePerm=new MF_SharePerm();thisClass.addCollaborator(thisClass.shareMember.userid,"Admin",sharePerm);}}};this.goBackHandler=function(e){thisClass.mfShareModalReset();};this.mfShareModalReset=function(e){thisClass.resetAdvancedPermissions();thisClass.selectedMemberCollection=[];if(thisClass.changeMode==true){thisClass.hideAllCanvas();$("#mfShareModalChangeScreen").show();$("#mfShareModalTitle").text("Member operations");$("#mfShareGoBackBtn").css("display","none");$(".mfShareForMember").text(thisClass.changeMember.userid);}else{thisClass.hideAllCanvas();$("#mfShareModalMembersScreen").show();$("#mfShareModalTitle").text("Share Project");$("#mfShareAddMemberBox").val("");$("#mfShareAddMemberBox").trigger("input");$("#mfShareGoBackBtn").css("display","block");}};this.hideAllCanvas=function(e){$("#mfShareModalMembersScreen").hide();$("#mfShareModalTypeScreen").hide();$("#mfShareModalReviewerAdvScreen").hide();$("#mfShareModalEditorAdvScreen").hide();$("#mfShareModalAdminAdvScreen").hide();$("#mfShareModalChangeScreen").hide();};this.shareModalShownHandler=function(e){thisClass.list();$("#mfShareAddMemberBox").focus();};this.enterHandler=function(e){var keycode=(e.keyCode?e.keyCode:e.which);if(keycode=="13"){thisClass.addClickHandler(null);}};this.addClickHandler=function(e){var EmailCollection=$("#mfShareAddMemberBox").val().split(",");for(i=0;i<EmailCollection.length;i++){thisClass.addNewMember(EmailCollection[i].trim());}};this.textChangeHandler=function(e){var searchval=$("#mfShareAddMemberBox").val().toLowerCase().trim();if(searchval==""){$("#mfShareMemberChkAllContainer").show();$("#mfAddToUserList").hide();}else{$("#mfShareMemberChkAllContainer").hide();$("#mfAddToUserList").show();}for(var i=0;i<mf_main.teamController.teamMembers.size();i++){var item=mf_main.teamController.teamMembers.getItemAt(i);if(item.userid.toLowerCase().indexOf(searchval)>=0){$("#mfShareMemberItem"+item.id).css("height","40px");$("#mfShareMemberItem"+item.id).show();}else{$("#mfShareMemberItem"+item.id).css("height","0px");$("#mfShareMemberItem"+item.id).hide();}}};this.applyTemplate=function(arr){$("#mfShareList").empty();$("#mfShareManagerLoader").css("display","none");mf_main.teamController.teamMembers=new ArrayCollection();$("#mfTeamList").empty();$("#mfTeamManagerLoader").css("display","none");var cachedTemplate=mf_main.getTemplateFromCache("mfShareMemberTemplate");if(cachedTemplate==null){$.get("templates/dashboard/ShareMember.htm",function(templates){var template=Handlebars.compile($(templates).filter("#mfShareMemberTemplate").html());mf_main.addTemplateToCache("mfShareMemberTemplate",template);thisClass.renderShareMemberItem(template,arr);});}else{thisClass.renderShareMemberItem(cachedTemplate,arr);}};this.renderShareMemberItem=function(template,arr){$("#mfShareList .mfShareMemberChk").prop("checked",false).attr("disabled",false);for(var i=0,j=arr.length;i<j;i++){var teamMember=new MF_TeamMember();teamMember.cast(arr[i]);mf_main.teamController.teamMembers.addItem(teamMember);thisClass.appendTeamMember(template,teamMember);}if(arr.length==0){$("#mfShareList").html("<div style='width: 450px; color: #888;'>The team list is empty. You can type multiple emails in the above box and press 'Enter' to first add users to your team. And then click 'Share' button.</div>");}thisClass.userListCheckHandler();$(".mfShareMemberDelBtn").off("click");$(".mfShareMemberDelBtn").on("click",thisClass.deleteMemberHandler);};this.appendTeamMember=function(template,teamMember,prepend){if(prepend){$("#mfShareList").prepend(template(teamMember));}else{$("#mfShareList").append(template(teamMember));}$("#mfShareMemberItem"+teamMember.id).on("mouseover",thisClass.memberItemOver);$("#mfShareMemberItem"+teamMember.id).on("mouseout",thisClass.memberItemOut);$("#mfShareMemberItem"+teamMember.id+" .mfShareMemberChk").on("click",thisClass.checkMemberHandler);};this.shareMemberHandler=function(e){thisClass.selectedMemberCollection=[];thisClass.addClickHandler();if($("#mfShareList .mfShareMemberChk:checked:enabled").length==0){MF_Utils.display_ActionIndicator("No new members selected");return;}$("#mfShareList .mfShareMemberChk:checked:enabled").each(function(i){if($(this).attr("disabled")!="disabled"&&$(this).prop("checked")==true){var usermfid=$(this).closest(".mfShareMemberItem").attr("id");var chkMember=$.grep(mf_main.teamController.teamMembers.data,function(e){return"mfShareMemberItem"+e.id==usermfid;});thisClass.selectedMemberCollection.push(chkMember[0].userid);thisClass.gotoMemberTypeScreen();}});};this.checkAllMemberHandler=function(e){var membersCnt=mf_main.dashboardController.projectController.collaborators.size()+$("#mfShareList .mfShareMemberChk:enabled:visible").length;var memberLimitAllowed=thisClass.isMemberLimitAllowed(membersCnt);if(memberLimitAllowed){}else{$(this).prop("checked",false);return;}$("#mfShareList .mfShareMemberChk").each(function(i){if($(this).attr("disabled")!="disabled"&&$("#mfShareMemberChkAll").prop("checked")==false){$(this).prop("checked",false);}else{$(this).prop("checked",true);}});};this.isMemberLimitAllowed=function(membersCnt,noalert){var allow=true;if(MF_UserSession.getUser().isBasic){if(membersCnt>2){if(noalert){allow=false;}else{var answer=confirm("Your Basic MockFlow account allows only 2 reviewers per project, Upgrade now?");if(answer){allow=false;mf_main.openUpgradeModal();}else{allow=false;}}}}else{if(!MF_UserSession.getUser().teamPremium){if(MF_UserSession.getUser().isNewLicense){}else{if(membersCnt>5){if(noalert){allow=false;}else{var answer=confirm("Maximum of 5 members are allowed per project in Premium license. For unlimited collaborators upgrade to Team-Pack");if(answer){allow=false;mf_main.openUpgradeModal();}else{allow=false;}}}}}}return allow;};this.checkMemberHandler=function(e){var mfuserid=$(this).closest(".mfShareMemberItem").attr("id");var chkdmember=$.grep(mf_main.teamController.teamMembers.data,function(e){return"mfShareMemberItem"+e.id==mfuserid;});var membersCnt=mf_main.dashboardController.projectController.collaborators.size()+$("#mfShareList .mfShareMemberChk:checked:enabled:visible").length;if(chkdmember!=""){if(thisClass.IsExist(chkdmember[0].userid)){MF_Utils.display_ActionIndicator("Project already shared with this user");$(this).prop("checked",false);}}var memberLimitAllowed=thisClass.isMemberLimitAllowed(membersCnt);if(memberLimitAllowed){}else{$(this).prop("checked",false);return;}$("#mfShareList .mfShareMemberChk").each(function(i){if($(this).prop("checked")==false){$("#mfShareMemberChkAll").prop("checked",false);return;}});};this.userListCheckHandler=function(){$("#mfShareList .mfShareMemberChk").each(function(i){var usermfid=$(this).closest(".mfShareMemberItem").attr("id");var chkMember=$.grep(mf_main.teamController.teamMembers.data,function(e){return"mfShareMemberItem"+e.id==usermfid;});if(chkMember!=""&&thisClass.IsExist(chkMember[0].userid)){$("#"+usermfid+" .mfShareMemberChk").prop("checked",true).attr("disabled",true);}else{if(chkMember!=""&&mf_main.dashboardController.projectController.selectedProject&&(mf_main.dashboardController.projectController.selectedProject.creator.toLowerCase()==chkMember[0].userid.toLowerCase())){$("#"+usermfid+" .mfShareMemberChk").prop("checked",true).attr("disabled",true);}else{}}});};this.gotoMemberTypeScreen=function(){thisClass.hideAllCanvas();$("#mfShareModalTypeScreen").show();$(".mfShareForMember").text(thisClass.selectedMemberCollection.length==1?thisClass.selectedMemberCollection.toString():thisClass.selectedMemberCollection.length+" Users");$("#mfShareModalTitle").text("Select Permission");};this.memberSelectHandler=function(e){$(this).css({"background-color":"#ffffff"});thisClass.selectMember($(this).attr("id"));if(thisClass.IsExist(thisClass.selectedMember.userid)){MF_Utils.display_ActionIndicator("Project already shared with this user");return;}thisClass.shareMember=thisClass.selectedMember;thisClass.gotoMemberTypeScreen();};this.deleteMemberHandler=function(e){e.stopImmediatePropagation();thisClass.selectDeleteMember($(this).attr("id"));thisClass.deleteMember();};this.list=function(){if(thisClass.listed){thisClass.userListCheckHandler();return;}$("#mfShareManagerLoader").css("display","block");MF_TeamManager.list(MF_UserSession.getUser().company,{callback:function(arr){if(arr!=null){thisClass.listed=true;thisClass.applyTemplate(arr);if(arr==""){$("#mfShareMemberChkAllContainer").hide();}else{$("#mfShareMemberChkAllContainer").show();}}}});};this.memberItemOver=function(e){$(this).css({"background-color":"#f6f6f6"});};this.memberItemOut=function(e){$(this).css({"background-color":"#fff"});};this.selectMember=function(pid){for(var i=0;i<mf_main.teamController.teamMembers.size();i++){var item=mf_main.teamController.teamMembers.getItemAt(i);if("mfShareMemberItem"+item.id==pid){this.selectedMember=item;break;}}};this.selectMemberbyID=function(pid){for(var i=0;i<mf_main.teamController.teamMembers.size();i++){var item=mf_main.teamController.teamMembers.getItemAt(i);if(item.userid.toLowerCase()==pid.toLowerCase()){this.selectedMember=item;break;}}};this.selectDeleteMember=function(pid){for(var i=0;i<mf_main.teamController.teamMembers.size();i++){var item=mf_main.teamController.teamMembers.getItemAt(i);if("mfShareMemberDelBtn"+item.id==pid){this.selectedMember=item;break;}}};this.memberItemClick=function(e){$(this).css({"background-color":"#fff"});thisClass.selectMember($(this).attr("id"));};this.deleteMember=function(){if(thisClass.selectedMember!=null){var answer=confirm('Remove "'+thisClass.selectedMember.userid+'" from your Team List?');if(answer){$("#mfShareMemberItem"+thisClass.selectedMember.id).css("height","0px");$("#mfShareMemberItem"+thisClass.selectedMember.id).css("display","none");$("#mfShareMemberItem"+thisClass.selectedMember.id).remove();var tind=mf_main.teamController.teamMembers.getItemIndex(thisClass.selectedMember);if(tind!=-1){mf_main.teamController.teamMembers.removeItemAt(tind);}MF_TeamManager.deleteMember(MF_UserSession.getUser(),thisClass.selectedMember.userid,{callback:function(str){$("#mfShareManagerLoader").css("display","none");}});}}};this.addNewMember=function(memberID){if(memberID.toLowerCase()==MF_UserSession.getUser().username.toLowerCase()){MF_Utils.display_ActionIndicator("You cannot share it with yourself");return;}if(memberID==""){return;}memberID=memberID.toLowerCase();if(!MF_Utils.isValidEmailAddress(memberID)){return;}if(thisClass.IsExist(memberID)){MF_Utils.display_ActionIndicator("Project already shared with this user");return;}if(thisClass.IsTeamMemberExist(memberID)){var existMember=thisClass.getTeamMember(memberID);thisClass.shareMember=existMember;}else{if(mf_main.teamController.teamMembers.size()==0){$("#mfShareList").empty();}var mem=new MF_TeamMember();mem.id=MF_Utils.guidGenerator();mem.userid=memberID;mem.type="";mem.license="";$("#mfShareAddMemberBox").val("");$("#mfShareMemberChkAll").prop("checked",false);thisClass.textChangeHandler(null);mf_main.teamController.teamMembers.addItemAt(mem,0);var cachedTemplate=mf_main.getTemplateFromCache("mfShareMemberTemplate");if(cachedTemplate){thisClass.appendTeamMember(cachedTemplate,mem,true);}$(".mfShareMemberDelBtn").off("click");$(".mfShareMemberDelBtn").on("click",thisClass.deleteMemberHandler);$("#mfShareManagerLoader").css("display","block");$("#mfShareManagerLoader").css("display","none");var membersCnt=mf_main.dashboardController.projectController.collaborators.size()+$("#mfShareList .mfShareMemberChk:checked:enabled:visible").length;if(thisClass.isMemberLimitAllowed(membersCnt+1,true)){thisClass.shareMember=mem;$("#mfShareMemberItem"+mem.id+" .mfShareMemberChk").click();}MF_TeamManager.addMember(MF_UserSession.getUser().company,mem,MF_UserSession.getUser(),{callback:function(str){if(str=="success"){}else{MF_Utils.display_ActionIndicator("Some error occurred");}}});}};this.IsTeamMemberExist=function(email){for(var i=0;i<mf_main.teamController.teamMembers.size();i++){var user=mf_main.teamController.teamMembers.getItemAt(i);if(user.userid.toLowerCase()==email.toLowerCase()){return true;}}return false;};this.getTeamMember=function(email){for(var i=0;i<mf_main.teamController.teamMembers.size();i++){var user=mf_main.teamController.teamMembers.getItemAt(i);if(user.userid.toLowerCase()==email.toLowerCase()){return user;}}return null;};this.checkLimit=function(){var allow=true;if((mf_main.dashboardController.projectController.selectedProject.members)>=2){if(MF_UserSession.getUser().isBasic){allow=false;}else{allow=true;}}return allow;};this.IsExist=function(email){for(var i=0;i<mf_main.dashboardController.projectController.collaborators.size();i++){var user=mf_main.dashboardController.projectController.collaborators.getItemAt(i);if(user.userid.toLowerCase()==email.toLowerCase()){return true;}}return false;};this.updateCollaborator=function(sharePerm){mf_main.closeDialog();var memberTypeChanged=false;if(thisClass.changeMember.type!=thisClass.tempMemberType){memberTypeChanged=true;}thisClass.changeMember.type=thisClass.tempMemberType;thisClass.changeMember.sharePerm=sharePerm;mf_main.dashboardController.projectController.selectedProject.setCollaborators(mf_main.dashboardController.projectController.collaborators.toArray());$("#mfMemberList").empty();var cachedTemplate=mf_main.getTemplateFromCache("mfProjectMemberTemplate");if(cachedTemplate!=null){mf_main.dashboardController.projectController.renderProjectMemberItems(cachedTemplate,mf_main.dashboardController.projectController.collaborators.toArray());}var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(thisClass.changeMember.userid);rtcObj.messageStr='has changed your role to "'+thisClass.changeMember.type+'" for the project "'+mf_main.dashboardController.projectController.selectedProject.title+'"';if(mf_main.dashboardController.projectController.selectedProject.flash){MF_UserManagerFlash.updateCollaboratorAll(MF_UserSession.getUser(),mf_main.dashboardController.projectController.selectedProject.company,mf_main.dashboardController.projectController.selectedProject.id,thisClass.changeMember,{callback:function(str,argData){if(memberTypeChanged){try{mf_main.dashboardRtcController.projectShareSync("project_share",argData.rtcObj);var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators(argData.changeMember.userid);argData.rtcObj.collabarators=[];argData.rtcObj.collabarators=collaboratorsCollection.slice(0);argData.rtcObj.messageStr="has changed "+argData.changeMember.userid+' role to "'+argData.changeMember.type+'" for the project "'+argData.projectTitle+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",argData.rtcObj);}catch(error){console.log(error);}}},arg:{rtcObj:rtcObj,changeMember:thisClass.changeMember,projectTitle:mf_main.dashboardController.projectController.selectedProject.title}});}else{MF_UserManager.updateCollaboratorAll(MF_UserSession.getUser(),mf_main.dashboardController.projectController.selectedProject.company,mf_main.dashboardController.projectController.selectedProject,thisClass.changeMember,memberTypeChanged,{callback:function(str,argData){if(memberTypeChanged){try{mf_main.dashboardRtcController.projectShareSync("project_share",argData.rtcObj);var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators(argData.changeMember.userid);argData.rtcObj.collabarators=[];argData.rtcObj.collabarators=collaboratorsCollection.slice(0);argData.rtcObj.messageStr="has changed "+argData.changeMember.userid+' role to "'+argData.changeMember.type+'" for the project "'+argData.projectTitle+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",argData.rtcObj);}catch(error){console.log(error);}}},arg:{rtcObj:rtcObj,changeMember:thisClass.changeMember,projectTitle:mf_main.dashboardController.projectController.selectedProject.title}});}if(memberTypeChanged){mf_main.logController.logMemberType(thisClass.changeMember.userid,thisClass.changeMember.type,mf_main.dashboardController.projectController.selectedProject.id,mf_main.dashboardController.projectController.selectedProject.title);}};this.getEditorCount=function(){var count=0;for(var i=0;i<mf_main.dashboardController.projectController.collaborators.size();i++){var user=mf_main.dashboardController.projectController.collaborators.getItemAt(i);if(user.type=="Editor"){count++;}}return count;};this.addCollaborator=function(userid,usertype,sharePerm){if(thisClass.checkLimit()){if(userid==""){return;}mf_main.closeDialog();var collab=new MF_Collaborator();collab.projectid=mf_main.dashboardController.projectController.selectedProject.id;collab.type=usertype;collab.userid=userid;collab.sharePerm=sharePerm;collab.id=MF_Utils.guidGenerator();mf_main.dashboardController.projectController.collaborators.addItem(collab);mf_main.dashboardController.projectController.selectedProject.setCollaborators(mf_main.dashboardController.projectController.collaborators.toArray());mf_main.dashboardController.projectController.updateMemberCount(true);$("#mfMemberList").empty();var cachedTemplate=mf_main.getTemplateFromCache("mfProjectMemberTemplate");if(cachedTemplate!=null){mf_main.dashboardController.projectController.renderProjectMemberItems(cachedTemplate,mf_main.dashboardController.projectController.collaborators.toArray());}MF_Utils.display_ActionIndicator("Email Invitation has been sent");if(mf_main.dashboardController.projectController.selectedProject.flash){MF_UserManagerFlash.addCollaborator(mf_main.dashboardController.projectController.selectedProject.company,MF_UserSession.getUser(),mf_main.dashboardController.projectController.selectedProject,userid,usertype,sharePerm,mf_main.gappAccess,{callback:function(str,argData){if(str=="success"){mf_main.logController.logNewMember(userid,usertype,argData.selectedProject.id,argData.selectedProject.title);try{var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(userid);rtcObj.messageStr='has added you as "'+usertype+'" for the project "'+argData.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_share",rtcObj);var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators(userid);rtcObj.collabarators=[];rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr="has added "+userid+' as "'+usertype+'" for the project "'+argData.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}else{if(str=="spam"){if(mf_main.dashboardController.projectController.collaborators.length>0){mf_main.dashboardController.projectController.collaborators.removeItemAt(mf_main.dashboardController.projectController.collaborators.length-1);}mf_main.dashboardController.projectController.updateMemberCount(false);MF_Utils.display_ActionIndicator("Temporary e-mail addressess not accepted");}else{if(mf_main.dashboardController.projectController.collaborators.length>0){mf_main.dashboardController.projectController.collaborators.removeItemAt(mf_main.dashboardController.projectController.collaborators.length-1);}mf_main.dashboardController.projectController.updateMemberCount(false);MF_Utils.display_ActionIndicator("Some error occurred");}}},arg:{selectedProject:mf_main.dashboardController.projectController.selectedProject}});}else{MF_UserManager.addCollaborator(mf_main.dashboardController.projectController.selectedProject.company,MF_UserSession.getUser(),mf_main.dashboardController.projectController.selectedProject,userid,usertype,sharePerm,mf_main.gappAccess,{callback:function(str,argData){if(str=="success"){mf_main.logController.logNewMember(userid,usertype,argData.selectedProject.id,argData.selectedProject.title);try{var rtcObj=new MF_DashboardRTCNotificationItem();rtcObj.collabarators.push(userid);rtcObj.messageStr='has added you as "'+usertype+'" for the project "'+argData.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_share",rtcObj);var collaboratorsCollection=[];collaboratorsCollection=MF_Utils.getDashboardRTCCollabrators(userid);rtcObj.collabarators=[];rtcObj.collabarators=collaboratorsCollection.slice(0);rtcObj.messageStr="has added "+userid+' as "'+usertype+'" for the project "'+argData.selectedProject.title+'"';mf_main.dashboardRtcController.projectShareSync("project_sync",rtcObj);}catch(error){console.log(error);}}else{if(str=="spam"){if(mf_main.dashboardController.projectController.collaborators.length>0){mf_main.dashboardController.projectController.collaborators.removeItemAt(mf_main.dashboardController.projectController.collaborators.length-1);}mf_main.dashboardController.projectController.updateMemberCount(false);MF_Utils.display_ActionIndicator("Temporary e-mail addressess not accepted");}else{if(mf_main.dashboardController.projectController.collaborators.length>0){mf_main.dashboardController.projectController.collaborators.removeItemAt(mf_main.dashboardController.projectController.collaborators.length-1);}mf_main.dashboardController.projectController.updateMemberCount(false);MF_Utils.display_ActionIndicator("Some error occurred");}}},arg:{selectedProject:mf_main.dashboardController.projectController.selectedProject}});}}else{var answer=confirm("Your Basic MockFlow account allows only 2 reviewers per project, Upgrade now?");if(answer){mf_main.openUpgradeModal();return;}}};}